(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5524dc30"],{"073b":function(e,t,i){"use strict";i.d(t,"a",(function(){return O}));var r,s=i("a4ee"),a=(i("e06a"),i("6a0e")),n=i("7ffa"),o=i("b2b2"),c=i("59b2"),l=i("1a3e"),d=i("d386"),u=i("cea0"),b=i("c6f7"),p=i("680b"),h=i("4ae5");let f=r=class extends a["a"]{constructor(e){super(e),this.type="plane",this.position=null,this.heading=0,this.tilt=0,this.width=10,this.height=10}clone(){return new r({position:Object(n["a"])(this.position),heading:this.heading,tilt:this.tilt,width:this.width,height:this.height})}equals(e){return this.heading===e.heading&&this.tilt===e.tilt&&Object(o["g"])(this.position,e.position)&&this.width===e.width&&this.height===e.height}};Object(s["a"])([Object(c["b"])({readOnly:!0,json:{read:!1,write:!0}})],f.prototype,"type",void 0),Object(s["a"])([Object(c["b"])({type:h["a"]}),Object(b["a"])()],f.prototype,"position",void 0),Object(s["a"])([Object(c["b"])({type:Number,nonNullable:!0,range:{min:0,max:360}}),Object(b["a"])(),Object(l["a"])(e=>p["e"].normalize(Object(u["i"])(e),0,!0))],f.prototype,"heading",void 0),Object(s["a"])([Object(c["b"])({type:Number,nonNullable:!0,range:{min:0,max:360}}),Object(b["a"])(),Object(l["a"])(e=>p["e"].normalize(Object(u["i"])(e),0,!0))],f.prototype,"tilt",void 0),Object(s["a"])([Object(c["b"])({type:Number,nonNullable:!0}),Object(b["a"])()],f.prototype,"width",void 0),Object(s["a"])([Object(c["b"])({type:Number,nonNullable:!0}),Object(b["a"])()],f.prototype,"height",void 0),f=r=Object(s["a"])([Object(d["a"])("esri.widgets.Slice.SlicePlane")],f);const O=f},"0ee7":function(e,t,i){"use strict";i.d(t,"a",(function(){return we})),i.d(t,"b",(function(){return Y})),i.d(t,"c",(function(){return ae})),i.d(t,"d",(function(){return de})),i.d(t,"e",(function(){return le})),i.d(t,"f",(function(){return ue})),i.d(t,"g",(function(){return ce})),i.d(t,"h",(function(){return ee})),i.d(t,"i",(function(){return oe})),i.d(t,"j",(function(){return ve})),i.d(t,"k",(function(){return ne})),i.d(t,"l",(function(){return xe})),i.d(t,"m",(function(){return fe})),i.d(t,"n",(function(){return ge})),i.d(t,"o",(function(){return me})),i.d(t,"p",(function(){return Ce})),i.d(t,"q",(function(){return Pe})),i.d(t,"r",(function(){return te})),i.d(t,"s",(function(){return ie}));i("e06a");var r=i("6c97"),s=i("e92d"),a=i("38a4"),n=i("b2b2"),o=(i("a915"),i("d791")),c=i("afe1"),l=i("04f0"),d=i("e431"),u=i("0b2d"),b=i("8188"),p=i("0d9f"),h=i("7289"),f=i("d18f"),O=i("a1b1"),j=i("7361"),y=i("4e73"),g=i("74af"),m=i("14b5"),v=i("94e6"),_=i("7577"),w=i("5ef2"),S=i("5fae"),C=i("caf7"),P=i("da35"),x=i("d7f7"),E=i("35b3"),T=i("8675"),L=i("7c51"),F=i("8e97"),R=i("c3a4"),D=i("ca98"),k=i("fa1e"),z=i("c829"),M=i("b04d"),I=i("189c");class V extends D["a"]{initializeProgram(e){const t=V.shader.get().build();return new z["a"](e.rctx,t,k["a"])}bindPass(e,t){Object(F["c"])(this.program,t.camera.projectionMatrix),this.program.setUniform4fv("backgroundColor",e.backgroundColor),this.program.setUniform4fv("gridColor",e.gridColor),this.program.setUniform1f("gridWidth",e.gridWidth)}bindDraw(e){Object(F["d"])(this.program,e),this.program.rebindTextures()}initializePipeline(){return Object(I["g"])({blending:Object(I["h"])(1,1,771,771),depthTest:{func:513},colorWrite:I["d"]})}}V.shader=new R["a"](M["a"],()=>i.e("chunk-2d0a47c1").then(i.bind(null,"0748")));class A extends E["a"]{constructor(e){super(e,G),this._config=new P["a"]}intersect(e,t,i,r,s,a,n){return Object(L["i"])(e,t,r,s,a,void 0,n)}createBufferWriter(){return new T["a"](T["d"])}requiresSlot(e){return 7===e}createGLMaterial(e){return 0===e.output?new q(e):null}getTechniqueConfig(){return this._config}}class q extends x["a"]{constructor(e){super(e),this.ensureTechnique(V,null)}updateParameters(){return Object(n["u"])(this.technique)}beginSlot(){return Object(n["u"])(this.technique)}bind(e,t){t.bindPass(this._material.parameters,e)}}const G={backgroundColor:[1,0,0,.5],gridColor:[0,1,0,.5],gridWidth:4,...E["b"]};class U extends S["a"]{constructor(e){super(e),this._material=null,this._renderOccluded=4,this._gridWidth=1,this._gridColor=Object(w["c"])(1,0,0,1),this._backgroundColor=Object(w["c"])(1,0,0,1),this.applyProps(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get gridWidth(){return this._gridWidth}set gridWidth(e){this._gridWidth!==e&&(this._gridWidth=e,this._updateMaterial())}get gridColor(){return this._gridColor}set gridColor(e){Object(_["c"])(this._gridColor,e),this._updateMaterial()}get backgroundColor(){return this._backgroundColor}set backgroundColor(e){Object(_["c"])(this._backgroundColor,e),this._updateMaterial()}createExternalResources(){this._material=new A(this.materialParameters)}destroyExternalResources(){this._material=null}forEachExternalMaterial(e){Object(n["l"])(this._material)&&e(this._material)}createGeometries(e){if(Object(n["l"])(this._material)){const t=C["a"].createSquareGeometry();e.addGeometry(t,this._material)}}get materialParameters(){return{backgroundColor:this._backgroundColor,gridWidth:this._gridWidth,gridColor:this._gridColor,renderOccluded:this._renderOccluded}}_updateMaterial(){Object(n["l"])(this._material)&&this._material.setParameters(this.materialParameters)}}var W=i("0cb9"),B=i("92a1"),N=(i("9990"),i("0278")),H=i("d36e"),$=i("ad96"),Q=i("3748"),K=i("86ba"),Z=i("073b");i("3af1");const J=s["a"].getLogger("esri.views.3d.interactive.analysisTools.slice.sliceToolUtils");function X(e,t,i){const r=t.worldUpAtPosition(e.origin,j["d"].get()),s=e.basis1,a=Oe(e,r),n=Math.round(a/Se)*Se;return Object(p["l"])(e,n-a,s,i)}function Y(e,t){return Object(g["b"])(e.basis1,e.basis2,e.origin,t)}function ee(e,t,i,r){const s=t.worldUpAtPosition(e.origin,j["d"].get()),a=j["d"].get();switch(i){case 1:Object(d["n"])(a,s);break;case 2:Object(d["n"])(a,e.basis1)}return Object(h["h"])(e.origin,a,r)}function te(e,t,i,r){const s=Object(d["s"])(r.basis1),a=Object(d["s"])(r.basis2),n=se(r),c=ae(r),l=Object(d["z"])(j["d"].get(),0,0,0);Object(d["i"])(l,Object(d["h"])(j["d"].get(),r.basis1,t.direction[0]),Object(d["h"])(j["d"].get(),r.basis2,t.direction[1])),Object(d["i"])(l,r.origin,l);let u=0,b=1;if(ne(t))1===t.direction[0]&&-1===t.direction[1]?u=Se:1===t.direction[0]&&1===t.direction[1]?u=Math.PI:-1===t.direction[0]&&1===t.direction[1]&&(u=3*Math.PI/2),b=c;else{const e=0!==t.direction[0]?1:2;u=1===e?Se:0,b=(1===e?a:s)-n}const p=Object(o["j"])(j["a"].get());Object(o["s"])(p,p,u),Object(o["g"])(p,p,Object(d["z"])(j["d"].get(),b,b,b)),Object(o["n"])(p,i,p),p[12]=0,p[13]=0,p[14]=0,e.modelTransform=p,e.renderLocation=l}function ie(e,t,i,r){const s=r.worldUpAtPosition(i.origin,j["d"].get()),a=re(i,0),n=Object(o["j"])(j["a"].get());Object(o["s"])(n,n,a.edge*Math.PI/2),Object(o["e"])(n,n,-Oe(i,s)),Object(o["n"])(n,t,n),n[12]=0,n[13]=0,n[14]=0,e.modelTransform=n,e.renderLocation=a.position}function re(e,t){switch(t){case 0:return{basis:e.basis1,direction:1,position:Object(d["i"])(j["d"].get(),e.origin,e.basis1),edge:t};case 1:return{basis:e.basis2,direction:1,position:Object(d["i"])(j["d"].get(),e.origin,e.basis2),edge:t};case 2:return{basis:e.basis1,direction:-1,position:Object(d["m"])(j["d"].get(),e.origin,e.basis1),edge:t};case 3:return{basis:e.basis2,direction:-1,position:Object(d["m"])(j["d"].get(),e.origin,e.basis2),edge:t}}}function se(e){const t=Object(d["s"])(e.basis1),i=Object(d["s"])(e.basis2);return m["m"]*Math.min(t,i)}function ae(e){return se(e)}function ne(e){return 0!==e.direction[0]&&0!==e.direction[1]}function oe(e,t=1){const i=0===t?m["y"]:0,r=[Object(u["h"])(i,0,-m["u"]/2),Object(u["h"])(i,0,m["u"]/2)],s=he(r,!0),a=(e,t)=>be(r,r,{tubeRadius:m["F"],tipRadius:m["C"],tipLength:m["B"],tubeFocusMultiplier:m["E"],tipFocusMultiplier:m["A"],padding:e,bothEnds:!0,flat:null,focusTipLength:!0,addCap:t}),n=a(0,!1),o=a(m["v"],!0),c=new H["a"]({color:m["w"],cullFace:2,renderOccluded:16}),l=new H["a"]({color:m["t"],cullFace:2,renderOccluded:16}),d=new H["a"]({color:m["D"],cullFace:2,renderOccluded:16}),b=new H["a"]({color:m["z"],transparent:!0,writeDepth:!1,cullFace:1,renderOccluded:2}),p=C["a"].createPolylineGeometry([[i,0,0],[i-m["y"],0,0]]),h=C["a"].createPolylineGeometry([[i,0,0],[i-m["y"],0,0]]),f=new Q["a"]({color:m["x"],renderOccluded:4});return new y["a"]({view:e,renderObjects:[...n.normal.map(({part:e,geometry:t,transform:i})=>({geometry:t,material:"tip"===e?c:"cap"===e?l:d,transform:i,stateMask:1|_e})),...o.normal.map(({geometry:e,transform:t})=>({geometry:e,material:b,transform:t,stateMask:1|_e})),{geometry:p,material:f,stateMask:1|_e|we},...n.focused.map(({part:e,geometry:t,transform:i})=>({geometry:t,material:"tip"===e?c:"cap"===e?l:d,transform:i,stateMask:2|_e})),...o.focused.map(({geometry:e,transform:t})=>({geometry:e,material:b,transform:t,stateMask:2|_e})),{geometry:h,material:f,stateMask:2|_e|we}],autoScaleRenderObjects:!1,collisionType:{type:"line",paths:[s]},collisionPriority:1,radius:m["C"],state:_e})}function ce(e,t){const i=new $["a"]({transparent:!0,writeDepth:!1,textureId:t.id,renderOccluded:16}),r=m["r"],s=m["p"],a=s*m["q"],n=e=>{const t=new Uint32Array([0,1,2,2,3,0]);return new N["a"]([["position",{size:3,data:[r-e,-e,0,r+e,-e,0,r+e,e,0,r-e,e,0],exclusive:!0}],["uv0",{size:2,data:[0,0,1,0,1,1,0,1]}]],[["position",t],["uv0",t]])},o=C["a"].createPolylineGeometry([[0,0,0],[r-s,0,0]]),c=C["a"].createPolylineGeometry([[0,0,0],[r-a,0,0]]),l=new Q["a"]({color:m["o"],renderOccluded:4}),d=[{geometry:n(s),material:i,stateMask:1|_e},{geometry:o,material:l,stateMask:1|_e},{geometry:n(a),material:i,stateMask:2|_e},{geometry:c,material:l,stateMask:2|_e}];return new y["a"]({view:e,renderObjects:d,autoScaleRenderObjects:!1,collisionType:{type:"disc",direction:[0,0,1],offset:[r,0,0]},collisionPriority:1,radius:s/2,state:_e})}function le(e){return new v["a"]({view:e,attached:!0,color:m["f"],width:m["g"],writeDepthEnabled:!1,renderOccluded:4,geometry:[[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,0]]]})}function de(e){return new U({view:e,attached:!0,backgroundColor:[...m["d"]],gridColor:m["b"],gridWidth:4,renderOccluded:4})}function ue(e,t){const i=ne(t),r=i?[Object(u["h"])(1,0,0),Object(u["h"])(0,0,0),Object(u["h"])(0,1,0)]:[Object(u["h"])(1,0,0),Object(u["h"])(-1,0,0)],s=C["a"].createPolylineGeometry(r),a=m["i"],n=e=>new K["a"]({color:a,width:e,renderOccluded:4}),o=()=>new Q["a"]({color:a,renderOccluded:4}),c=i?m["k"]:m["n"],l=c*m["a"],d=m["n"],b=e=>e>1?n(e):o(),p=[{geometry:s,material:b(c),stateMask:1|Ce},{geometry:s,material:b(l),stateMask:2|Ce},{geometry:s,material:b(d),stateMask:Pe}],h=new y["a"]({view:e,renderObjects:p,collisionType:{type:"line",paths:[r]},autoScaleRenderObjects:!1,worldSized:!0,radius:i?m["j"]:m["l"]});return h.state=Ce,h}function be(e,t,i){const r=r=>{const s=(r?t:e).slice(0),a=Object(d["m"])(j["d"].get(),s[0],s[1]);Object(d["u"])(a,a);const b=Object(d["m"])(j["d"].get(),s[s.length-1],s[s.length-2]);if(Object(d["u"])(b,b),i.padding>0){const e=Object(d["h"])(Object(u["f"])(),b,-i.padding);if(s[s.length-1]=Object(d["i"])(e,e,s[s.length-1]),i.bothEnds){const e=Object(d["h"])(Object(u["f"])(),a,-i.padding);s[0]=Object(d["i"])(e,e,s[0])}}const p=r?i.tipFocusMultiplier:1,h=i.tipLength*(i.focusTipLength?p:1),f=i.tipRadius*p,O=Object(o["j"])(j["a"].get());if(i.padding>0){const e=h/4,t=Object(d["z"])(j["d"].get(),0,e,0),r=1+i.padding/e;Object(o["b"])(O,O,t),Object(o["g"])(O,O,Object(d["z"])(j["d"].get(),r,r,r)),Object(o["b"])(O,O,Object(d["h"])(t,t,-1/r))}const y=Object(o["j"])(Object(c["d"])()),g=Object(u["h"])(0,1,0),m=Object(o["h"])(Object(c["d"])(),Object(l["h"])(j["b"].get(),g,b));m[12]=s[s.length-1][0],m[13]=s[s.length-1][1],m[14]=s[s.length-1][2],Object(o["n"])(m,m,O);const v=[{part:"tube",geometry:pe(i.tubeRadius*(r?i.tubeFocusMultiplier:1)+i.padding,i.flat,s),transform:y}];let _,w;if(Object(n["l"])(i.flat)?_=C["a"].createExtrudedTriangle(h,f,f,i.flat.thickness):(_=C["a"].createConeGeometry(h,f,24,!1,!1,!0),w=C["a"].createConeGeometry(h,f,24,!1,!0,!1)),v.push({part:"tip",geometry:_,transform:m}),w&&v.push({part:"cap",geometry:w,transform:m}),i.bothEnds){const e=Object(o["h"])(Object(c["d"])(),Object(l["h"])(j["b"].get(),g,a));e[12]=s[0][0],e[13]=s[0][1],e[14]=s[0][2],Object(o["n"])(e,e,O),v.push({part:"tip",geometry:_,transform:e}),w&&v.push({part:"cap",geometry:w,transform:e})}return v};return{normal:r(!1),focused:r(!0)}}function pe(e,t,i){const r=[];if(Object(n["l"])(t))r.push([e,t.thickness/2],[-e,t.thickness/2],[-e,-t.thickness/2],[e,-t.thickness/2]);else{const t=12;for(let i=0;i<t;i++){const s=i/t*2*Math.PI;r.push([Math.cos(s)*e,Math.sin(s)*e])}}return C["a"].createPathExtrusionGeometry(r,i,[],[],!1)}function he(e,t){const i=Object(d["m"])(Object(u["f"])(),e[e.length-1],e[e.length-2]);if(Object(d["u"])(i,i),Object(d["h"])(i,i,m["s"]),Object(d["i"])(i,i,e[e.length-1]),t){const t=Object(d["m"])(Object(u["f"])(),e[0],e[1]);return Object(d["u"])(t,t),Object(d["h"])(t,t,m["s"]),Object(d["i"])(t,t,e[0]),[t,...e,i]}return[...e,i]}function fe(e,t,i,r=new Z["a"]){if(Object(n["k"])(e))return null;const{renderCoordsHelper:s}=t,o=s.fromRenderCoords(e.origin,t.spatialReference);if(Object(n["k"])(o))return null;const c=Object(b["D"])(o,i);if(Object(n["k"])(c))return null;r.position=c;const l=s.worldUpAtPosition(e.origin,j["d"].get()),u=s.worldBasisAtPosition(e.origin,1,j["d"].get()),p=2*Object(d["s"])(e.basis1),h=2*Object(d["s"])(e.basis2),f=B["a"].renderUnitScaleFactor(t.spatialReference,i);return r.width=p*f,r.height=h*f,r.tilt=Object(a["p"])(Oe(e,l)),r.heading=Object(a["p"])(je(e,l,u)),r}function Oe(e,t){return Object(O["b"])(t,e.basis2,e.basis1)+Se}function je(e,t,i){return Object(O["b"])(e.basis1,i,t)-Se}function ye(e,t,i,r,s,n,o=Object(p["d"])()){return n.toRenderCoords(e,o.origin)?(n.worldBasisAtPosition(o.origin,0,o.basis1),n.worldBasisAtPosition(o.origin,1,o.basis2),Object(h["j"])(o.basis2,o.basis1,o.origin,o.plane),Object(p["l"])(o,-Object(a["h"])(t),Object(p["k"])(o),o),Object(p["l"])(o,Object(a["h"])(i),o.basis1,o),Object(d["h"])(o.basis1,o.basis1,r/2),Object(d["h"])(o.basis2,o.basis2,s/2),Object(p["n"])(o),o):(J.error(`Failed to project slice plane position, projection from ${e.spatialReference.wkid} is not supported`),null)}function ge(e,t){if(Object(n["k"])(e)||Object(n["k"])(e.position))return null;const i=Object(b["D"])(e.position,t);if(Object(n["k"])(i))return null;const r=B["a"].renderUnitScaleFactor(e.position.spatialReference,t),s=e.width*r,a=e.height*r;return{position:i,heading:e.heading,tilt:e.tilt,renderWidth:s,renderHeight:a}}function me(e,t,i,r=Object(p["d"])()){if(Object(n["k"])(e))return null;let s=e.position;!e.position.hasZ&&Object(n["l"])(t.elevationProvider)&&(s=e.position.clone(),s.z=Object(n["v"])(Object(W["b"])(t.elevationProvider,e.position),0));const a=ye(s,e.heading,e.tilt,e.renderWidth,e.renderHeight,t.renderCoordsHelper,r);return!i.tiltEnabled&&Object(n["l"])(a)&&X(a,t.renderCoordsHelper,a),a}function ve(e){switch(e.type){case"analysis":case"building-scene":case"csv":case"feature":case"geo-rss":case"geojson":case"graphics":case"group":case"integrated-mesh":case"kml":case"map-notes":case"ogc-feature":case"point-cloud":case"route":case"scene":case"stream":case"voxel":case"subtype-group":case"unknown":case"unsupported":case"wfs":case null:return!1;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"elevation":case"imagery":case"imagery-tile":case"map-image":case"open-street-map":case"tile":case"vector-tile":case"wcs":case"web-tile":case"wms":case"wmts":return!0;default:return Object(r["a"])(e.type),!1}}const _e=16,we=32,Se=(Object(f["c"])(),Math.PI/2),Ce=16,Pe=32;function xe(e){const t="building-scene-3d"===e.type?e:null;return Object(n["l"])(t)}},"14b5":function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return j})),i.d(t,"c",(function(){return q})),i.d(t,"d",(function(){return O})),i.d(t,"e",(function(){return A})),i.d(t,"f",(function(){return f})),i.d(t,"g",(function(){return h})),i.d(t,"h",(function(){return p})),i.d(t,"i",(function(){return L})),i.d(t,"j",(function(){return k})),i.d(t,"k",(function(){return F})),i.d(t,"l",(function(){return z})),i.d(t,"m",(function(){return D})),i.d(t,"n",(function(){return R})),i.d(t,"o",(function(){return y})),i.d(t,"p",(function(){return V})),i.d(t,"q",(function(){return c})),i.d(t,"r",(function(){return I})),i.d(t,"s",(function(){return M})),i.d(t,"t",(function(){return m})),i.d(t,"u",(function(){return E})),i.d(t,"v",(function(){return T})),i.d(t,"w",(function(){return g})),i.d(t,"x",(function(){return _})),i.d(t,"y",(function(){return x})),i.d(t,"z",(function(){return w})),i.d(t,"A",(function(){return o})),i.d(t,"B",(function(){return P})),i.d(t,"C",(function(){return C})),i.d(t,"D",(function(){return v})),i.d(t,"E",(function(){return n})),i.d(t,"F",(function(){return S})),i.d(t,"G",(function(){return d})),i.d(t,"H",(function(){return l}));var r=i("c120"),s=i("38a4");Object(r["a"])("mac");const a=2,n=1.15,o=1.15,c=1.1,l=Math.cos(Object(s["h"])(45)),d=Math.cos(Object(s["h"])(5)),u=.7,b=[1,.5,0],p=2,h=1,f=[...b,u],O=[0,0,0,.04],j=[...b,.5],y=[...b,1],g=[1,1,1,1],m=[1,.8,.6,1],v=[1,.93,.86,1],_=[...b,1],w=[...b,1],S=3,C=11,P=22.5,x=40,E=48,T=2.25,L=[...b,1],F=4,R=1,D=.3,k=6,z=4,M=12,I=40,V=27,A=1600,q=.4},"1bd2":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i("a4ee"),s=i("b2b2"),a=i("fab3"),n=i("59b2"),o=(i("b50f"),i("c120"),i("cea0"),i("d386"));const c=e=>{let t=class extends(Object(a["b"])(e)){constructor(){super(...arguments),this.parent=null}get updating(){return!1}get visible(){const e=!Object(s["l"])(this.parent)||this.parent.visible&&!this.parent.suspended;return this.analysis.visible&&e}};return Object(r["a"])([Object(n["b"])({readOnly:!0})],t.prototype,"type",void 0),Object(r["a"])([Object(n["b"])({constructOnly:!0})],t.prototype,"analysis",void 0),Object(r["a"])([Object(n["b"])({constructOnly:!0})],t.prototype,"parent",void 0),Object(r["a"])([Object(n["b"])({constructOnly:!0})],t.prototype,"view",void 0),Object(r["a"])([Object(n["b"])({readOnly:!0})],t.prototype,"updating",null),Object(r["a"])([Object(n["b"])({readOnly:!0})],t.prototype,"visible",null),t=Object(r["a"])([Object(o["a"])("esri.views.3d.analysis.AnalysisView3D")],t),t}},2252:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return a}));var r=i("3886");function s(e){e.vertex.uniforms.add("camPos","vec3").add("perScreenPixelRatio","float").add("screenSize","float"),e.vertex.code.add(r["a"]`float computeRenderPixelSizeAt( vec3 pWorld ){
vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);
float viewDirectionDistance = abs(dot(viewForward, pWorld - camPos));
return viewDirectionDistance*perScreenPixelRatio;
}
vec3 screenSizeScaling(vec3 position, vec3 anchor){
return position * screenSize * computeRenderPixelSizeAt(anchor) + anchor;
}`)}function a(e,t,i){e.setUniform1f("perScreenPixelRatio",i.camera.perScreenPixelRatio),e.setUniform1f("screenSize",t.screenSize)}},2698:function(e,t,i){"use strict";function r(e){return e&&"getAtOrigin"in e&&"originOf"in e}i.d(t,"a",(function(){return r}))},"2e4d":function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var r=i("a4ee"),s=i("a5d8"),a=i("e694"),n=i("59b2"),o=(i("b50f"),i("c120"),i("cea0")),c=i("afcf"),l=i("d386"),d=i("22f4");let u=class extends(Object(s["a"])(a["b"])){constructor(e){super(e),this.title="",this.id=-1,this.modelName=null,this.isEmpty=null,this.visible=!0,this.opacity=1}readTitle(e,t){return"string"==typeof t.alias?t.alias:"string"==typeof t.name?t.name:""}readIdOnlyOnce(e){return-1!==this.id?this.id:"number"==typeof e?e:void 0}};Object(r["a"])([Object(n["b"])({type:String,json:{origins:{"web-scene":{write:!0},"portal-item":{write:!0}}}})],u.prototype,"title",void 0),Object(r["a"])([Object(c["a"])("service","title",["alias","name"])],u.prototype,"readTitle",null),Object(r["a"])([Object(n["b"])()],u.prototype,"layer",void 0),Object(r["a"])([Object(n["b"])({type:o["a"],readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],u.prototype,"id",void 0),Object(r["a"])([Object(c["a"])("service","id")],u.prototype,"readIdOnlyOnce",null),Object(r["a"])([Object(n["b"])(Object(d["k"])(String))],u.prototype,"modelName",void 0),Object(r["a"])([Object(n["b"])(Object(d["k"])(Boolean))],u.prototype,"isEmpty",void 0),Object(r["a"])([Object(n["b"])({type:Boolean,json:{name:"visibility",write:!0}})],u.prototype,"visible",void 0),Object(r["a"])([Object(n["b"])({type:Number,json:{write:!0}})],u.prototype,"opacity",void 0),u=Object(r["a"])([Object(l["a"])("esri.layers.buildingSublayers.BuildingSublayer")],u);const b=u},"4e73":function(e,t,i){"use strict";i.d(t,"a",(function(){return L}));i("e06a");var r=i("6c97"),s=i("ce6d"),a=i("38a4"),n=i("b2b2"),o=i("a915"),c=i("4c37"),l=i("1c92"),d=i("dae5"),u=i("d791"),b=i("afe1"),p=i("3349"),h=i("e431"),f=i("0b2d"),O=i("8188"),j=i("f694"),y=i("9180"),g=i("bd7e"),m=i("7289"),v=i("d18f"),_=i("7361"),w=i("d3cf"),S=i("0cb9"),C=i("9990"),P=i("171c"),x=i("5a22"),E=i("748f"),T=i("4ae5");class L{constructor(e){this.camera=new P["a"],this._elevation={offset:0,override:null},this.collisionType={type:"point"},this.collisionPriority=0,this._renderObjects=[],this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=Object(b["d"])(),this._worldFrame=null,this._renderLocation=Object(f["f"])(),this._renderLocationDirty=!0,this._location=new T["a"]({x:0,y:0,z:0}),this._elevationAlignedLocation=new T["a"],this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.cursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=0,this._focused=!1,this.events=new s["a"].EventEmitter,this._screenLocation={screenPointArray:Object(o["g"])(),renderScreenPointArray:Object(o["e"])(),pixelSize:0},this._screenLocationDirty=!0,this._applyObjectTransform=null,this._engineResourcesAddedToStage=!1,this._engineResources=null,this._attached=!1,this._engineLayer=null,this._materialIdReferences=null,this._location.spatialReference=e.view.spatialReference;for(const t in e)this[t]=e[t];this.view.state&&this.view.state.camera&&this.camera.copyFrom(this.view.state.camera)}destroy(){this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this.camera=null}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}get renderObjects(){return this._renderObjects}set renderObjects(e){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=e.slice(),this._updateEngineObject()}set available(e){e!==this._available&&(this._available=e,this._updateEngineObject())}get available(){return this._available}disableDisplay(){return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),{remove:Object(c["d"])(()=>{this._noDisplayCount--,0===this._noDisplayCount&&this._updateEngineObject()})}}set radius(e){e!==this._radius&&(this._radius=e,this._updateEngineObject())}get radius(){return this._radius}set worldSized(e){e!==this._worldSized&&(this._worldSized=e,this._updateEngineObject())}get worldSized(){return this._worldSized}get modelTransform(){return this._modelTransform}set modelTransform(e){F(e)&&(this._screenLocationDirty=!0),Object(u["d"])(this._modelTransform,e),this._updateEngineObject()}get renderLocation(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=Object(b["d"])()),R(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation}set renderLocation(e){this.view.renderCoordsHelper.fromRenderCoords(e,this._location),this.elevationAlignedLocation=this._location}get location(){return this._location}set location(e){Object(w["a"])(e,this._location),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}get elevationAlignedLocation(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation}set elevationAlignedLocation(e){Object(w["a"])(e,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}_updateElevationAlignedLocation(){this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y;const e=Object(n["l"])(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.z=e+this._elevation.offset,this._elevationAlignedLocation.spatialReference=this.location.spatialReference,this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}grabbableForEvent(){return!0}get grabbing(){return this._grabbing}set grabbing(e){e!==this._grabbing&&(this._grabbing=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get hovering(){return this._hovering}set hovering(e){e!==this._hovering&&(this._hovering=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get selected(){return this._selected}set selected(e){e!==this._selected&&(this._selected=e,this._updateEngineObject(),this.events.emit("select-changed",{action:e?"select":"deselect"}))}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,this._updateEngineObject())}updateStateEnabled(e,t){t?this.state|=e:this.state&=~e}_setFocused(e){e!==this._focused&&(this._focused=e,this.events.emit("focus-changed",{action:!0===e?"focus":"unfocus"}))}get focused(){return this._focused}get screenLocation(){return this.ensureScreenLocation(),this._screenLocation}ensureScreenLocation(){if(!this._screenLocationDirty)return;let e;if(this._screenLocation.pixelSize=this.camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1,F(this._modelTransform)){const t=this._calculateModelTransformOffset(N);e=Object(h["i"])(t,t,this.renderLocation)}else e=this.renderLocation;this.camera.projectToRenderScreen(e,this._screenLocation.renderScreenPointArray),this.camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}get applyObjectTransform(){return this._applyObjectTransform}set applyObjectTransform(e){this._applyObjectTransform=e,this._screenLocationDirty=!0,this._updateEngineObject()}intersectionDistance(e,t){if(!this.available)return null;const i=Object(o["j"])(e,D),s=this._getCollisionRadius(t),a=-1*this.collisionPriority;switch(this.collisionType.type){case"point":if(Object(p["a"])(this.screenLocation.screenPointArray,i)<s*s)return this.screenLocation.renderScreenPointArray[2]+a;break;case"line":{const e=this.collisionType.paths,t=this._getWorldToScreenObjectScale(),r=this._calculateObjectTransform(t,V),c=s*this.screenLocation.pixelSize,l=Object(C["c"])(this.camera,i,z);if(Object(n["k"])(l))return null;for(const i of e){if(0===i.length)continue;const e=Object(h["t"])(q,i[0],r);for(let t=1;t<i.length;t++){const s=Object(h["t"])(G,i[t],r),n=Object(g["b"])(Object(g["f"])(e,s,k),l);if(null!=n&&n<c*c){const t=Object(h["i"])(_["d"].get(),e,s);Object(h["h"])(t,t,.5);const i=Object(o["a"])(_["d"].get());return this.camera.projectToRenderScreen(t,i),i[2]+a}Object(h["n"])(e,s)}}break}case"disc":{var c;const e=this.collisionType.direction,t=null!=(c=this.collisionType.offset)?c:f["c"],r=this._getWorldToScreenObjectScale(),o=this._calculateObjectTransform(r,V),d=s*this.screenLocation.pixelSize,u=Object(C["c"])(this.camera,i,z);if(Object(n["k"])(u))return null;const b=Object(l["f"])(M,o),p=Object(h["A"])(W,e,b),O=Object(h["t"])(B,t,o);Object(m["h"])(O,p,A);const j=U;if(Object(m["n"])(A,u,j)&&Object(h["o"])(j,O)<d*d)return this.screenLocation.renderScreenPointArray[2]+a;break}case"ribbon":{const{paths:e,direction:t}=this.collisionType,r=this._getWorldToScreenObjectScale(),c=this._calculateObjectTransform(r,V),d=s*this.camera.computeScreenPixelSizeAt(this.renderLocation),u=Object(C["c"])(this.camera,i,z);if(Object(n["k"])(u))return null;const b=Object(l["f"])(M,c),p=Object(h["A"])(W,t,b),f=this._calculateModelTransformPosition(B);Object(m["h"])(f,p,A);const O=U;if(!Object(m["n"])(A,u,O))break;for(const i of e){if(0===i.length)continue;const e=Object(h["t"])(q,i[0],c);for(let t=1;t<i.length;t++){const r=Object(h["t"])(G,i[t],c),s=Object(g["e"])(Object(g["f"])(e,r,k),O);if(null!=s&&s<d*d){const t=Object(h["i"])(_["d"].get(),e,r);Object(h["h"])(t,t,.5);const i=Object(o["a"])(_["d"].get());return this.camera.projectToRenderScreen(t,i),i[2]+a}Object(h["n"])(e,r)}}break}default:Object(r["a"])(this.collisionType)}return null}attach(e={manipulator3D:{}}){var t;if(!this.view._stage)return;const i=e.manipulator3D;if(Object(n["k"])(i.engineLayerId)){const e=new E["a"]({isPickable:!1,updatePolicy:1});this.view._stage.add(e),i.engineLayerId=e.id,this._engineLayer=e}else null!=(t=this.view._stage)&&t.getObject&&(this._engineLayer=this.view._stage.getObject(i.engineLayerId));i.engineLayerReferences=(i.engineLayerReferences||0)+1,this._materialIdReferences=i.materialIdReferences,Object(n["k"])(this._materialIdReferences)&&(this._materialIdReferences=new Map,i.materialIdReferences=this._materialIdReferences),this.camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),Object(O["b"])(this._location.spatialReference,this.view.spatialReference)||(this.location=new T["a"]({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}detach(e={manipulator3D:{}}){const t=e.manipulator3D;t.engineLayerReferences--;const i=0===t.engineLayerReferences;i&&(t.engineLayerId=null),this._removeResourcesFromStage(i),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}onViewChange(){this.camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}onElevationChange(e){Object(O["s"])(this.location,H,e.spatialReference),Object(y["i"])(e.extent,H)&&(this.location=this._location)}_evaluateElevationAlignment(e=this.location){if(Object(n["k"])(this.elevationInfo))return!1;let t=null,i=0;const r=Object(n["v"])(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case"on-the-ground":t=Object(n["v"])(Object(S["b"])(this.view.elevationProvider,e,"ground"),0);break;case"relative-to-ground":i=Object(n["v"])(Object(S["b"])(this.view.elevationProvider,e,"ground"),0)+r;break;case"relative-to-scene":i=Object(n["v"])(Object(S["b"])(this.view.elevationProvider,e,"scene"),0)+r;break;case"absolute-height":i=r}return(i!==this._elevation.offset||t!==this._elevation.override)&&(this._elevation.offset=i,this._elevation.override=t,!0)}_updateEngineObject(){if(!this._attached)return;if(!this.available)return void this._removeResourcesFromStage();const e=this._getWorldToScreenObjectScale(),t=V;if(!0===this.autoScaleRenderObjects){const i=this._getFocusedSize(this._radius,this.focused)*e;this._calculateObjectTransform(i,t)}else this._calculateObjectTransform(e,t);const{objectsByState:i}=this._ensureEngineResources(),r=(this.focused?2:1)|(this.selected?8:4),s=this._noDisplayCount>0;for(const{stateMask:a,objects:n}of i){if(s){for(const e of n)e.setVisible(!1);continue}const e=!(0!=(15&a))||(r&a)==(15&a),i=!(0!=(65520&a))||(this.state&a)==(65520&a);if(e&&i)for(const r of n)r.setVisible(!0),r.transformation=t;else for(const t of n)t.setVisible(!1)}}_ensureEngineResources(){if(Object(n["k"])(this._engineResources)){const e=Object(n["u"])(this._engineLayer),t=[],i=new Set;this.renderObjects.forEach(({material:e})=>{i.has(e)||(t.push(e),i.add(e))});const r=(e,t)=>{const{geometry:i,material:r,transform:s}=t;Array.isArray(i)?i.forEach(t=>e.addGeometry(t,r,s)):e.addGeometry(i,r,s)},s=new Map;this._renderObjects.forEach(e=>{const t=new x["a"]({castShadow:!1});r(t,e);const i=e.stateMask||0,a=s.get(i)||[];a.push(t),s.set(i,a)});const a=[];s.forEach((e,t)=>a.push({stateMask:t,objects:e})),this._engineResources={objectsByState:a,layer:e,materials:t}}return this._addResourcesToStage(),this._engineResources}_addResourcesToStage(){if(this._engineResourcesAddedToStage||Object(n["k"])(this._engineResources))return;const{objectsByState:e,layer:t,materials:i}=this._engineResources;i.forEach(e=>{const t=Object(n["u"])(this._materialIdReferences),i=t.get(e.id)||0;0===i&&this.view._stage.add(e),t.set(e.id,i+1)}),e.forEach(({objects:e})=>{t.addMany(e),this.view._stage.addMany(e)}),this._engineResourcesAddedToStage=!0}_removeResourcesFromStage(e=!1){if(!this._engineResourcesAddedToStage||Object(n["k"])(this._engineResources))return;const{objectsByState:t,layer:i,materials:r}=this._engineResources;t.forEach(({objects:e})=>{i.removeMany(e),this.view._stage.removeMany(e)}),r.forEach(e=>{const t=Object(n["u"])(this._materialIdReferences),i=t.get(e.id);1===i?(this.view._stage.remove(e),t.delete(e.id)):t.set(e.id,i-1)}),e&&this.view._stage.remove(i),this._engineResourcesAddedToStage=!1}_getCollisionRadius(e){return this._getFocusedSize(this.radius,!0)*("touch"===e?this.touchMultiplier:1)}_getFocusedSize(e,t){return e*(t?this.focusMultiplier:1)}_getWorldToScreenObjectScale(){return this._worldSized?1:this.screenLocation.pixelSize}_calculateModelTransformPosition(e){const t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,I);return Object(h["z"])(e,i[12],i[13],i[14])}_calculateModelTransformOffset(e){const t=this._calculateModelTransformPosition(e);return Object(h["m"])(e,t,this.renderLocation)}_calculateObjectTransform(e,t){return Object(u["t"])(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1),this._worldFrame&&Object(u["n"])(t,t,this._worldFrame),Object(u["n"])(t,t,this._modelTransform),t[12]+=this.renderLocation[0],t[13]+=this.renderLocation[1],t[14]+=this.renderLocation[2],t[15]=1,Object(n["l"])(this._applyObjectTransform)&&this._applyObjectTransform(t),t}get test(){let e=!1;if(Object(n["l"])(this._engineResources))for(const t in this._engineResources.objectsByState){const i=this._engineResources.objectsByState[t];for(const t of i.objects)if(t.isVisible){e=!0;break}if(e)break}return{areAnyResourcesVisible:e}}}function F(e){return 0!==e[12]||0!==e[13]||0!==e[14]}function R(e,t,i){switch(e.viewingMode){case"local":return Object(u["j"])(i),!0;case"global":{const r=Object(j["e"])(e.renderCoordsHelper.spatialReference);return Object(O["C"])(t,0,q,0,r.radius),Object(O["c"])(Object(a["h"])(q[0]),Object(a["h"])(q[1]),i),!0}}}const D=Object(o["g"])(),k=Object(g["d"])(),z=Object(v["c"])(),M=Object(d["b"])(),I=Object(b["d"])(),V=Object(b["d"])(),A=Object(m["d"])(),q=Object(f["f"])(),G=Object(f["f"])(),U=Object(f["f"])(),W=Object(f["f"])(),B=Object(f["f"])(),N=Object(f["f"])(),H=new T["a"]({x:0,y:0,z:0,spatialReference:null})},"5d34":function(e,t,i){"use strict";i.d(t,"a",(function(){return j})),i.d(t,"b",(function(){return u})),i.d(t,"c",(function(){return c})),i.d(t,"d",(function(){return p}));var r=i("a4ee"),s=i("6a0e"),a=i("59b2"),n=(i("b50f"),i("c120"),i("cea0"),i("448d")),o=i("d386");let c=class extends s["a"]{constructor(){super(...arguments),this.nodesPerPage=null,this.rootIndex=0,this.lodSelectionMetricType=null}};Object(r["a"])([Object(a["b"])({type:Number})],c.prototype,"nodesPerPage",void 0),Object(r["a"])([Object(a["b"])({type:Number})],c.prototype,"rootIndex",void 0),Object(r["a"])([Object(a["b"])({type:String})],c.prototype,"lodSelectionMetricType",void 0),c=Object(r["a"])([Object(o["a"])("esri.layer.support.I3SNodePageDefinition")],c);let l=class extends s["a"]{constructor(){super(...arguments),this.factor=1}};Object(r["a"])([Object(a["b"])({type:Number,json:{read:{source:"textureSetDefinitionId"}}})],l.prototype,"id",void 0),Object(r["a"])([Object(a["b"])({type:Number})],l.prototype,"factor",void 0),l=Object(r["a"])([Object(o["a"])("esri.layer.support.I3SMaterialTexture")],l);let d=class extends s["a"]{constructor(){super(...arguments),this.baseColorFactor=[1,1,1,1],this.baseColorTexture=null,this.metallicRoughnessTexture=null,this.metallicFactor=1,this.roughnessFactor=1}};Object(r["a"])([Object(a["b"])({type:[Number]})],d.prototype,"baseColorFactor",void 0),Object(r["a"])([Object(a["b"])({type:l})],d.prototype,"baseColorTexture",void 0),Object(r["a"])([Object(a["b"])({type:l})],d.prototype,"metallicRoughnessTexture",void 0),Object(r["a"])([Object(a["b"])({type:Number})],d.prototype,"metallicFactor",void 0),Object(r["a"])([Object(a["b"])({type:Number})],d.prototype,"roughnessFactor",void 0),d=Object(r["a"])([Object(o["a"])("esri.layer.support.I3SMaterialPBRMetallicRoughness")],d);let u=class extends s["a"]{constructor(){super(...arguments),this.alphaMode="opaque",this.alphaCutoff=.25,this.doubleSided=!1,this.cullFace="none",this.normalTexture=null,this.occlusionTexture=null,this.emissiveTexture=null,this.emissiveFactor=null,this.pbrMetallicRoughness=null}};Object(r["a"])([Object(n["a"])({opaque:"opaque",mask:"mask",blend:"blend"})],u.prototype,"alphaMode",void 0),Object(r["a"])([Object(a["b"])({type:Number})],u.prototype,"alphaCutoff",void 0),Object(r["a"])([Object(a["b"])({type:Boolean})],u.prototype,"doubleSided",void 0),Object(r["a"])([Object(n["a"])({none:"none",back:"back",front:"front"})],u.prototype,"cullFace",void 0),Object(r["a"])([Object(a["b"])({type:l})],u.prototype,"normalTexture",void 0),Object(r["a"])([Object(a["b"])({type:l})],u.prototype,"occlusionTexture",void 0),Object(r["a"])([Object(a["b"])({type:l})],u.prototype,"emissiveTexture",void 0),Object(r["a"])([Object(a["b"])({type:[Number]})],u.prototype,"emissiveFactor",void 0),Object(r["a"])([Object(a["b"])({type:d})],u.prototype,"pbrMetallicRoughness",void 0),u=Object(r["a"])([Object(o["a"])("esri.layer.support.I3SMaterialDefinition")],u);let b=class extends s["a"]{};Object(r["a"])([Object(a["b"])({type:String,json:{read:{source:["name","index"],reader:(e,t)=>null!=e?e:""+t.index}}})],b.prototype,"name",void 0),Object(r["a"])([Object(n["a"])({jpg:"jpg",png:"png",dds:"dds","ktx-etc2":"ktx-etc2",ktx2:"ktx2",basis:"basis"})],b.prototype,"format",void 0),b=Object(r["a"])([Object(o["a"])("esri.layer.support.I3STextureFormat")],b);let p=class extends s["a"]{constructor(){super(...arguments),this.atlas=!1}};Object(r["a"])([Object(a["b"])({type:[b]})],p.prototype,"formats",void 0),Object(r["a"])([Object(a["b"])({type:Boolean})],p.prototype,"atlas",void 0),p=Object(r["a"])([Object(o["a"])("esri.layer.support.I3STextureSetDefinition")],p);let h=class extends s["a"]{};Object(r["a"])([Object(n["a"])({Float32:"Float32",UInt64:"UInt64",UInt32:"UInt32",UInt16:"UInt16",UInt8:"UInt8"})],h.prototype,"type",void 0),Object(r["a"])([Object(a["b"])({type:Number})],h.prototype,"component",void 0),h=Object(r["a"])([Object(o["a"])("esri.layer.support.I3SGeometryAttribute")],h);let f=class extends s["a"]{};Object(r["a"])([Object(n["a"])({draco:"draco"})],f.prototype,"encoding",void 0),Object(r["a"])([Object(a["b"])({type:[String]})],f.prototype,"attributes",void 0),f=Object(r["a"])([Object(o["a"])("esri.layer.support.I3SGeometryCompressedAttributes")],f);let O=class extends s["a"]{constructor(){super(...arguments),this.offset=0}};Object(r["a"])([Object(a["b"])({type:Number})],O.prototype,"offset",void 0),Object(r["a"])([Object(a["b"])({type:h})],O.prototype,"position",void 0),Object(r["a"])([Object(a["b"])({type:h})],O.prototype,"normal",void 0),Object(r["a"])([Object(a["b"])({type:h})],O.prototype,"uv0",void 0),Object(r["a"])([Object(a["b"])({type:h})],O.prototype,"color",void 0),Object(r["a"])([Object(a["b"])({type:h})],O.prototype,"uvRegion",void 0),Object(r["a"])([Object(a["b"])({type:h})],O.prototype,"featureId",void 0),Object(r["a"])([Object(a["b"])({type:h})],O.prototype,"faceRange",void 0),Object(r["a"])([Object(a["b"])({type:f})],O.prototype,"compressedAttributes",void 0),O=Object(r["a"])([Object(o["a"])("esri.layer.support.I3SGeometryBuffer")],O);let j=class extends s["a"]{};Object(r["a"])([Object(n["a"])({triangle:"triangle"})],j.prototype,"topology",void 0),Object(r["a"])([Object(a["b"])()],j.prototype,"geometryBuffers",void 0),j=Object(r["a"])([Object(o["a"])("esri.layer.support.I3SGeometryDefinition")],j)},"5fae":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i("b2b2"),s=i("d791"),a=i("afe1"),n=i("f53a"),o=i("5a22"),c=i("748f");class l extends n["a"]{constructor(e){super(e.view),this._resources=null,this._transform=Object(a["d"])()}get object(){return Object(r["l"])(this._resources)?this._resources.object:null}get transform(){return this._transform}set transform(e){Object(s["d"])(this._transform,e),Object(r["l"])(this._resources)&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(Object(r["k"])(this._resources))return;const e=this._resources.object,t=this.view._stage;t.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),this.visible||e.setVisible(this.visible),t.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const t=new c["a"]({isPickable:!1,updatePolicy:1});e.add(t);const i=new o["a"]({castShadow:!1});i.transformation=this._transform,this.createExternalResources(),this.createGeometries(i),e.addMany(i.geometries),this.forEachExternalMaterial(t=>e.add(t)),e.add(i),t.add(i),this.visible||i.setVisible(!1),this._resources={layer:t,object:i}}destroyResources(){const e=this.view._stage;!Object(r["k"])(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial(t=>{e.remove(t),t.dispose()}),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){Object(r["k"])(this._resources)||this._resources.object.setVisible(e)}}},"692f":function(e,t,i){"use strict";i.d(t,"a",(function(){return p})),i.d(t,"b",(function(){return b}));var r=i("2252"),s=i("d272"),a=i("4db9"),n=i("d047"),o=i("c6d7"),c=i("ebd5"),l=i("4377"),d=i("3886"),u=i("690a");function b(e){const t=new u["a"];return t.include(a["a"],{linearDepth:!1}),t.include(r["a"],{}),t.include(s["a"],e),t.fragment.include(l["a"]),t.vertex.uniforms.add("proj","mat4").add("view","mat4"),t.fragment.uniforms.add("color","vec4"),t.attributes.add("position","vec3"),t.varyings.add("vWorldPosition","vec3"),e.multipassTerrainEnabled&&t.varyings.add("depth","float"),e.screenSizeEnabled&&t.attributes.add("offset","vec3"),e.shadingEnabled&&(t.vertex.uniforms.add("viewNormal","mat4"),t.fragment.uniforms.add("shadedColor","vec4").add("shadingDirection","vec3"),t.attributes.add("normal","vec3"),t.varyings.add("vViewNormal","vec3")),t.vertex.code.add(d["a"]`
    void main(void) {
      vWorldPosition = ${e.screenSizeEnabled?"screenSizeScaling(offset, position)":"position"};
  `),e.shadingEnabled&&t.vertex.code.add(d["a"]`vec3 worldNormal = normal;
vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`),t.vertex.code.add(d["a"]`
    ${e.multipassTerrainEnabled?"depth = (view * vec4(vWorldPosition, 1.0)).z;":""}
    gl_Position = transformPosition(proj, view, vWorldPosition);
  }
  `),e.multipassTerrainEnabled&&(t.fragment.include(n["a"]),t.include(o["b"],e)),t.fragment.code.add(d["a"]`
    void main() {
      discardBySlice(vWorldPosition);
      ${e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":""}
    `),e.shadingEnabled?t.fragment.code.add(d["a"]`vec3 viewNormalNorm = normalize(vViewNormal);
float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);
vec4 finalColor = mix(color, shadedColor, shadingFactor);`):t.fragment.code.add(d["a"]`vec4 finalColor = color;`),t.fragment.code.add(d["a"]`
      if (finalColor.a < ${d["a"].float(c["c"])}) {
        discard;
      }
      ${7===e.output?d["a"]`gl_FragColor = vec4(finalColor.a);`:""}

      ${0===e.output?d["a"]`gl_FragColor = highlightSlice(finalColor, vWorldPosition); ${e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}`:""}
    }
    `),t}const p=Object.freeze({__proto__:null,build:b})},"6e36":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i("2eab"),s=i("ce50"),a=i("b2b2");async function n(e,t,i,n,o,c){let l=null;if(Object(a["l"])(i)){const t=e+"/nodepages/",s=t+Math.floor(i.rootIndex/i.nodesPerPage);try{return{type:"page",rootPage:(await Object(r["default"])(s,{query:{f:"json",token:n},responseType:"json",signal:c})).data,rootIndex:i.rootIndex,pageSize:i.nodesPerPage,lodMetric:i.lodSelectionMetricType,urlPrefix:t}}catch(b){Object(a["l"])(o)&&o.warn("#fetchIndexInfo()","Failed to load root node page. Falling back to node documents.",s,b),l=b}}if(!t)return null;const d=e+"/nodes/",u=d+(t&&t.split("/").pop());try{return{type:"node",rootNode:(await Object(r["default"])(u,{query:{f:"json",token:n},responseType:"json",signal:c})).data,urlPrefix:d}}catch(b){throw new s["a"]("sceneservice:root-node-missing","Root node missing.",{pageError:l,nodeError:b,url:u})}}},"74af":function(e,t,i){"use strict";i.d(t,"a",(function(){return h})),i.d(t,"b",(function(){return f})),i.d(t,"c",(function(){return b})),i.d(t,"d",(function(){return p})),i.d(t,"e",(function(){return O})),i.d(t,"f",(function(){return j}));var r=i("b2b2"),s=i("d791"),a=i("e431"),n=i("0fc4"),o=i("7361"),c=i("d3cf"),l=(i("4e73"),i("ba58")),d=(i("caf7"),i("d36e")),u=i("9360");function b(e,t=4,i=!0){const r=Object(n["g"])(e[0],e[1],e[2],e.length>3?e[3]:1),s=e[3]<1;return i?new u["a"]({color:r,transparent:s,writeDepth:!0,cullFace:2,renderOccluded:t}):new d["a"]({color:r,transparent:s,writeDepth:!0,cullFace:2,renderOccluded:t})}function p(e,t=4){const i=Object(n["g"])(e[0],e[1],e[2],4===e.length?e[3]:1);return new d["a"]({color:i,transparent:!0,writeDepth:!0,cullFace:1,renderOccluded:t})}function h(e,t,i,r){const n=Object(a["m"])(o["d"].get(),e,i),c=f(n,Object(a["j"])(o["d"].get(),r,n),i,o["a"].get());Object(s["c"])(c,c);const l=Object(a["t"])(o["d"].get(),t,c);return Math.atan2(l[1],l[0])}function f(e,t,i,r){const s=Object(a["u"])(o["d"].get(),e),n=Object(a["u"])(o["d"].get(),t),c=Object(a["j"])(o["d"].get(),s,n);return r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=0,r[4]=n[0],r[5]=n[1],r[6]=n[2],r[7]=0,r[8]=c[0],r[9]=c[1],r[10]=c[2],r[11]=0,r[12]=i[0],r[13]=i[1],r[14]=i[2],r[15]=1,r}function O(e,t){const i=e.getViewForGraphic(t);return Object(r["l"])(i)&&"computeAttachmentOrigin"in i?i.computeAttachmentOrigin(t,e.spatialReference):null}function j(e,t,i){const s=O(e,i);Object(r["l"])(s)?t.elevationAlignedLocation=s:y(t,i.geometry)}function y(e,t){if(Object(r["k"])(t))return;const i="mesh"===t.type?t.anchor:Object(l["a"])(t);Object(r["k"])(i)||(e.location=Object(c["b"])(i))}},"7eab":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));const r={attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1},data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1},query:{maxRecordCount:0,maxRecordCountFactor:0,standardMaxRecordCount:0,supportsCacheHint:!1,supportsCentroid:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsStatistics:!1,tileMaxRecordCount:0}}},9360:function(e,t,i){"use strict";i.d(t,"a",(function(){return F}));var r=i("e431"),s=i("0b2d"),a=i("4261"),n=i("8190"),o=i("fc00"),c=i("d7f7"),l=i("b061"),d=i("35b3"),u=i("1153"),b=i("5957"),p=i("7c51"),h=i("a4ee"),f=i("0fc4"),O=i("2252"),j=i("d272"),y=i("c6d7"),g=i("8e97"),m=i("c3a4"),v=i("ca98"),_=i("da35"),w=i("7438"),S=i("c829"),C=i("692f"),P=i("189c");class x extends v["a"]{initializeProgram(e){const t=x.shader.get(),i=this.configuration,r=t.build({output:i.output,slicePlaneEnabled:i.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,screenSizeEnabled:i.screenSizeEnabled,shadingEnabled:i.shadingEnabled,OITEnabled:0===i.transparencyPassType,multipassTerrainEnabled:i.multipassTerrainEnabled,cullAboveGround:i.cullAboveGround});return new S["a"](e.rctx,r,T)}bindPass(e,t){const{screenSizeEnabled:i,shadingEnabled:r}=this.configuration,{color:s,shadingTint:a,shadingDirection:n}=e;Object(g["c"])(this.program,t.camera.projectionMatrix),this.program.setUniform4fv("color",s),t.multipassTerrainEnabled&&(this.program.setUniform2fv("cameraNearFar",t.camera.nearFar),this.program.setUniform2fv("inverseViewport",t.inverseViewport),Object(y["a"])(this.program,t)),r&&(this.program.setUniform4fv("shadedColor",this.blendColor(L,a,s)),this.program.setUniform3fv("shadingDirection",n),this.program.setUniformMatrix4fv("viewNormal",t.camera.viewInverseTransposeMatrix)),i&&Object(O["b"])(this.program,e,t)}bindDraw(e){Object(g["d"])(this.program,e),Object(g["a"])(this.program,e.origin,e.camera.viewInverseTransposeMatrix),Object(j["c"])(this.program,this.configuration,e),this.program.rebindTextures()}blendColor(e,t,i){const r=1-t[3],s=t[3]+i[3]*r;return 0===s?(e[3]=s,e):(e[0]=(t[0]*t[3]+i[0]*i[3]*r)/s,e[1]=(t[1]*t[3]+i[1]*i[3]*r)/s,e[2]=(t[2]*t[3]+i[2]*i[3]*r)/s,e[3]=i[3],e)}setPipelineState(e){const t=this.configuration,i=3===e,r=2===e;return Object(P["g"])({blending:0!==t.output&&7!==t.output||!t.transparent?null:i?w["g"]:Object(w["a"])(e),culling:Object(P["c"])(t.cullFace),depthTest:{func:r?513:t.shadingEnabled?515:513},depthWrite:i?t.writeDepth&&P["e"]:Object(w["c"])(e),colorWrite:P["d"],polygonOffset:i||r?null:w["d"]})}initializePipeline(){return this.setPipelineState(this.configuration.transparencyPassType)}}x.shader=new m["a"](C["a"],()=>i.e("chunk-2d2219c9").then(i.bind(null,"caa6")));class E extends _["a"]{constructor(){super(...arguments),this.output=0,this.cullFace=0,this.slicePlaneEnabled=!1,this.transparent=!1,this.writeDepth=!0,this.screenSizeEnabled=!0,this.shadingEnabled=!0,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1}}Object(h["a"])([Object(_["b"])({count:8})],E.prototype,"output",void 0),Object(h["a"])([Object(_["b"])({count:3})],E.prototype,"cullFace",void 0),Object(h["a"])([Object(_["b"])()],E.prototype,"slicePlaneEnabled",void 0),Object(h["a"])([Object(_["b"])()],E.prototype,"transparent",void 0),Object(h["a"])([Object(_["b"])()],E.prototype,"writeDepth",void 0),Object(h["a"])([Object(_["b"])()],E.prototype,"screenSizeEnabled",void 0),Object(h["a"])([Object(_["b"])()],E.prototype,"shadingEnabled",void 0),Object(h["a"])([Object(_["b"])({count:4})],E.prototype,"transparencyPassType",void 0),Object(h["a"])([Object(_["b"])()],E.prototype,"multipassTerrainEnabled",void 0),Object(h["a"])([Object(_["b"])()],E.prototype,"cullAboveGround",void 0);const T=new Map([["position",0],["normal",1],["offset",2]]),L=Object(f["e"])();class F extends d["a"]{constructor(e){super(e,D),this.supportsEdges=!0,this.techniqueConfig=new E,this._vertexAttributeLocations=T}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.parameters.cullFace,this.techniqueConfig.slicePlaneEnabled=this.parameters.slicePlaneEnabled,this.techniqueConfig.transparent=this.parameters.transparent,this.techniqueConfig.writeDepth=this.parameters.writeDepth,this.techniqueConfig.screenSizeEnabled=this.parameters.screenSizeEnabled,this.techniqueConfig.shadingEnabled=this.parameters.shadingEnabled,this.techniqueConfig.transparencyPassType=t.transparencyPassType,this.techniqueConfig.multipassTerrainEnabled=t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=t.cullAboveGround,this.techniqueConfig}getPassParameters(){return this.parameters}intersect(e,t,i,s,n,o,c){if(this.parameters.screenSizeEnabled){const i=e.vertexAttributes.get("offset"),l={applyToVertex:(e,t,a,n)=>{const o=Object(r["z"])(z,i.data[3*n+0],i.data[3*n+1],i.data[3*n+2]),c=Object(r["z"])(M,e,t,a);return Object(r["h"])(o,o,this.parameters.screenSize*s.camera.computeRenderPixelSizeAt(o)),Object(r["i"])(c,c,o),[c[0],c[1],c[2]]},applyToAabb:e=>{const t=Object(a["e"])(e,z);return Object(a["B"])(e,this.parameters.screenSize*s.camera.computeRenderPixelSizeAt(t))}};Object(p["i"])(e,t,s,n,o,l,c)}else Object(p["i"])(e,t,s,n,o,void 0,c)}requiresSlot(e,t){if(4===Object(l["b"])(t))return 2===e;let i=2;return this.parameters.transparent&&(i=this.parameters.writeDepth?4:7),e===i||20===e}createGLMaterial(e){return 0===e.output||7===e.output||4===e.output?new R(e):null}createBufferWriter(){return new k(this.parameters.screenSizeEnabled)}}class R extends c["a"]{updateParameters(e){return this.ensureTechnique(x,e)}beginSlot(e){return this.updateParameters(e)}bind(e,t){t.bindPass(this._material.getPassParameters(),e)}}const D={color:[1,1,1,1],shadingTint:[0,0,0,.25],shadingDirection:Object(r["u"])(Object(s["f"])(),[.5,-.5,-.5]),transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,screenSizeEnabled:!1,screenSize:14,shadingEnabled:!0,...d["b"]};class k{constructor(e){this.screenSizeEnabled=e;const t=Object(o["a"])().vec3f("position").vec3f("normal");this.screenSizeEnabled&&t.vec3f("offset"),this.vertexBufferLayout=t}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get("position").length}write(e,t,i,r){if(Object(b["c"])(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,i,r),this.screenSizeEnabled){if(!t.vertexAttributes.has("offset"))throw new Error("offset vertex attribute required for screenSizeEnabled ShadedColorMaterial");{const s=t.vertexAttributes.get("offset"),a=t.indices.get("offset");Object(u["a"])(3===s.size);const o=i.getField("offset",n["u"]);if(!o)throw new Error("unable to acquire view for offset");Object(b["e"])(a,s.data,e.invTranspTransformation,o,r)}}}}const z=Object(s["f"])(),M=Object(s["f"])()},"94e6":function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var r=i("b2b2"),s=i("d791"),a=i("afe1"),n=i("e431"),o=i("0b2d"),c=i("7577"),l=i("5ef2"),d=i("5fae"),u=i("d408"),b=i("86ba");class p extends d["a"]{constructor(e){super(e),this._renderOccluded=4,this._width=1,this._color=Object(l["c"])(1,0,1,1),this._innerWidth=1,this._innerColor=null,this._stipplePattern=null,this._stippleOffColor=null,this._stipplePreferContinuous=!0,this._writeDepthEnabled=!0,this._falloff=0,this._polygonOffset=!1,this.applyProps(e)}setGeometryFromRenderSpacePoint(e){const t=1e3,i=[];i.push([[e[0]-t,e[1]+0,e[2]+0],[e[0]+t,e[1]+0,e[2]+0]]),i.push([[e[0]-0,e[1]-t,e[2]+0],[e[0]+0,e[1]+t,e[2]+0]]),i.push([[e[0]-0,e[1]+0,e[2]-t],[e[0]+0,e[1]+0,e[2]+t]]),this.geometry=i}setGeometryFromExtent(e){const t=this.view.spatialReference,i=Object(o["f"])(),r=Object(o["f"])(),s=100,a=[];Object(n["z"])(i,e[0],e[1],s),this.view.renderCoordsHelper.toRenderCoords(i,t,r),a.push([r[0],r[1],r[2]]),Object(n["z"])(i,e[2],e[1],s),this.view.renderCoordsHelper.toRenderCoords(i,t,r),a.push([r[0],r[1],r[2]]),Object(n["z"])(i,e[2],e[3],s),this.view.renderCoordsHelper.toRenderCoords(i,t,r),a.push([r[0],r[1],r[2]]),Object(n["z"])(i,e[0],e[3],s),this.view.renderCoordsHelper.toRenderCoords(i,t,r),a.push([r[0],r[1],r[2]]),Object(n["z"])(i,e[0],e[1],s),this.view.renderCoordsHelper.toRenderCoords(i,t,r),a.push([r[0],r[1],r[2]]),Object(n["z"])(i,e[0],e[1],s),this.view.renderCoordsHelper.toRenderCoords(i,t,r),a.push([r[0],r[1],r[2]]),this.geometry=[a]}setGeometryFromFrustum(e){const t=[];e.lines.forEach(e=>{t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])}),this.geometry=[t]}setGeometryFromBoundedPlane(e){const t=[],i=e.origin,r=e.basis1,s=e.basis2,a=.5,n=Object(o["f"])(),c=Object(o["f"])(),l=Object(o["f"])(),d=Object(o["f"])();n[0]=i[0]-r[0]*a-s[0]*a,n[1]=i[1]-r[1]*a-s[1]*a,n[2]=i[2]-r[2]*a-s[2]*a,c[0]=i[0]-r[0]*a+s[0]*a,c[1]=i[1]-r[1]*a+s[1]*a,c[2]=i[2]-r[2]*a+s[2]*a,l[0]=i[0]+r[0]*a+s[0]*a,l[1]=i[1]+r[1]*a+s[1]*a,l[2]=i[2]+r[2]*a+s[2]*a,d[0]=i[0]+r[0]*a-s[0]*a,d[1]=i[1]+r[1]*a-s[1]*a,d[2]=i[2]+r[2]*a-s[2]*a,t.push([n[0],n[1],n[2]]),t.push([c[0],c[1],c[2]]),t.push([l[0],l[1],l[2]]),t.push([d[0],d[1],d[2]]),t.push([n[0],n[1],n[2]]),this.geometry=[t]}setGeometryFromSegment(e){const t=e.endRenderSpace;Object(s["j"])(h),Object(s["b"])(h,h,t),this.transform=h;const{points:i}=e.createRenderGeometry(t,this.view.renderCoordsHelper);this.geometry=[i]}setGeometryFromSegments(e,t=o["c"]){Object(s["j"])(h),Object(s["b"])(h,h,t),this.transform=h,this.geometry=e.map(e=>e.createRenderGeometry(t,this.view.renderCoordsHelper).points)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){Object(c["g"])(e,this._color)||(Object(c["c"])(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){Object(r["l"])(e)?!Object(r["k"])(this._innerColor)&&Object(c["g"])(e,this._innerColor)||(this._innerColor=Object(c["c"])(Object(l["b"])(),e),this._updateMaterial()):Object(r["l"])(this._innerColor)&&(this._innerColor=null,this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const t=Object(r["l"])(e)!==Object(r["l"])(this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){(Object(r["k"])(e)||Object(r["k"])(this._stippleOffColor)||!Object(c["g"])(e,this._stippleOffColor))&&(this._stippleOffColor=Object(r["l"])(e)?Object(l["a"])(e):null,this._updateMaterial())}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(e){this._stipplePreferContinuous!==e&&(this._stipplePreferContinuous=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}createExternalResources(){this._material=new b["a"](this.materialParameters)}destroyExternalResources(){this._material=null}createGeometries(e){const t=this._createLineGeometries();if(0!==t.length)for(let i=0;i<t.length;++i){const r=Object(u["a"])(t[i]);e.addGeometry(r,this._material)}}forEachExternalMaterial(e){e(this._material)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,isClosed:!1,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,polygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}_updateMaterial(){this.attached&&this._material.setParameters(this.materialParameters)}_createLineGeometries(){const e=this.geometry;if(Object(r["k"])(e)||0===e.length)return[];const t=[];return e.forEach(e=>{const i=e.length,r=new Float64Array(3*i);e.forEach((e,t)=>{r[3*t+0]=e[0],r[3*t+1]=e[1],r[3*t+2]=e[2]});const s={overlayInfo:null,attributeData:{position:r},removeDuplicateStartEnd:0};t.push(s)}),t}}const h=Object(a["d"])()},"9c6b":function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return z}));var r=i("a4ee"),s=i("fc29"),a=i("b2b2"),n=i("59b2"),o=(i("b50f"),i("c120"),i("cea0"),i("d386")),c=i("1bd2"),l=i("af40"),d=i("e92d"),u=i("477c"),b=i("3795"),p=i("0d9f"),h=i("a6a3"),f=i("e814");function O(e,t,i){i.warnOnce(`Failed to project analysis geometry (id: '${e.id}'), projection from spatial reference (wkid: '${t.wkid}') to view spatial reference is not supported. Projection may be possible after calling projection.load().`)}var j=i("0ee7"),y=i("073b");const g=d["a"].getLogger("esri.views.3d.analysis.Slice.SliceController");let m=class extends s["a"]{constructor(e){super(e),this._handles=new l["a"],this._internalChange=!1,this._currentSlicePlane=null,this.state="pending"}get ready(){return"ready"===this.state}initialize(){this._handles.add(this.analysis.excludedLayers.on("before-add",e=>{const t=e.item;null!=t&&(t instanceof h["a"]||t instanceof f["a"])?t instanceof h["a"]&&Object(j["j"])(t)?(g.error("excludedLayers",`Layer '${t.title}, id:${t.id}' of type '${t.type}' can not be individually excluded from slicing. Use 'excludeGroundSurface' instead.`),e.preventDefault()):this.analysis.excludedLayers.includes(t)&&e.preventDefault():(g.error("excludedLayers","Invalid layer type, layer must derive from Layer or BuildingComponentSublayer"),e.preventDefault())})),this._handles.add(Object(u["c"])(()=>this.view.ready&&Object(a["l"])(this.view.renderCoordsHelper),()=>this._initialize(),{sync:!0,initial:!0,once:!0}))}_initialize(){"destroyed"!==this.state&&"ready"!==this.state&&(S(this.view,this),this._handles.add([Object(u["b"])(()=>this.analysisView.analysisViewData.plane,()=>{this._internalChange||this._updateSlicePlaneFromBoundedPlane(),this._updateLayerViews()},{sync:!0}),Object(u["b"])(()=>this.analysis.excludeGroundSurface,()=>this._updateLayerViews(),{sync:!0}),this.analysis.excludedLayers.on("change",()=>this._updateLayerViews()),Object(u["b"])(()=>[this.analysisView.active,this.analysisView.visible],()=>{this._updateActiveController(),this._updateViewSlicePlane()},{sync:!0}),Object(u["b"])(()=>this._allLayerAndSubLayerViews,()=>this._updateLayerViews())]),this._handles.add([Object(u["b"])(()=>this.analysis.shape,()=>{this._internalChange||(this._updateBoundedPlaneFromSlicePlane(),this._updateViewSlicePlane())},{sync:!0})],"analysis"),this._set("state","ready"),this._updateActiveController(),this._updateBoundedPlaneFromSlicePlane(),this._updateViewSlicePlane())}destroy(){"destroyed"!==this.state&&"pending"!==this.state&&(this.analysisView.active=!1,P(this.view,this),this._handles.destroy(),this.view.slicePlane=null,this.set("view",null),this._set("state","destroyed"))}async whenReady(){return await Object(b["k"])(this,"ready"),this}get _allLayerAndSubLayerViews(){const e=this.view.allLayerViews.items;return e.concat(e.filter(j["l"]).flatMap(({sublayerViews:e})=>e.items))}_updateBoundedPlaneFromSlicePlane(){const e=this.analysis.shape,t=this._currentSlicePlane;if(Object(a["k"])(t)&&Object(a["k"])(e)||Object(a["l"])(t)&&Object(a["l"])(e)&&e.equals(t))return;let i=null,r=null;if(Object(a["l"])(e)&&Object(a["l"])(e.position)){const t=e.position.spatialReference,s=Object(j["n"])(e,this.view.spatialReference);Object(a["k"])(s)&&O(this.analysis,t,g),i=Object(j["o"])(s,this.view,{tiltEnabled:this.analysis.tiltEnabled},Object(p["d"])()),Object(a["l"])(i)&&(r={heading:e.heading,tilt:e.tilt,position:e.position,width:e.width,height:e.height})}this._currentSlicePlane=r,this._internalChange=!0,this.analysisView.analysisViewData.plane=i,this._internalChange=!1}_updateSlicePlaneFromBoundedPlane(){const e=this.analysisView.analysisViewData.plane,t=Object(j["m"])(e,this.view,this.view.spatialReference,new y["a"]);let i=null;Object(a["l"])(t)&&(i={heading:t.heading,tilt:t.tilt,position:t.position,width:t.width,height:t.height}),this._currentSlicePlane=i,this._internalChange=!0,this.analysis.shape=t,this._internalChange=!1,this._updateViewSlicePlane()}_updateActiveController(){if(_)return;const e=C(this.view);if(this.analysisView.active)Object(a["l"])(e.activeController)&&e.activeController!==this?(_=!0,e.activeController.analysisView.active=!1,_=!1):Object(a["l"])(e.activeController)&&e.activeController,this._updateLayerViews(),e.activeController=this;else{if(Object(a["l"])(e.activeController)&&e.activeController!==this)return;Object(a["l"])(e.activeController)&&e.activeController===this&&(e.activeController=null,this._updateLayerViews())}}_updateViewSlicePlane(){"ready"===this.state&&w(this.view)}_updateLayerViews(){const e=Object(a["l"])(this.analysisView.analysisViewData.plane)&&this.analysisView.visible&&this.analysisView.active,t=[],i=e=>{"layers"in e?e.layers.forEach(i):t.push(e)};this.analysis.excludedLayers.forEach(i),this.view.allLayerViews.forEach(i=>{i.destroyed||("slicePlaneEnabled"in i&&(i.slicePlaneEnabled=e&&t.indexOf(i.layer)<0),"sublayerViews"in i&&i.sublayerViews.forEach(i=>{i.slicePlaneEnabled=e&&t.indexOf(i.sublayer)<0}))}),null!=this.view.basemapTerrain&&(this.view.basemapTerrain.slicePlaneEnabled=e&&!this.analysis.excludeGroundSurface)}};Object(r["a"])([Object(n["b"])({readOnly:!0})],m.prototype,"state",void 0),Object(r["a"])([Object(n["b"])()],m.prototype,"view",void 0),Object(r["a"])([Object(n["b"])()],m.prototype,"analysis",void 0),Object(r["a"])([Object(n["b"])()],m.prototype,"analysisView",void 0),Object(r["a"])([Object(n["b"])()],m.prototype,"ready",null),Object(r["a"])([Object(n["b"])()],m.prototype,"_allLayerAndSubLayerViews",null),m=Object(r["a"])([Object(o["a"])("esri.views.3d.analysis.Slice.SliceController")],m);const v=new Map;let _=!1;function w(e){const t=C(e).activeController;Object(a["l"])(t)&&Object(a["l"])(t.analysisView.analysisViewData.plane)&&t.analysisView.visible?e.slicePlane=t.analysisView.analysisViewData.plane:e.slicePlane=null}function S(e,t){v.has(e)||v.set(e,{all:[],activeController:null}),v.get(e).all.push(t)}function C(e){return v.get(e)}function P(e,t){if(!v.has(e))throw new Error("view expected in global slice register");const i=v.get(e),r=i.all.lastIndexOf(t);if(-1===r)throw new Error("controller expected in global slice register");i.all.splice(r,1),0===i.all.length&&v.delete(e)}let x=class extends s["a"]{constructor(){super(...arguments),this.plane=null}};Object(r["a"])([Object(n["b"])()],x.prototype,"plane",void 0),x=Object(r["a"])([Object(o["a"])("esri.views.3d.analysis.Slice.SliceViewData")],x);var E=i("d791"),T=i("e431"),L=i("7361"),F=i("14b5"),R=i("3544");let D=class extends s["a"]{constructor(e){super(e),this._handles=new l["a"],this._gridVisualElement=null,this._outlineVisualElement=null,this.state="pending",this.showGrid=!1,this.editable=!0}get ready(){return"ready"===this.state}initialize(){this._initialize()}async _initialize(){if("destroyed"===this.state||"ready"===this.state)return;await Object(b["k"])(this.view,"ready",!0);const e=this.analysisView.analysisViewData;if(Object(a["k"])(e))throw new Error("expected internal object to be valid");this._gridVisualElement=Object(j["d"])(this.view),this._outlineVisualElement=Object(j["e"])(this.view),this._handles.add([Object(u["b"])(()=>({visible:Object(a["l"])(e.plane)&&this.analysisView.visible,active:this.analysisView.active,editable:this.editable,showGrid:this.showGrid}),e=>this._updateMaterials(e),u["e"]),Object(u["b"])(()=>e.plane,e=>this._updatePlane(e),u["e"])],"internal"),this._set("state","ready")}destroy(){"destroyed"!==this.state&&"pending"!==this.state&&(this._handles.destroy(),this._gridVisualElement=Object(a["e"])(this._gridVisualElement),this._outlineVisualElement=Object(a["e"])(this._outlineVisualElement),this.set("view",null),this._set("state","destroyed"))}async whenReady(){return await Object(b["k"])(this,"ready"),this}_updatePlane(e){if(Object(a["k"])(e))return;const t=Object(T["z"])(L["d"].get(),Object(T["s"])(e.basis1),Object(T["s"])(e.basis2),1),i=Object(E["x"])(L["a"].get(),t),r=Object(j["b"])(e,L["a"].get()),s=Object(E["n"])(i,r,i);this._outlineVisualElement.transform=s,this._gridVisualElement.transform=s}_updateMaterials({visible:e,active:t,editable:i,showGrid:r}){this._outlineVisualElement.color=F["f"],this._outlineVisualElement.width=i?F["g"]:F["h"],this._outlineVisualElement.stipplePattern=t?null:Object(R["a"])(5);const s=r?F["b"]:[0,0,0,0];this._gridVisualElement.backgroundColor=F["d"],this._gridVisualElement.gridColor=s,this._gridVisualElement.visible=e,this._outlineVisualElement.visible=e}};Object(r["a"])([Object(n["b"])({readOnly:!0})],D.prototype,"state",void 0),Object(r["a"])([Object(n["b"])()],D.prototype,"view",void 0),Object(r["a"])([Object(n["b"])()],D.prototype,"analysis",void 0),Object(r["a"])([Object(n["b"])()],D.prototype,"analysisView",void 0),Object(r["a"])([Object(n["b"])()],D.prototype,"ready",null),Object(r["a"])([Object(n["b"])()],D.prototype,"showGrid",void 0),Object(r["a"])([Object(n["b"])()],D.prototype,"editable",void 0),D=Object(r["a"])([Object(o["a"])("esri.views.3d.analysis.Slice.SliceVisualization")],D);let k=class extends(Object(c["a"])(s["a"])){constructor(e){super(e),this.type="slice-view",this.analysisVisualization=null,this.analysisController=null,this.analysisViewData=new x,this.active=!0,this.showGrid=!1,this.editable=!1}initialize(){this.analysisVisualization=new D({view:this.view,analysis:this.analysis,analysisView:this}),this.analysisController=new m({view:this.view,analysis:this.analysis,analysisView:this})}destroy(){this.analysisVisualization=Object(a["e"])(this.analysisVisualization),this.analysisController=Object(a["e"])(this.analysisController)}async when(){return await this.analysisVisualization.whenReady(),await this.analysisController.whenReady(),this}get testData(){return{visualization:this.analysisVisualization,controller:this.analysisController}}};Object(r["a"])([Object(n["b"])()],k.prototype,"type",void 0),Object(r["a"])([Object(n["b"])()],k.prototype,"analysis",void 0),Object(r["a"])([Object(n["b"])()],k.prototype,"analysisViewData",void 0),Object(r["a"])([Object(n["b"])()],k.prototype,"active",void 0),Object(r["a"])([Object(n["b"])({aliasOf:"analysisVisualization.showGrid"})],k.prototype,"showGrid",void 0),Object(r["a"])([Object(n["b"])({aliasOf:"analysisVisualization.editable"})],k.prototype,"editable",void 0),k=Object(r["a"])([Object(o["a"])("esri.views.3d.analysis.Slice.SliceView3D")],k);const z=k},ad96:function(e,t,i){"use strict";i.d(t,"a",(function(){return S}));var r=i("b061"),s=i("68af"),a=i("35b3"),n=i("7438"),o=i("8675"),c=i("7c51"),l=i("a4ee"),d=i("d272"),u=i("c6d7"),b=i("8e97"),p=i("c3a4"),h=i("ca98"),f=i("da35"),O=i("fa1e"),j=i("c829"),y=i("87b7"),g=i("f3d9"),m=i("189c");class v extends h["a"]{initializeProgram(e){const t=v.shader.get(),i=this.configuration,r=t.build({output:i.output,slicePlaneEnabled:i.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,OITEnabled:0===i.transparencyPassType,multipassTerrainEnabled:i.multipassTerrainEnabled,cullAboveGround:i.cullAboveGround});return new j["a"](e.rctx,r,O["a"])}bindPass(e,t){Object(b["c"])(this.program,t.camera.projectionMatrix),this.program.setUniform1f("opacity",e.opacity),t.multipassTerrainEnabled&&(this.program.setUniform2fv("cameraNearFar",t.camera.nearFar),this.program.setUniform2fv("inverseViewport",t.inverseViewport),Object(u["a"])(this.program,t))}bindDraw(e){Object(b["d"])(this.program,e),Object(d["c"])(this.program,this.configuration,e),this.program.rebindTextures()}setPipelineState(e,t){const i=this.configuration,r=3===e,s=2===e;return Object(m["g"])({blending:0!==i.output&&7!==i.output||!i.transparent?null:r?_:Object(n["a"])(e),culling:Object(m["c"])(i.cullFace),depthTest:{func:Object(n["b"])(e)},depthWrite:r?i.writeDepth&&m["e"]:Object(n["c"])(e),colorWrite:m["d"],stencilWrite:i.sceneHasOcludees?y["j"]:null,stencilTest:i.sceneHasOcludees?t?y["f"]:y["e"]:null,polygonOffset:r||s?null:Object(n["h"])(i.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e,t){return t?this._occludeePipelineState:super.getPipelineState(e,t)}}v.shader=new p["a"](g["a"],()=>i.e("chunk-2d215c84").then(i.bind(null,"c056")));const _=Object(m["i"])(1,771);class w extends f["a"]{constructor(){super(...arguments),this.output=0,this.cullFace=0,this.slicePlaneEnabled=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.sceneHasOcludees=!1,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1}}Object(l["a"])([Object(f["b"])({count:8})],w.prototype,"output",void 0),Object(l["a"])([Object(f["b"])({count:3})],w.prototype,"cullFace",void 0),Object(l["a"])([Object(f["b"])()],w.prototype,"slicePlaneEnabled",void 0),Object(l["a"])([Object(f["b"])()],w.prototype,"transparent",void 0),Object(l["a"])([Object(f["b"])()],w.prototype,"enableOffset",void 0),Object(l["a"])([Object(f["b"])()],w.prototype,"writeDepth",void 0),Object(l["a"])([Object(f["b"])()],w.prototype,"sceneHasOcludees",void 0),Object(l["a"])([Object(f["b"])({count:4})],w.prototype,"transparencyPassType",void 0),Object(l["a"])([Object(f["b"])()],w.prototype,"multipassTerrainEnabled",void 0),Object(l["a"])([Object(f["b"])()],w.prototype,"cullAboveGround",void 0);class S extends a["a"]{constructor(e){super(e,P),this.supportsEdges=!0,this.techniqueConfig=new w}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.parameters.cullFace,this.techniqueConfig.slicePlaneEnabled=this.parameters.slicePlaneEnabled,this.techniqueConfig.transparent=this.parameters.transparent,this.techniqueConfig.writeDepth=this.parameters.writeDepth,this.techniqueConfig.sceneHasOcludees=this.parameters.sceneHasOcludees,this.techniqueConfig.transparencyPassType=t.transparencyPassType,this.techniqueConfig.enableOffset=t.camera.relativeElevation<n["e"],this.techniqueConfig.multipassTerrainEnabled=t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=t.cullAboveGround,this.techniqueConfig}intersect(e,t,i,r,s,a,n){Object(c["i"])(e,t,r,s,a,void 0,n)}requiresSlot(e,t){return 20===e||(4===Object(r["b"])(t)?2===e:e===(this.parameters.transparent?this.parameters.writeDepth?4:7:2))}createGLMaterial(e){return 0===e.output||7===e.output||4===e.output?new C(e):void 0}createBufferWriter(){return new o["a"](o["d"])}}class C extends s["a"]{constructor(e){super({...e,...e.material.parameters})}updateParameters(e){const t=this._material.parameters;return this.updateTexture(t.textureId),this.ensureTechnique(v,e)}_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.sceneHasOcludees&&(this._material.setParameters({sceneHasOcludees:e.hasOccludees}),this.updateParameters(e))}beginSlot(e){return 0!==this._output&&7!==this._output||this._updateOccludeeState(e),this.updateParameters(e)}bind(e,t){this.bindTextures(t.program),this.bindTextureScale(t.program),t.bindPass(this._material.parameters,e)}}const P={transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1,opacity:1,textureId:null,initTextureTransparent:!0,...a["b"]}},b04d:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var r=i("3886"),s=i("690a");function a(){const e=new s["a"];return e.extensions.add("GL_OES_standard_derivatives"),e.vertex.uniforms.add("proj","mat4").add("view","mat4"),e.attributes.add("position","vec3"),e.attributes.add("uv0","vec2"),e.varyings.add("vUV","vec2"),e.vertex.code.add(r["a"]`void main(void) {
vUV = uv0;
gl_Position = proj * view * vec4(position, 1.0);
}`),e.fragment.uniforms.add("backgroundColor","vec4").add("gridColor","vec4").add("ratio","float").add("gridWidth","float"),e.fragment.code.add(r["a"]`void main() {
const float LINE_WIDTH = 1.0;
vec2 uvScaled = vUV * gridWidth;
vec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));
vec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);
grid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);
grid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);
float gridFade = max(grid.x, grid.y);
float gridAlpha = gridColor.a * gridFade;
gl_FragColor =
vec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +
vec4(gridColor.rgb, 1.0) * gridAlpha;
}`),e}const n=Object.freeze({__proto__:null,build:a})},c6f7:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var r=i("b2b2"),s=i("2698"),a=i("e041"),n=i("8eed"),o=i("7af8"),c=i("92ef"),l=i("59b2");function d(e){return p[u(e)]||f}function u(e){return e instanceof Blob?e.type:b(e.url)}function b(e){const t=Object(a["n"])(e);return O[t]||h}const p={},h="text/plain",f=p[h],O={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip"};for(const T in O)p[O[T]]=T;var j=i("fcf2");function y(e){const t=Object(r["l"])(e)&&e.origins?e.origins:[void 0];return(i,r)=>{const s=g(e,i,r);for(const e of t){const t=Object(l["c"])(i,e,r);for(const e in s)t[e]=s[e]}}}function g(e,t,i){if(Object(r["l"])(e)&&"resource"===e.type)return m(e,t,i);switch(Object(r["l"])(e)&&e.type?e.type:"other"){case"other":return{read:!0,write:!0};case"url":{const{read:e,write:t}=j["c"];return{read:e,write:t}}}}function m(e,t,i){const n=Object(o["b"])(t,i);return{type:String,read:(e,t,i)=>{const r=Object(j["d"])(e,t,i);return n.type===String?r:"function"==typeof n.type?new n.type({url:r}):void 0},write:{writer(t,o,l,d){if(!d||!d.resources)return"string"==typeof t?void(o[l]=Object(j["e"])(t,d)):void(o[l]=t.write({},d));const u=x(t),b=u?Object(j["e"])(u,{...d,verifyItemRelativeUrls:d&&d.verifyItemRelativeUrls?{writtenUrls:d.verifyItemRelativeUrls.writtenUrls,rootPath:null}:null},1):null,p=n.type!==String&&(!Object(s["a"])(this)||d&&d.origin&&this.originIdOf(i)>Object(c["d"])(d.origin));d&&d.portalItem&&Object(r["l"])(b)&&!Object(a["s"])(b)?p?_(this,i,t,b,o,l,d,e):w(b,o,l,d):d&&d.portalItem&&(Object(r["k"])(b)||Object(r["l"])(Object(j["b"])(b))||Object(a["t"])(b)||p)?v(this,i,t,b,o,l,d,e):o[l]=b}}}}function v(e,t,i,s,o,c,l,u){const b=Object(n["a"])(),p=C(i,s,l),h=Object(a["z"])(Object(r["j"])(u,"prefix"),b),f=`${h}.${d(p)}`,O=l.portalItem.resourceFromPath(f);Object(a["t"])(s)&&l.resources.pendingOperations.push(P(s).then(e=>{O.path=`${h}.${d(e)}`,o[c]=O.itemRelativeUrl}).catch(()=>{})),S(e,t,O,p,l.resources.toAdd),o[c]=O.itemRelativeUrl}function _(e,t,i,r,s,n,o,c){const l=o.portalItem.resourceFromPath(r),u=C(i,r,o);d(u)===Object(a["n"])(l.path)?(S(e,t,l,u,o.resources.toUpdate),s[n]=r):v(e,t,i,r,s,n,o,c)}function w(e,t,i,r){r.resources.toKeep.push({resource:r.portalItem.resourceFromPath(e)}),t[i]=e}function S(e,t,i,r,s){s.push({resource:i,content:r,finish:i=>{E(e,t,i)}})}function C(e,t,i){return"string"==typeof e?{url:t}:new Blob([JSON.stringify(e.toJSON(i))],{type:"application/json"})}async function P(e){const t=(await Promise.resolve().then(i.bind(null,"2eab"))).default,{data:r}=await t(e,{responseType:"blob"});return r}function x(e){return Object(r["k"])(e)?null:"string"==typeof e?e:e.url}function E(e,t,i){"string"==typeof e[t]?e[t]=i.url:e[t].url=i.url}},e814:function(e,t,i){"use strict";i.d(t,"a",(function(){return D}));var r=i("a4ee"),s=i("4856"),a=(i("b423"),i("261a"),i("b48d"),i("478c"),i("667b"),i("ff57"),i("da00"),i("f976"),i("5cdb")),n=i("2eab"),o=i("ce50"),c=i("fa8a"),l=i("6d5f"),d=i("e92d"),u=i("b2b2"),b=i("fab3"),p=i("59b2"),h=(i("b50f"),i("c120"),i("cea0"),i("448d")),f=i("afcf"),O=i("d386"),j=i("3af1"),y=i("5996"),g=i("5bd5"),m=i("2e4d"),v=i("7eab"),_=i("22f4"),w=i("2feb"),S=i("80b7"),C=i("6e36"),P=i("5d34"),x=i("69dd"),E=i("f51b"),T=i("fd14");const L=d["a"].getLogger("esri.layers.buildingSublayers.BuildingComponentSublayer"),F=Object(w["a"])();let R=class extends(l["a"].LoadableMixin(Object(b["b"])(m["a"]))){constructor(e){super(e),this.type="building-component",this.nodePages=null,this.materialDefinitions=null,this.textureSetDefinitions=null,this.geometryDefinitions=null,this.serviceUpdateTimeStamp=null,this.fields=null,this.associatedLayer=null,this.outFields=null,this.listMode="show",this.renderer=null,this.definitionExpression=null,this.popupEnabled=!0,this.popupTemplate=null,this.layerType="3d-object"}get parsedUrl(){return this.layer?{path:`${this.layer.parsedUrl.path}/sublayers/${this.id}`,query:this.layer.parsedUrl.query}:null}get fieldsIndex(){return new S["a"](this.fields)}readAssociatedLayer(e,t){const i=this.layer.associatedFeatureServiceItem,r=t.associatedLayerID;return Object(u["l"])(i)&&"number"==typeof r?new g["default"]({portalItem:i,layerId:r}):null}get objectIdField(){if(null!=this.fields)for(const e of this.fields)if("oid"===e.type)return e.name;return null}get displayField(){return Object(u["l"])(this.associatedLayer)?this.associatedLayer.displayField:null}get defaultPopupTemplate(){return this.createPopupTemplate()}load(e){const t=Object(u["l"])(e)?e.signal:null,i=this._fetchService(t).then(()=>{this.indexInfo=Object(C["a"])(this.parsedUrl.path,this.rootNode,this.nodePages,this.apiKey,L,t)});return this.addResolvingPromise(i),Promise.resolve(this)}createPopupTemplate(e){return Object(E["a"])(this,e)}async _fetchService(e){const t=(await Object(n["default"])(this.parsedUrl.path,{query:{f:"json",token:this.apiKey},responseType:"json",signal:e})).data;this.read(t,{origin:"service",url:this.parsedUrl})}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,t){var i,r,s,a;const n=null==(i=this.getFeatureType(null==t?void 0:t.feature))||null==(r=i.domains)?void 0:r[e];return n&&"inherited"!==n.type?n:null!=(s=null==(a=this.getField(e))?void 0:a.domain)?s:null}getFeatureType(e){return e&&Object(u["l"])(this.associatedLayer)?this.associatedLayer.getFeatureType(e):null}get types(){return Object(u["l"])(this.associatedLayer)?this.associatedLayer.types:[]}get typeIdField(){return Object(u["l"])(this.associatedLayer)?this.associatedLayer.typeIdField:null}get geometryType(){return"3d-object"===this.layerType?"mesh":"point"}get profile(){return"3d-object"===this.layerType?"mesh-pyramids":"points"}get capabilities(){const e=Object(u["l"])(this.associatedLayer)&&this.associatedLayer.capabilities?this.associatedLayer.capabilities:v["a"],{query:t,data:{supportsZ:i,supportsM:r,isVersioned:s}}=e;return{query:t,data:{supportsZ:i,supportsM:r,isVersioned:s}}}createQuery(){const e=new x["a"];return"mesh"!==this.geometryType&&(e.returnGeometry=!0,e.returnZ=!0),e.where=this.definitionExpression||"1=1",e.sqlFormat="standard",e}queryExtent(e,t){return this._getAssociatedLayerForQuery().then(i=>i.queryExtent(e||this.createQuery(),t))}queryFeatureCount(e,t){return this._getAssociatedLayerForQuery().then(i=>i.queryFeatureCount(e||this.createQuery(),t))}queryFeatures(e,t){return this._getAssociatedLayerForQuery().then(i=>i.queryFeatures(e||this.createQuery(),t)).then(e=>{if(null!=e&&e.features)for(const t of e.features)t.layer=this.layer,t.sourceLayer=this;return e})}queryObjectIds(e,t){return this._getAssociatedLayerForQuery().then(i=>i.queryObjectIds(e||this.createQuery(),t))}getFieldUsageInfo(e){return this.fieldsIndex.has(e)?{supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1}:{supportsLabelingInfo:!1,supportsRenderer:!0,supportsPopupTemplate:!0,supportsLayerQuery:Object(u["l"])(this.associatedLayer)}}_getAssociatedLayerForQuery(){const e=this.associatedLayer;return Object(u["l"])(e)&&e.loaded?Promise.resolve(e):this._loadAssociatedLayerForQuery()}async _loadAssociatedLayerForQuery(){if(await this.load(),Object(u["k"])(this.associatedLayer))throw new o["a"]("buildingscenelayer:query-not-available","BuildingSceneLayer component layer queries are not available without an associated feature layer",{layer:this});try{await this.associatedLayer.load()}catch(e){throw new o["a"]("buildingscenelayer:query-not-available","BuildingSceneLayer associated feature layer could not be loaded",{layer:this,error:e})}return this.associatedLayer}};Object(r["a"])([Object(p["b"])({readOnly:!0})],R.prototype,"parsedUrl",null),Object(r["a"])([Object(p["b"])({type:P["c"],readOnly:!0})],R.prototype,"nodePages",void 0),Object(r["a"])([Object(p["b"])({type:[P["b"]],readOnly:!0})],R.prototype,"materialDefinitions",void 0),Object(r["a"])([Object(p["b"])({type:[P["d"]],readOnly:!0})],R.prototype,"textureSetDefinitions",void 0),Object(r["a"])([Object(p["b"])({type:[P["a"]],readOnly:!0})],R.prototype,"geometryDefinitions",void 0),Object(r["a"])([Object(p["b"])({readOnly:!0})],R.prototype,"serviceUpdateTimeStamp",void 0),Object(r["a"])([Object(p["b"])({readOnly:!0})],R.prototype,"store",void 0),Object(r["a"])([Object(p["b"])({type:String,readOnly:!0,json:{read:{source:"store.rootNode"}}})],R.prototype,"rootNode",void 0),Object(r["a"])([Object(p["b"])({readOnly:!0})],R.prototype,"attributeStorageInfo",void 0),Object(r["a"])([Object(p["b"])(F.fields)],R.prototype,"fields",void 0),Object(r["a"])([Object(p["b"])({readOnly:!0})],R.prototype,"fieldsIndex",null),Object(r["a"])([Object(p["b"])({readOnly:!0,type:g["default"]})],R.prototype,"associatedLayer",void 0),Object(r["a"])([Object(f["a"])("service","associatedLayer",["associatedLayerID"])],R.prototype,"readAssociatedLayer",null),Object(r["a"])([Object(p["b"])(F.outFields)],R.prototype,"outFields",void 0),Object(r["a"])([Object(p["b"])({type:String,readOnly:!0})],R.prototype,"objectIdField",null),Object(r["a"])([Object(p["b"])({readOnly:!0,type:String,json:{read:!1}})],R.prototype,"displayField",null),Object(r["a"])([Object(p["b"])({readOnly:!0,type:String,aliasOf:"layer.apiKey"})],R.prototype,"apiKey",void 0),Object(r["a"])([Object(p["b"])({readOnly:!0,type:j["a"],aliasOf:"layer.fullExtent"})],R.prototype,"fullExtent",void 0),Object(r["a"])([Object(p["b"])({readOnly:!0,type:y["a"],aliasOf:"layer.spatialReference"})],R.prototype,"spatialReference",void 0),Object(r["a"])([Object(p["b"])({readOnly:!0,aliasOf:"layer.version"})],R.prototype,"version",void 0),Object(r["a"])([Object(p["b"])({readOnly:!0,type:T["a"],aliasOf:"layer.elevationInfo"})],R.prototype,"elevationInfo",void 0),Object(r["a"])([Object(p["b"])({readOnly:!0,type:Number,aliasOf:"layer.minScale"})],R.prototype,"minScale",void 0),Object(r["a"])([Object(p["b"])({readOnly:!0,type:Number,aliasOf:"layer.maxScale"})],R.prototype,"maxScale",void 0),Object(r["a"])([Object(p["b"])({type:["hide","show"],json:{write:!0}})],R.prototype,"listMode",void 0),Object(r["a"])([Object(p["b"])({types:a["b"],json:{origins:{service:{read:{source:"drawingInfo.renderer"}}},name:"layerDefinition.drawingInfo.renderer",write:!0},value:null})],R.prototype,"renderer",void 0),Object(r["a"])([Object(p["b"])({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],R.prototype,"definitionExpression",void 0),Object(r["a"])([Object(p["b"])(_["j"])],R.prototype,"popupEnabled",void 0),Object(r["a"])([Object(p["b"])({type:s["a"],json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],R.prototype,"popupTemplate",void 0),Object(r["a"])([Object(p["b"])({readOnly:!0,type:String,json:{origins:{service:{read:{source:"store.normalReferenceFrame"}}},read:!1}})],R.prototype,"normalReferenceFrame",void 0),Object(r["a"])([Object(p["b"])({readOnly:!0,json:{read:!1}})],R.prototype,"defaultPopupTemplate",null),Object(r["a"])([Object(p["b"])()],R.prototype,"types",null),Object(r["a"])([Object(p["b"])()],R.prototype,"typeIdField",null),Object(r["a"])([Object(p["b"])({json:{write:!1}}),Object(h["a"])(new c["a"]({"3DObject":"3d-object",Point:"point"}))],R.prototype,"layerType",void 0),Object(r["a"])([Object(p["b"])()],R.prototype,"geometryType",null),Object(r["a"])([Object(p["b"])()],R.prototype,"profile",null),Object(r["a"])([Object(p["b"])({readOnly:!0,json:{read:!1}})],R.prototype,"capabilities",null),R=Object(r["a"])([Object(O["a"])("esri.layers.buildingSublayers.BuildingComponentSublayer")],R);const D=R},f3d9:function(e,t,i){"use strict";i.d(t,"a",(function(){return b})),i.d(t,"b",(function(){return u}));var r=i("d272"),s=i("4db9"),a=i("d047"),n=i("c6d7"),o=i("ebd5"),c=i("4377"),l=i("3886"),d=i("690a");function u(e){const t=new d["a"];return t.include(s["a"],{linearDepth:!1}),t.vertex.uniforms.add("proj","mat4").add("view","mat4"),t.attributes.add("position","vec3"),t.attributes.add("uv0","vec2"),t.varyings.add("vpos","vec3"),e.multipassTerrainEnabled&&t.varyings.add("depth","float"),t.vertex.uniforms.add("textureCoordinateScaleFactor","vec2"),t.vertex.code.add(l["a"]`
    void main(void) {
      vpos = position;
      ${e.multipassTerrainEnabled?"depth = (view * vec4(vpos, 1.0)).z;":""}
      vTexCoord = uv0 * textureCoordinateScaleFactor;
      gl_Position = transformPosition(proj, view, vpos);
    }
  `),t.include(r["a"],e),e.multipassTerrainEnabled&&(t.fragment.include(a["a"]),t.include(n["b"],e)),t.fragment.uniforms.add("tex","sampler2D"),t.fragment.uniforms.add("opacity","float"),t.varyings.add("vTexCoord","vec2"),7===e.output?t.fragment.code.add(l["a"]`
    void main() {
      discardBySlice(vpos);
      ${e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":""}

      float alpha = texture2D(tex, vTexCoord).a * opacity;
      if (alpha  < ${l["a"].float(o["b"])}) {
        discard;
      }

      gl_FragColor = vec4(alpha);
    }
    `):(t.fragment.include(c["a"]),t.fragment.code.add(l["a"]`
    void main() {
      discardBySlice(vpos);
      ${e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":""}
      gl_FragColor = texture2D(tex, vTexCoord) * opacity;

      if (gl_FragColor.a < ${l["a"].float(o["b"])}) {
        discard;
      }

      gl_FragColor = highlightSlice(gl_FragColor, vpos);
      ${e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}
    }
    `)),t}const b=Object.freeze({__proto__:null,build:u})},f53a:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));class r{constructor(e){this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=e,this.view.watch("ready",e=>{this._resourcesCreated&&(e?this._createResources():this._destroyResources())})}applyProps(e){let t=!1;for(const i in e)i in this?"attached"===i?t=e[i]:this[i]=e[i]:console.error("Cannot set unknown property",i);this.attached=t}destroy(){this.attached=!1}get attached(){return this._attached}set attached(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.visible||this.updateVisibility(!1)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}}}]);
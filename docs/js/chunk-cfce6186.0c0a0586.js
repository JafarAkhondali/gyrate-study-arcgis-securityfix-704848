(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cfce6186"],{"057f":function(t,e,n){var r=n("fc6a"),i=n("241c").f,a={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(e){return o.slice()}};t.exports.f=function(t){return o&&"[object Window]"==a.call(t)?c(t):i(r(t))}},"06c5":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));n("fb6a"),n("d3b7"),n("b0c0"),n("a630"),n("3ca3");var r=n("6b75");function i(t,e){if(t){if("string"===typeof t)return Object(r["a"])(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r["a"])(t,e):void 0}}},3835:function(t,e,n){"use strict";function r(t){if(Array.isArray(t))return t}n.d(e,"a",(function(){return c}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");function i(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a=[],o=!0,c=!1;try{for(n=n.call(t);!(o=(r=n.next()).done);o=!0)if(a.push(r.value),e&&a.length===e)break}catch(u){c=!0,i=u}finally{try{o||null==n["return"]||n["return"]()}finally{if(c)throw i}}return a}}var a=n("06c5");function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t,e){return r(t)||i(t,e)||Object(a["a"])(t,e)||o()}},"3c7c":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrap"},[n("div",{staticClass:"container",attrs:{id:"viewDiv"}}),n("div",{staticClass:"filter-panel"},[n("ul",t._l(t.filterList,(function(e){return n("li",{key:e.id,class:{active:e.active},on:{click:function(n){return t.checkItem(e)}}},[n("span",[t._v(t._s(e.label))]),n("span",[t._v("("+t._s(e.count)+")")])])})),0)]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.currTip,expression:"currTip"}],staticClass:"map-point-tip",style:t.currTipStyle},[t._v(t._s(t.currTip))])])},i=[],a=n("3835"),o=n("1da1"),c=(n("96cf"),n("d81d"),n("caad"),n("99af"),n("4de4"),n("d3b7"),n("ddb0"),n("a15b"),n("159b"),n("b64b"),n("bc3a")),u=n.n(c),s=n("6d1b"),f=n("8d60"),l=n("4ae5"),d=n("f6ad"),v=n("a611"),p=n("5bd5"),b=n("ce0b"),h=n("955e"),y={name:"UseFeatureLayer",components:{},data:function(){return{totalNum:0,map:null,view:null,currTip:"",currTipStyle:{},filterList:[{id:0,count:0,label:"在线",value:"ONLINE",active:!0},{id:1,count:0,label:"离线",value:"OFFLINE",active:!0},{id:2,count:0,label:"未激活",value:"UNACTIVATED",active:!0}]}},mounted:function(){this.initMap(),this.initBind(),this.initDeviceLayer(),this.initFaces()},methods:{initMap:function(){var t=new s["a"]({basemap:"hybrid"}),e=new v["a"]({container:"viewDiv",map:t,zoom:11,center:[113.54735115356235,22.78385103258788]}),n=new d["a"]({view:e});e.ui.add(n,{position:"bottom-left"}),this.map=t,window._view=this.view=e},initBind:function(){var t=this;this.view.on("click",(function(e){var n=e.mapPoint,r=n.longitude,i=n.latitude;console.log("[".concat([r,i],"]")),t.view.goTo({center:new l["a"]({x:r,y:i}),scale:3e4}).then((function(){console.log("平移")}))})),this.view.on("pointer-move",(function(e){var n=e.x,r=e.y;t.view.hitTest(e).then((function(e){var i=e.results;if(i.length&&i[0].graphic){var a=i[0].graphic,o=a.sourceLayer,c=a.attributes;if(!o||!c)return;var u=c.deviceUid;o&&["deviceLayer"].includes(o.id)?(t.currTip="Uid: ".concat(u),t.currTipStyle={top:r+15+"px",left:n+15+"px"}):t.currTip=""}else t.currTip=""}))}))},getUniqueValueInfos:function(){var t=this.filterList.map((function(t,e){return{value:t.value,symbol:{type:"picture-marker",url:"".concat("/study-arcgis/","/static/images/svg/camera_m_").concat(e+1,".svg")}}}));return t},initDeviceLayer:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getDeviceData();case 2:n=e.sent,r=t.getUniqueValueInfos(),i=new p["default"]({id:"deviceLayer",title:"设备图层",fields:[{name:"ObjectID",type:"oid"},{name:"id",type:"string"},{name:"deviceUid",type:"string"},{name:"deviceStatus",type:"string"}],outFields:["*"],objectIdField:"ObjectID",geometryType:"point",source:[],renderer:{type:"unique-value",valueExpression:"return $feature.deviceStatus",uniqueValueInfos:r,visualVariables:[{type:"size",valueExpression:"$view.scale",stops:[{value:5e5,size:2},{value:25e4,size:10},{value:125e3,size:15},{value:32e3,size:30}]}]},popupTemplate:{title:"{deviceUid}",content:[{type:"fields",fieldInfos:[{label:"设备Uid",fieldName:"deviceUid"},{label:"设备id",fieldName:"id"},{label:"设备状态",fieldName:"deviceStatus"}]}]}}),t.map.add(i),i.applyEdits({addFeatures:n}).then((function(t){console.log("deleteFeatures:".concat(t.deleteFeatureResults.length)),console.log("addFeatures:".concat(t.addFeatureResults.length))}));case 7:case"end":return e.stop()}}),e)})))()},checkItem:function(t){t.active=!t.active;var e=this.filterList.filter((function(t){return 1==t.active})).map((function(t){return t.value}));this.filterDeviceLayer({mode:"deviceStatus",values:e})},initDraw:function(){var t=new b["a"]({id:"canvas",title:"绘图面板"});this.map.add(t);var e=new h["a"]({layer:t,view:this.view,creationMode:"update"});this.view.ui.add(e,"bottom-right"),e.on("update",(function(t){t.graphics[0].geometry&&console.log(JSON.stringify(t.graphics[0].geometry.rings))})),this.sketch=e},filterDeviceLayer:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.mode,n=t.values,r=void 0===n?[]:n,i=this.map.findLayerById("deviceLayer");this.view.whenLayerView(i).then((function(t){var n="";r.length>0&&(n+=r.map((function(t){return"".concat(e,"='").concat(t,"'")})).join(" OR ")),console.log("queryStr: ",n),t.filter={where:n},i.refresh()}))},countDeviceData:function(t){var e=this,n={ONLINE:{count:0,index:0},OFFLINE:{count:0,index:1},UNACTIVATED:{count:0,index:2}};t.forEach((function(t){var e=n[t.deviceStatus];e&&e.count++})),Object.keys(n).forEach((function(t){var r=n[t],i=r.index,a=r.count;e.filterList[i].count=a}))},getDeviceData:function(){var t=this;return new Promise((function(e){u.a.get("".concat("/study-arcgis/","/static/mockData.json")).then((function(n){var r=n.data.data,i=[];r.forEach((function(t){for(var e=0;e<100;e++){var n=Object(a["a"])(t.location,2),r=n[0],o=n[1],c=Math.random(),u=Math.random(),s=(new Date).getTime();r+=(c>.5?1:-1)*c*1,o+=(u>.5?1:-1)*u*1,i.push({id:s,deviceUid:s,location:[r,o],deviceStatus:"UNACTIVATED"})}})),r=r.concat(i),console.log("data count: ".concat(r.length)),t.countDeviceData(r);var o=[];r.forEach((function(t){var e=Object(a["a"])(t.location,2),n=e[0],r=e[1],i=new f["a"]({geometry:{type:"point",latitude:r,longitude:n},attributes:t});o.push(i)})),e(o)}))}))},initFaces:function(){var t=new b["a"]({id:"warning",title:"告警图层"});this.map.add(t);var e=[[113.51816871947844,22.739529066560554],[113.53705147094325,22.725913004720613],[113.5404846984823,22.699943735078694],[113.51336220092375,22.71482916304153],[113.54151466674402,22.74712813937304],[113.55593422240807,22.726863006513916],[113.55696419066979,22.704694579392765],[113.59232643432209,22.687274011342428],[113.60296943969317,22.70976196499587],[113.57790687865804,22.770872517966353],[113.55833748168541,22.78131873642898],[113.45843056029884,22.773088449309192],[113.46186378783788,22.791764155078475],[113.51851204223235,22.798727323029638],[113.57344368285726,22.783534498138383]],n=[];e.forEach((function(t){var e=Object(a["a"])(t,2),r=e[0],i=e[1],o=new f["a"]({geometry:{type:"point",x:r,y:i},attributes:{},symbol:{type:"picture-marker",url:"".concat("/study-arcgis/","/static/images/gif/oh.gif"),width:"30",height:"30"}});n.push(o)})),t.addMany(n)}}},g=y,m=(n("7123"),n("c5ab"),n("2877")),w=Object(m["a"])(g,r,i,!1,null,"9e9e09d8",null);e["default"]=w.exports},"4de4":function(t,e,n){"use strict";var r=n("23e7"),i=n("b727").filter,a=n("1dde"),o=a("filter");r({target:"Array",proto:!0,forced:!o},{filter:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(t,e,n){"use strict";var r=n("0366"),i=n("7b0b"),a=n("9bdd"),o=n("e95a"),c=n("50c4"),u=n("8418"),s=n("35a1");t.exports=function(t){var e,n,f,l,d,v,p=i(t),b="function"==typeof this?this:Array,h=arguments.length,y=h>1?arguments[1]:void 0,g=void 0!==y,m=s(p),w=0;if(g&&(y=r(y,h>2?arguments[2]:void 0,2)),void 0==m||b==Array&&o(m))for(e=c(p.length),n=new b(e);e>w;w++)v=g?y(p[w],w):p[w],u(n,w,v);else for(l=m.call(p),d=l.next,n=new b;!(f=d.call(l)).done;w++)v=g?a(l,y,[f.value,w],!0):f.value,u(n,w,v);return n.length=w,n}},"4f28":function(t,e,n){},"6b75":function(t,e,n){"use strict";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,"a",(function(){return r}))},7123:function(t,e,n){"use strict";n("758a")},"746f":function(t,e,n){var r=n("428f"),i=n("5135"),a=n("e538"),o=n("9bf2").f;t.exports=function(t){var e=r.Symbol||(r.Symbol={});i(e,t)||o(e,t,{value:a.f(t)})}},"758a":function(t,e,n){},"99af":function(t,e,n){"use strict";var r=n("23e7"),i=n("d039"),a=n("e8b5"),o=n("861d"),c=n("7b0b"),u=n("50c4"),s=n("8418"),f=n("65f0"),l=n("1dde"),d=n("b622"),v=n("2d00"),p=d("isConcatSpreadable"),b=9007199254740991,h="Maximum allowed index exceeded",y=v>=51||!i((function(){var t=[];return t[p]=!1,t.concat()[0]!==t})),g=l("concat"),m=function(t){if(!o(t))return!1;var e=t[p];return void 0!==e?!!e:a(t)},w=!y||!g;r({target:"Array",proto:!0,forced:w},{concat:function(t){var e,n,r,i,a,o=c(this),l=f(o,0),d=0;for(e=-1,r=arguments.length;e<r;e++)if(a=-1===e?o:arguments[e],m(a)){if(i=u(a.length),d+i>b)throw TypeError(h);for(n=0;n<i;n++,d++)n in a&&s(l,d,a[n])}else{if(d>=b)throw TypeError(h);s(l,d++,a)}return l.length=d,l}})},"9bdd":function(t,e,n){var r=n("825a"),i=n("2a62");t.exports=function(t,e,n,a){try{return a?e(r(n)[0],n[1]):e(n)}catch(o){throw i(t),o}}},a15b:function(t,e,n){"use strict";var r=n("23e7"),i=n("44ad"),a=n("fc6a"),o=n("a640"),c=[].join,u=i!=Object,s=o("join",",");r({target:"Array",proto:!0,forced:u||!s},{join:function(t){return c.call(a(this),void 0===t?",":t)}})},a4d3:function(t,e,n){"use strict";var r=n("23e7"),i=n("da84"),a=n("d066"),o=n("c430"),c=n("83ab"),u=n("4930"),s=n("fdbf"),f=n("d039"),l=n("5135"),d=n("e8b5"),v=n("861d"),p=n("825a"),b=n("7b0b"),h=n("fc6a"),y=n("c04e"),g=n("5c6c"),m=n("7c73"),w=n("df75"),S=n("241c"),O=n("057f"),j=n("7418"),T=n("06cf"),x=n("9bf2"),A=n("d1e7"),D=n("9112"),E=n("6eeb"),I=n("5692"),L=n("f772"),N=n("d012"),k=n("90e3"),F=n("b622"),U=n("e538"),_=n("746f"),P=n("d44e"),C=n("69f3"),M=n("b727").forEach,V=L("hidden"),z="Symbol",$="prototype",q=F("toPrimitive"),J=C.set,R=C.getterFor(z),B=Object[$],Q=i.Symbol,W=a("JSON","stringify"),G=T.f,H=x.f,K=O.f,X=A.f,Y=I("symbols"),Z=I("op-symbols"),tt=I("string-to-symbol-registry"),et=I("symbol-to-string-registry"),nt=I("wks"),rt=i.QObject,it=!rt||!rt[$]||!rt[$].findChild,at=c&&f((function(){return 7!=m(H({},"a",{get:function(){return H(this,"a",{value:7}).a}})).a}))?function(t,e,n){var r=G(B,e);r&&delete B[e],H(t,e,n),r&&t!==B&&H(B,e,r)}:H,ot=function(t,e){var n=Y[t]=m(Q[$]);return J(n,{type:z,tag:t,description:e}),c||(n.description=e),n},ct=s?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof Q},ut=function(t,e,n){t===B&&ut(Z,e,n),p(t);var r=y(e,!0);return p(n),l(Y,r)?(n.enumerable?(l(t,V)&&t[V][r]&&(t[V][r]=!1),n=m(n,{enumerable:g(0,!1)})):(l(t,V)||H(t,V,g(1,{})),t[V][r]=!0),at(t,r,n)):H(t,r,n)},st=function(t,e){p(t);var n=h(e),r=w(n).concat(pt(n));return M(r,(function(e){c&&!lt.call(n,e)||ut(t,e,n[e])})),t},ft=function(t,e){return void 0===e?m(t):st(m(t),e)},lt=function(t){var e=y(t,!0),n=X.call(this,e);return!(this===B&&l(Y,e)&&!l(Z,e))&&(!(n||!l(this,e)||!l(Y,e)||l(this,V)&&this[V][e])||n)},dt=function(t,e){var n=h(t),r=y(e,!0);if(n!==B||!l(Y,r)||l(Z,r)){var i=G(n,r);return!i||!l(Y,r)||l(n,V)&&n[V][r]||(i.enumerable=!0),i}},vt=function(t){var e=K(h(t)),n=[];return M(e,(function(t){l(Y,t)||l(N,t)||n.push(t)})),n},pt=function(t){var e=t===B,n=K(e?Z:h(t)),r=[];return M(n,(function(t){!l(Y,t)||e&&!l(B,t)||r.push(Y[t])})),r};if(u||(Q=function(){if(this instanceof Q)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=k(t),n=function(t){this===B&&n.call(Z,t),l(this,V)&&l(this[V],e)&&(this[V][e]=!1),at(this,e,g(1,t))};return c&&it&&at(B,e,{configurable:!0,set:n}),ot(e,t)},E(Q[$],"toString",(function(){return R(this).tag})),E(Q,"withoutSetter",(function(t){return ot(k(t),t)})),A.f=lt,x.f=ut,T.f=dt,S.f=O.f=vt,j.f=pt,U.f=function(t){return ot(F(t),t)},c&&(H(Q[$],"description",{configurable:!0,get:function(){return R(this).description}}),o||E(B,"propertyIsEnumerable",lt,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!u,sham:!u},{Symbol:Q}),M(w(nt),(function(t){_(t)})),r({target:z,stat:!0,forced:!u},{for:function(t){var e=String(t);if(l(tt,e))return tt[e];var n=Q(e);return tt[e]=n,et[n]=e,n},keyFor:function(t){if(!ct(t))throw TypeError(t+" is not a symbol");if(l(et,t))return et[t]},useSetter:function(){it=!0},useSimple:function(){it=!1}}),r({target:"Object",stat:!0,forced:!u,sham:!c},{create:ft,defineProperty:ut,defineProperties:st,getOwnPropertyDescriptor:dt}),r({target:"Object",stat:!0,forced:!u},{getOwnPropertyNames:vt,getOwnPropertySymbols:pt}),r({target:"Object",stat:!0,forced:f((function(){j.f(1)}))},{getOwnPropertySymbols:function(t){return j.f(b(t))}}),W){var bt=!u||f((function(){var t=Q();return"[null]"!=W([t])||"{}"!=W({a:t})||"{}"!=W(Object(t))}));r({target:"JSON",stat:!0,forced:bt},{stringify:function(t,e,n){var r,i=[t],a=1;while(arguments.length>a)i.push(arguments[a++]);if(r=e,(v(e)||void 0!==t)&&!ct(t))return d(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!ct(e))return e}),i[1]=e,W.apply(null,i)}})}Q[$][q]||D(Q[$],q,Q[$].valueOf),P(Q,z),N[V]=!0},a630:function(t,e,n){var r=n("23e7"),i=n("4df4"),a=n("1c7e"),o=!a((function(t){Array.from(t)}));r({target:"Array",stat:!0,forced:o},{from:i})},b64b:function(t,e,n){var r=n("23e7"),i=n("7b0b"),a=n("df75"),o=n("d039"),c=o((function(){a(1)}));r({target:"Object",stat:!0,forced:c},{keys:function(t){return a(i(t))}})},c5ab:function(t,e,n){"use strict";n("4f28")},caad:function(t,e,n){"use strict";var r=n("23e7"),i=n("4d64").includes,a=n("44d2");r({target:"Array",proto:!0},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),a("includes")},d28b:function(t,e,n){var r=n("746f");r("iterator")},e01a:function(t,e,n){"use strict";var r=n("23e7"),i=n("83ab"),a=n("da84"),o=n("5135"),c=n("861d"),u=n("9bf2").f,s=n("e893"),f=a.Symbol;if(i&&"function"==typeof f&&(!("description"in f.prototype)||void 0!==f().description)){var l={},d=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof d?new f(t):void 0===t?f():f(t);return""===t&&(l[e]=!0),e};s(d,f);var v=d.prototype=f.prototype;v.constructor=d;var p=v.toString,b="Symbol(test)"==String(f("test")),h=/^Symbol\((.*)\)[^)]+$/;u(v,"description",{configurable:!0,get:function(){var t=c(this)?this.valueOf():this,e=p.call(t);if(o(l,t))return"";var n=b?e.slice(7,-1):e.replace(h,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:d})}},e538:function(t,e,n){var r=n("b622");e.f=r},fb6a:function(t,e,n){"use strict";var r=n("23e7"),i=n("861d"),a=n("e8b5"),o=n("23cb"),c=n("50c4"),u=n("fc6a"),s=n("8418"),f=n("b622"),l=n("1dde"),d=l("slice"),v=f("species"),p=[].slice,b=Math.max;r({target:"Array",proto:!0,forced:!d},{slice:function(t,e){var n,r,f,l=u(this),d=c(l.length),h=o(t,d),y=o(void 0===e?d:e,d);if(a(l)&&(n=l.constructor,"function"!=typeof n||n!==Array&&!a(n.prototype)?i(n)&&(n=n[v],null===n&&(n=void 0)):n=void 0,n===Array||void 0===n))return p.call(l,h,y);for(r=new(void 0===n?Array:n)(b(y-h,0)),f=0;h<y;h++,f++)h in l&&s(r,f,l[h]);return r.length=f,r}})}}]);
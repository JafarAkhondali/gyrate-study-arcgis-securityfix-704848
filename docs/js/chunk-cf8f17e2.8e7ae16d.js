(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cf8f17e2"],{"2d39":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var i=r("3b1a"),n=r("c84e"),s=r("9a02");class a extends s["a"]{get requiresDedicatedFBO(){return this.children.some(e=>"additive"===e.blendFunction)}prepareRenderPasses(e){const t=e.registerRenderPass({name:"bitmap",brushes:[i["a"].bitmap],target:()=>this.children,drawPhase:n["c"].MAP});return[...super.prepareRenderPasses(e),t]}}},"365a":function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var i=r("a4ee"),n=r("fc29"),s=r("ce6d"),a=r("9096"),o=r("a5d8"),c=r("e92d"),h=r("b2b2"),u=r("fab3"),l=r("59b2"),d=(r("b50f"),r("c120"),r("cea0"),r("d386"));let p=class extends(Object(a["b"])(Object(o["a"])(Object(u["b"])(s["a"].EventedMixin(n["a"]))))){constructor(e){super(e),this.layer=null,this.parent=null}initialize(){this.when().catch(e=>{if("layerview:create-error"!==e.name){const t=this.layer&&this.layer.id||"no id",r=this.layer&&this.layer.title||"no title";throw c["a"].getLogger(this.declaredClass).error("#resolve()",`Failed to resolve layer view (layer title: '${r}', id: '${t}')`,e),e}})}get fullOpacity(){return Object(h["v"])(this.get("layer.opacity"),1)*Object(h["v"])(this.get("parent.fullOpacity"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer.legendEnabled}get updating(){return!!(this.updatingHandles&&this.updatingHandles.updating||this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){var e;return!0===(null==(e=this.layer)?void 0:e.visible)}set visible(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")}canResume(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1}getSuspendInfo(){const e=this.parent&&this.parent.suspended?this.parent.suspendInfo:{},t=this;return t.view&&t.view.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0),this.visible||(e.layerInvisible=!0),e}isUpdating(){return!1}};Object(i["a"])([Object(l["b"])()],p.prototype,"fullOpacity",null),Object(i["a"])([Object(l["b"])()],p.prototype,"layer",void 0),Object(i["a"])([Object(l["b"])()],p.prototype,"parent",void 0),Object(i["a"])([Object(l["b"])({readOnly:!0})],p.prototype,"suspended",null),Object(i["a"])([Object(l["b"])({readOnly:!0})],p.prototype,"suspendInfo",null),Object(i["a"])([Object(l["b"])({readOnly:!0})],p.prototype,"legendEnabled",null),Object(i["a"])([Object(l["b"])({type:Boolean,readOnly:!0})],p.prototype,"updating",null),Object(i["a"])([Object(l["b"])({readOnly:!0})],p.prototype,"updatingProgress",null),Object(i["a"])([Object(l["b"])()],p.prototype,"visible",null),p=Object(i["a"])([Object(d["a"])("esri.views.layers.LayerView")],p);const f=p},"566d":function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var i=r("a4ee"),n=r("2c4f"),s=r("7d7d"),a=r("3795"),o=r("59b2"),c=(r("b50f"),r("c120"),r("cea0"),r("d386")),h=r("00c0"),u=r("6a0e");r("e92d"),r("2dd4");let l=class extends u["a"]{};l=Object(i["a"])([Object(c["a"])("esri.views.layers.support.ClipArea")],l);const d=l;var p;let f=p=class extends d{constructor(){super(...arguments),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new p({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}get version(){return(this._get("version")||0)+1}};Object(i["a"])([Object(o["b"])({type:[Number,String],json:{write:!0}})],f.prototype,"left",void 0),Object(i["a"])([Object(o["b"])({type:[Number,String],json:{write:!0}})],f.prototype,"right",void 0),Object(i["a"])([Object(o["b"])({type:[Number,String],json:{write:!0}})],f.prototype,"top",void 0),Object(i["a"])([Object(o["b"])({type:[Number,String],json:{write:!0}})],f.prototype,"bottom",void 0),Object(i["a"])([Object(o["b"])({readOnly:!0})],f.prototype,"version",null),f=p=Object(i["a"])([Object(c["a"])("esri.views.layers.support.ClipRect")],f);const x=f;r("e06a");var b,y=r("3760"),g=r("a9ab"),v=r("3af1"),m=r("1219");const O={base:y["a"],key:"type",typeMap:{extent:v["a"],polygon:m["a"]}};let j=b=class extends d{constructor(){super(...arguments),this.type="geometry",this.geometry=null}get version(){return(this._get("version")||0)+1}clone(){return new b({geometry:this.geometry.clone()})}};Object(i["a"])([Object(o["b"])({types:O,json:{read:g["a"],write:!0}})],j.prototype,"geometry",void 0),Object(i["a"])([Object(o["b"])({readOnly:!0})],j.prototype,"version",null),j=b=Object(i["a"])([Object(c["a"])("esri.views.layers.support.Geometry")],j);const _=j;let w=class extends d{constructor(){super(...arguments),this.type="path",this.path=[]}get version(){return(this._get("version")||0)+1}};Object(i["a"])([Object(o["b"])({type:[[[Number]]],json:{write:!0}})],w.prototype,"path",void 0),Object(i["a"])([Object(o["b"])({readOnly:!0})],w.prototype,"version",null),w=Object(i["a"])([Object(c["a"])("esri.views.layers.support.Path")],w);const R=w,M=n["a"].ofType({key:"type",base:d,typeMap:{rect:x,path:R,geometry:_}}),S=e=>{let t=class extends e{constructor(){super(...arguments),this.clips=new M,this.moving=!1,this.attached=!1,this.lastUpdateId=-1,this.updateRequested=!1}initialize(){var e;this.container||(this.container=new h["a"]),this.container.fadeTransitionEnabled=!0,this.container.opacity=0,this.container.clips=this.clips,this.handles.add([Object(a["a"])(this,"suspended",e=>{this.container&&(this.container.visible=!e),this.view&&!e&&this.updateRequested&&this.view.requestUpdate()},!0),Object(a["a"])(this,["layer.opacity","container"],()=>{var e,t;this.container&&(this.container.opacity=null!=(e=null==(t=this.layer)?void 0:t.opacity)?e:1)},!0),Object(a["a"])(this,["layer.blendMode"],e=>{this.container&&(this.container.blendMode=e)},!0),Object(a["a"])(this,["layer.effect"],e=>{this.container&&(this.container.effect=e)},!0),this.clips.on("change",()=>{this.container.clips=this.clips,this.notifyChange("clips")})]),null!=(e=this.view)&&e.whenLayerView?this.view.whenLayerView(this.layer).then(e=>{e!==this||this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)},()=>{}):this.when().then(()=>{this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)},()=>{})}destroy(){this.attached&&(this.detach(),this.attached=!1),this.handles.remove("initialize"),this.updateRequested=!1}get updating(){return!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!(!this.updatingHandles||!this.updatingHandles.updating)}isVisibleAtScale(e){let t=!0;const r=this.layer,i=r.minScale,n=r.maxScale;if(null!=i&&null!=n){let r=!i,s=!n;!r&&e<=i&&(r=!0),!s&&e>=n&&(s=!0),t=r&&s}return t}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())}processUpdate(e){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",e),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(e))):this.updateRequested=!1}hitTest(e,t){return Promise.resolve(null)}isUpdating(){return!1}isRendering(){return!1}canResume(){return!!super.canResume()&&this.isVisibleAtScale(this.view.scale)}};return Object(i["a"])([Object(o["b"])({type:M,set(e){const t=Object(s["b"])(e,this._get("clips"),M);this._set("clips",t)}})],t.prototype,"clips",void 0),Object(i["a"])([Object(o["b"])()],t.prototype,"moving",void 0),Object(i["a"])([Object(o["b"])()],t.prototype,"attached",void 0),Object(i["a"])([Object(o["b"])()],t.prototype,"container",void 0),Object(i["a"])([Object(o["b"])()],t.prototype,"suspended",void 0),Object(i["a"])([Object(o["b"])({readOnly:!0})],t.prototype,"updateParameters",void 0),Object(i["a"])([Object(o["b"])()],t.prototype,"updateRequested",void 0),Object(i["a"])([Object(o["b"])()],t.prototype,"updating",null),Object(i["a"])([Object(o["b"])()],t.prototype,"view",void 0),t=Object(i["a"])([Object(c["a"])("esri.views.2d.layers.LayerView2D")],t),t}},"5ef2":function(e,t,r){"use strict";function i(){return new Float32Array(4)}function n(e){const t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function s(e,t,r,i){const n=new Float32Array(4);return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}function a(e,t){return new Float32Array(e,t,4)}function o(){return i()}function c(){return s(1,1,1,1)}function h(){return s(1,0,0,0)}function u(){return s(0,1,0,0)}function l(){return s(0,0,1,0)}function d(){return s(0,0,0,1)}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return s}));const p=o(),f=c(),x=h(),b=u(),y=l(),g=d();Object.freeze({__proto__:null,create:i,clone:n,fromValues:s,createView:a,zeros:o,ones:c,unitX:h,unitY:u,unitZ:l,unitW:d,ZEROS:p,ONES:f,UNIT_X:x,UNIT_Y:b,UNIT_Z:y,UNIT_W:g})},"6c7a":function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var i=r("a4ee"),n=r("e92d"),s=r("f4cc"),a=r("3795"),o=r("59b2"),c=(r("b50f"),r("c120"),r("cea0"),r("d386"));const h=e=>{let t=class extends e{initialize(){this.handles.add(Object(a["b"])(this,"layer","refresh",e=>{this.doRefresh(e.dataChanged).catch(e=>{Object(s["m"])(e)||n["a"].getLogger(this.declaredClass).error(e)})}),"RefreshableLayerView")}};return Object(i["a"])([Object(o["b"])()],t.prototype,"layer",void 0),t=Object(i["a"])([Object(c["a"])("esri.layers.mixins.RefreshableLayerView")],t),t}},"894c":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var i=r("b2b2");class n{constructor(e,t,r){this.pixelBlock=e,this.extent=t,this.originalPixelBlock=r}get width(){return Object(i["l"])(this.pixelBlock)?this.pixelBlock.width:0}get height(){return Object(i["l"])(this.pixelBlock)?this.pixelBlock.height:0}render(e){const t=this.pixelBlock;if(Object(i["k"])(t))return;const r=this.filter({pixelBlock:t});if(Object(i["k"])(r.pixelBlock))return;const n=r.pixelBlock.getAsRGBA(),s=e.createImageData(r.pixelBlock.width,r.pixelBlock.height);s.data.set(n),e.putImageData(s,0,0)}getRenderedRasterPixels(){const e=this.filter({pixelBlock:this.pixelBlock});return Object(i["k"])(e.pixelBlock)?null:{width:e.pixelBlock.width,height:e.pixelBlock.height,renderedRasterPixels:new Uint8Array(e.pixelBlock.getAsRGBA().buffer)}}}},9812:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i,n,s,a={exports:{}};i=a,n=function(){function e(e,r,n){n=n||2;var s,a,o,h,u,l,d,p=r&&r.length,f=p?r[0]*n:e.length,x=t(e,0,f,n,!0),b=[];if(!x||x.next===x.prev)return b;if(p&&(x=c(e,r,x,n)),e.length>80*n){s=o=e[0],a=h=e[1];for(var y=n;y<f;y+=n)(u=e[y])<s&&(s=u),(l=e[y+1])<a&&(a=l),u>o&&(o=u),l>h&&(h=l);d=0!==(d=Math.max(o-s,h-a))?1/d:0}return i(x,b,n,s,a,d),b}function t(e,t,r,i,n){var s,a;if(n===U(e,t,r,i)>0)for(s=t;s<r;s+=i)a=I(s,e[s],e[s+1],a);else for(s=r-i;s>=t;s-=i)a=I(s,e[s],e[s+1],a);if(a&&O(a,a.next)){var o=a.next;P(a),a=o}return a}function r(e,t){if(!e)return e;t||(t=e);var r,i=e;do{if(r=!1,i.steiner||!O(i,i.next)&&0!==m(i.prev,i,i.next))i=i.next;else{var n=i.prev;if(P(i),(i=t=n)===i.next)break;r=!0}}while(r||i!==t);return t}function i(e,t,c,h,u,l,d){if(e){!d&&l&&f(e,h,u,l);for(var p,x,b=e;e.prev!==e.next;)if(p=e.prev,x=e.next,l?s(e,h,u,l):n(e))t.push(p.i/c),t.push(e.i/c),t.push(x.i/c),P(e),e=x.next,b=x.next;else if((e=x)===b){d?1===d?i(e=a(r(e),t,c),t,c,h,u,l,2):2===d&&o(e,t,c,h,u,l):i(r(e),t,c,h,u,l,1);break}}}function n(e){var t=e.prev,r=e,i=e.next;if(m(t,r,i)>=0)return!1;for(var n=e.next.next;n!==e.prev;){if(g(t.x,t.y,r.x,r.y,i.x,i.y,n.x,n.y)&&m(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function s(e,t,r,i){var n=e.prev,s=e,a=e.next;if(m(n,s,a)>=0)return!1;for(var o=n.x<s.x?n.x<a.x?n.x:a.x:s.x<a.x?s.x:a.x,c=n.y<s.y?n.y<a.y?n.y:a.y:s.y<a.y?s.y:a.y,h=n.x>s.x?n.x>a.x?n.x:a.x:s.x>a.x?s.x:a.x,u=n.y>s.y?n.y>a.y?n.y:a.y:s.y>a.y?s.y:a.y,l=b(o,c,t,r,i),d=b(h,u,t,r,i),p=e.prevZ,f=e.nextZ;p&&p.z>=l&&f&&f.z<=d;){if(p!==e.prev&&p!==e.next&&g(n.x,n.y,s.x,s.y,a.x,a.y,p.x,p.y)&&m(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==e.prev&&f!==e.next&&g(n.x,n.y,s.x,s.y,a.x,a.y,f.x,f.y)&&m(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;p&&p.z>=l;){if(p!==e.prev&&p!==e.next&&g(n.x,n.y,s.x,s.y,a.x,a.y,p.x,p.y)&&m(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=d;){if(f!==e.prev&&f!==e.next&&g(n.x,n.y,s.x,s.y,a.x,a.y,f.x,f.y)&&m(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function a(e,t,i){var n=e;do{var s=n.prev,a=n.next.next;!O(s,a)&&j(s,n,n.next,a)&&M(s,a)&&M(a,s)&&(t.push(s.i/i),t.push(n.i/i),t.push(a.i/i),P(n),P(n.next),n=e=a),n=n.next}while(n!==e);return r(n)}function o(e,t,n,s,a,o){var c=e;do{for(var h=c.next.next;h!==c.prev;){if(c.i!==h.i&&v(c,h)){var u=B(c,h);return c=r(c,c.next),u=r(u,u.next),i(c,t,n,s,a,o),void i(u,t,n,s,a,o)}h=h.next}c=c.next}while(c!==e)}function c(e,i,n,s){var a,o,c,u=[];for(a=0,o=i.length;a<o;a++)(c=t(e,i[a]*s,a<o-1?i[a+1]*s:e.length,s,!1))===c.next&&(c.steiner=!0),u.push(y(c));for(u.sort(h),a=0;a<u.length;a++)n=r(n=l(u[a],n),n.next);return n}function h(e,t){return e.x-t.x}function u(e){if(e.next.prev===e)return e;let t=e;for(;;){const r=t.next;if(r.prev===t||r===t||r===e)break;t=r}return t}function l(e,t){var i=d(e,t);if(!i)return t;var n=B(i,e),s=r(i,i.next);let a=u(n);return r(a,a.next),s=u(s),u(t===i?s:t)}function d(e,t){var r,i=t,n=e.x,s=e.y,a=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){var o=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(o<=n&&o>a){if(a=o,o===n){if(s===i.y)return i;if(s===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!r)return null;if(n===a)return r;var c,h=r,u=r.x,l=r.y,d=1/0;i=r;do{n>=i.x&&i.x>=u&&n!==i.x&&g(s<l?n:a,s,u,l,s<l?a:n,s,i.x,i.y)&&(c=Math.abs(s-i.y)/(n-i.x),M(i,e)&&(c<d||c===d&&(i.x>r.x||i.x===r.x&&p(r,i)))&&(r=i,d=c)),i=i.next}while(i!==h);return r}function p(e,t){return m(e.prev,e,t.prev)<0&&m(t.next,e,e.next)<0}function f(e,t,r,i){var n=e;do{if(null===n.z&&(n.z=b(n.x,n.y,t,r,i)),n.prev.next!==n||n.next.prev!==n)return n.prev.next=n,n.next.prev=n,f(e,t,r,i);n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,x(n)}function x(e){var t,r,i,n,s,a,o,c,h=1;do{for(r=e,e=null,s=null,a=0;r;){for(a++,i=r,o=0,t=0;t<h&&(o++,i=i.nextZ);t++);for(c=h;o>0||c>0&&i;)0!==o&&(0===c||!i||r.z<=i.z)?(n=r,r=r.nextZ,o--):(n=i,i=i.nextZ,c--),s?s.nextZ=n:e=n,n.prevZ=s,s=n;r=i}s.nextZ=null,h*=2}while(a>1);return e}function b(e,t,r,i,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function y(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function g(e,t,r,i,n,s,a,o){return(n-a)*(t-o)-(e-a)*(s-o)>=0&&(e-a)*(i-o)-(r-a)*(t-o)>=0&&(r-a)*(s-o)-(n-a)*(i-o)>=0}function v(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!R(e,t)&&(M(e,t)&&M(t,e)&&S(e,t)&&(m(e.prev,e,t.prev)||m(e,t.prev,t))||O(e,t)&&m(e.prev,e,e.next)>0&&m(t.prev,t,t.next)>0)}function m(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function O(e,t){return e.x===t.x&&e.y===t.y}function j(e,t,r,i){var n=w(m(e,t,r)),s=w(m(e,t,i)),a=w(m(r,i,e)),o=w(m(r,i,t));return n!==s&&a!==o||!(0!==n||!_(e,r,t))||!(0!==s||!_(e,i,t))||!(0!==a||!_(r,e,i))||!(0!==o||!_(r,t,i))}function _(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function w(e){return e>0?1:e<0?-1:0}function R(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&j(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function M(e,t){return m(e.prev,e,e.next)<0?m(e,t,e.next)>=0&&m(e,e.prev,t)>=0:m(e,t,e.prev)<0||m(e,e.next,t)<0}function S(e,t){var r=e,i=!1,n=(e.x+t.x)/2,s=(e.y+t.y)/2;do{r.y>s!=r.next.y>s&&r.next.y!==r.y&&n<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==e);return i}function B(e,t){var r=new k(e.i,e.x,e.y),i=new k(t.i,t.x,t.y),n=e.next,s=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function I(e,t,r,i){var n=new k(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function P(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function k(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function U(e,t,r,i){for(var n=0,s=t,a=r-i;s<r;s+=i)n+=(e[a]-e[s])*(e[s+1]+e[a+1]),a=s;return n}return e.deviation=function(e,t,r,i){var n=t&&t.length,s=n?t[0]*r:e.length,a=Math.abs(U(e,0,s,r));if(n)for(var o=0,c=t.length;o<c;o++){var h=t[o]*r,u=o<c-1?t[o+1]*r:e.length;a-=Math.abs(U(e,h,u,r))}var l=0;for(o=0;o<i.length;o+=3){var d=i[o]*r,p=i[o+1]*r,f=i[o+2]*r;l+=Math.abs((e[d]-e[f])*(e[p+1]-e[d+1])-(e[d]-e[p])*(e[f+1]-e[d+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},e.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0,n=0;n<e.length;n++){for(var s=0;s<e[n].length;s++)for(var a=0;a<t;a++)r.vertices.push(e[n][s][a]);n>0&&(i+=e[n-1].length,r.holes.push(i))}return r},e},void 0!==(s=n())&&(i.exports=s);const o=a.exports},"9a02":function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));r("c120");var i=r("b2b2"),n=r("8c71"),s=r("3b1a"),a=r("00c0"),o=r("ce50"),c=r("e92d"),h=r("7c4b"),u=r("9812"),l=r("3349"),d=r("02f1"),p=r("6655"),f=r("8152"),x=r("d114"),b=r("7ce4");const y=c["a"].getLogger("esri.views.2d.engine.webgl.Mesh2D"),g=e=>{switch(e.BYTES_PER_ELEMENT){case 1:return 5121;case 2:return 5123;case 4:return 5125;default:throw new o["a"]("Cannot get DataType of array")}},v=(e,t,r,i)=>{let n=0;for(let s=1;s<r;s++){const r=e[2*(t+s-1)],i=e[2*(t+s-1)+1];n+=(e[2*(t+s)]-r)*(e[2*(t+s)+1]+i)}return i?n>0:n<0},m=({coords:e,lengths:t},r)=>{const i=[];for(let n=0,s=0;n<t.length;s+=t[n],n+=1){const a=s,o=[];for(;n<t.length-1&&v(e,s+t[n],t[n+1],r);n+=1,s+=t[n])o.push(s+t[n]-a);const c=e.slice(2*a,2*(s+t[n])),h=Object(u["a"])(c,o,2);for(const e of h)i.push(e+a)}return i};class O{constructor(e,t,r,i=!1){this._cache={},this.vertices=e,this.indices=t,this.primitiveType=r,this.isMapSpace=i}static fromRect({x:e,y:t,width:r,height:i}){const n=e,s=t,a=n+r,o=s+i;return O.fromScreenExtent({xmin:n,ymin:s,xmax:a,ymax:o})}static fromPath(e){const t=Object(p["f"])(new f["a"],e.path,!1,!1),r=t.coords,i=new Uint32Array(m(t,!0)),n=new Uint32Array(r.length/2);for(let s=0;s<n.length;s++)n[s]=Object(x["a"])(Math.floor(r[2*s]),Math.floor(r[2*s+1]));return new O({geometry:n},i,4)}static fromGeometry(e,t){const r=t.geometry.type;switch(r){case"polygon":return O.fromPolygon(e,t.geometry);case"extent":return O.fromMapExtent(e,t.geometry);default:return y.error(new o["a"]("mapview-bad-type","Unable to create a mesh from type "+r,t)),O.fromRect({x:0,y:0,width:1,height:1})}}static fromPolygon(e,t){const r=Object(p["g"])(new f["a"],t,!1,!1),i=r.coords,n=new Uint32Array(m(r,!1)),s=new Uint32Array(i.length/2),a=Object(d["b"])(),o=Object(d["b"])();for(let c=0;c<s.length;c++)Object(l["s"])(a,i[2*c],i[2*c+1]),e.toScreen(o,a),s[c]=Object(x["a"])(Math.floor(o[0]),Math.floor(o[1]));return new O({geometry:s},n,4,!0)}static fromScreenExtent({xmin:e,xmax:t,ymin:r,ymax:i}){const n={geometry:new Uint32Array([Object(x["a"])(e,r),Object(x["a"])(t,r),Object(x["a"])(e,i),Object(x["a"])(e,i),Object(x["a"])(t,r),Object(x["a"])(t,i)])},s=new Uint32Array([0,1,2,3,4,5]);return new O(n,s,4)}static fromMapExtent(e,t){const[r,i]=e.toScreen([0,0],[t.xmin,t.ymin]),[n,s]=e.toScreen([0,0],[t.xmax,t.ymax]),a={geometry:new Uint32Array([Object(x["a"])(r,i),Object(x["a"])(n,i),Object(x["a"])(r,s),Object(x["a"])(r,s),Object(x["a"])(n,i),Object(x["a"])(n,s)])},o=new Uint32Array([0,1,2,3,4,5]);return new O(a,o,4)}destroy(){Object(i["l"])(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(const e in this._cache.vertexBuffers)Object(i["l"])(this._cache.vertexBuffers[e])&&this._cache.vertexBuffers[e].dispose()}get elementType(){return g(this.indices)}getIndexBuffer(e,t=35044){return this._cache.indexBuffer||(this._cache.indexBuffer=b["a"].createIndex(e,t,this.indices)),this._cache.indexBuffer}getVertexBuffers(e,t=35044){return this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce((r,i)=>({...r,[i]:b["a"].createVertex(e,t,this.vertices[i])}),{})),this._cache.vertexBuffers}}var j=r("0fa6");const _=c["a"].getLogger("esri.views.2d.engine.webgl.ClippingInfo"),w=e=>parseFloat(e)/100;class R extends h["a"]{constructor(e,t){super(),this._clip=t,this._cache={},this.stage=e,this._handle=t.watch("version",()=>this._invalidate()),this.ready()}static fromClipArea(e,t){return new R(e,t)}_destroyGL(){Object(i["l"])(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null),Object(i["l"])(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)}destroy(){this._destroyGL(),this._handle.remove()}getVAO(e,t,r,n){const[s,a]=t.size;if("geometry"!==this._clip.type&&this._lastWidth===s&&this._lastHeight===a||(this._lastWidth=s,this._lastHeight=a,this._destroyGL()),Object(i["k"])(this._cache.vao)){const i=this._createMesh(t,this._clip),s=i.getIndexBuffer(e),a=i.getVertexBuffers(e);this._cache.mesh=i,this._cache.vao=new j["a"](e,r,n,a,s)}return this._cache.vao}_createTransforms(){return{dvs:Object(n["b"])()}}_invalidate(){this._destroyGL(),this.requestRender()}_createScreenRect(e,t){const[r,i]=e.size,n="string"==typeof t.left?w(t.left)*r:t.left,s="string"==typeof t.right?w(t.right)*r:t.right,a="string"==typeof t.top?w(t.top)*i:t.top,o="string"==typeof t.bottom?w(t.bottom)*i:t.bottom,c=n,h=a;return{x:c,y:h,width:Math.max(r-s-c,0),height:Math.max(i-o-h,0)}}_createMesh(e,t){switch(t.type){case"rect":return O.fromRect(this._createScreenRect(e,t));case"path":return O.fromPath(t);case"geometry":return O.fromGeometry(e,t);default:return _.error(new o["a"]("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),O.fromRect({x:0,y:0,width:1,height:1})}}}var M=r("c84e");class S extends a["a"]{constructor(){super(...arguments),this.name=this.constructor.name}set clips(e){this._clips=e,this.children.forEach(t=>t.clips=e),this._updateClippingInfo()}_createTransforms(){return{dvs:Object(n["b"])()}}doRender(e){const t=this.createRenderParams(e),{painter:r,globalOpacity:i,profiler:n,drawPhase:s}=t,a=s===M["c"].LABEL||s===M["c"].HIGHLIGHT?1:i*this.computedOpacity;n.recordContainerStart(this.name),r.beforeRenderLayer(t,this._clippingInfos?255:0,a),this.updateTransforms(e.state),this.renderChildren(t),r.compositeLayer(t,a),n.recordContainerEnd()}renderChildren(e){Object(i["k"])(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(e.painter));for(const r of this.children)r.beforeRender(e);for(const r of this._renderPasses)try{r.render(e)}catch(t){}for(const r of this.children)r.afterRender(e)}createRenderParams(e){return e.requireFBO=this.requiresDedicatedFBO,e}prepareRenderPasses(e){return[e.registerRenderPass({name:"clip",brushes:[s["a"].clip],target:()=>this._clippingInfos,drawPhase:M["c"].MAP|M["c"].LABEL|M["c"].LABEL_ALPHA|M["c"].DEBUG|M["c"].HIGHLIGHT})]}updateTransforms(e){for(const t of this.children)t.setTransform(e)}onAttach(){super.onAttach(),this._updateClippingInfo()}onDetach(){super.onDetach(),this._updateClippingInfo()}_updateClippingInfo(){if(Object(i["l"])(this._clippingInfos)&&(this._clippingInfos.forEach(e=>e.destroy()),this._clippingInfos=null),!this.stage)return;const e=this._clips;Object(i["l"])(e)&&e.length&&(this._clippingInfos=e.items.map(e=>R.fromClipArea(this.stage,e))),this.requestRender()}}},bdb8:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var i=r("a4ee"),n=r("fc29"),s=r("f4cc"),a=r("59b2"),o=(r("b50f"),r("c120"),r("cea0"),r("d386")),c=r("3af1"),h=r("9180"),u=r("7f83"),l=r("dff3");const d=Math.PI/180;function p(e){return e*d}function f(e,t){const r=p(t.rotation),i=Math.abs(Math.cos(r)),n=Math.abs(Math.sin(r)),[s,a]=t.size;return e[0]=Math.round(a*n+s*i),e[1]=Math.round(a*i+s*n),e}function x(e,t,r,i){const[n,s]=t,[a,o]=i,c=.5*r;return e[0]=n-c*a,e[1]=s-c*o,e[2]=n+c*a,e[3]=s+c*o,e}var b=r("c73a"),y=r("018d"),g=r("ae54");const v=Object(h["m"])(),m=[0,0],O=new g["a"](0,0,0,0),j={container:null,fetchSource:null,requestUpdate:null,imageMaxWidth:2048,imageMaxHeight:2048,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1};let _=class extends n["a"]{constructor(e){super(e),this._imagePromise=null,this.bitmaps=[],this.hidpi=j.hidpi,this.imageMaxWidth=j.imageMaxWidth,this.imageMaxHeight=j.imageMaxHeight,this.imageRotationSupported=j.imageRotationSupported,this.imageNormalizationSupported=j.imageNormalizationSupported,this.update=Object(s["i"])(async(e,t)=>{if(!e.stationary||this.destroyed)return null;const r=e.state,i=Object(u["e"])(r.spatialReference),n=this.hidpi?e.pixelRatio:1,s=this.imageNormalizationSupported&&r.worldScreenWidth&&r.worldScreenWidth<r.size[0];s?(m[0]=r.worldScreenWidth,m[1]=r.size[1]):this.imageRotationSupported?(m[0]=r.size[0],m[1]=r.size[1]):f(m,r);const a=Math.floor(m[0]*n)>this.imageMaxWidth||Math.floor(m[1]*n)>this.imageMaxHeight,o=i&&(r.extent.xmin<i.valid[0]||r.extent.xmax>i.valid[1]),c=!this.imageNormalizationSupported&&o,h=!a&&!c,l=this.imageRotationSupported?r.rotation:0;if(h){const e=s?r.paddedViewState.center:r.center;this._imagePromise=this._singleExport(r,m,e,r.resolution,l,n,t)}else{let e=Math.min(this.imageMaxWidth,this.imageMaxHeight);c&&(e=Math.min(r.worldScreenWidth,e)),this._imagePromise=this._tiledExport(r,e,l,n,t)}return this._imagePromise.then(async e=>{if(this._imagePromise=null,!this.destroyed){this.bitmaps=null!=e?e:[];for(const t of this.container.children)e.includes(t)||t.fadeOut().then(()=>{t.remove()});for(const t of e)this.container.addChild(t),t.fadeIn()}}).catch(e=>{throw this._imagePromise=null,e})},5e3)}destroy(){this.bitmaps=[]}get updating(){return!this.destroyed&&null!==this._imagePromise}updateExports(e){for(const t of this.container.children){if(!t.visible||!t.stage)return;e(t),t.invalidateTexture(),t.requestRender()}}async _export(e,t,r,i,n,s){const a=await this.fetchSource(e,Math.floor(t*n),Math.floor(r*n),{rotation:i,pixelRatio:n,signal:s}),o=new b["a"](a,"additive");return o.x=e.xmin,o.y=e.ymax,o.resolution=e.width/t,o.rotation=i,o.pixelRatio=n,o}async _singleExport(e,t,r,i,n,s,a){x(v,r,i,t);const o=new c["a"](v[0],v[1],v[2],v[3],e.spatialReference);return[await this._export(o,t[0],t[1],n,s,a)]}_tiledExport(e,t,r,i,n){const s=l["a"].create({size:t,spatialReference:e.spatialReference,scales:[e.scale]}),a=new y["a"](s),o=a.getTileCoverage(e);if(!o)return null;const h=[];return o.forEach((s,o,u,l)=>{O.set(s,o,u,l),a.getTileBounds(v,O);const d=new c["a"](v[0],v[1],v[2],v[3],e.spatialReference);h.push(this._export(d,t,t,r,i,n))}),Promise.all(h)}};Object(i["a"])([Object(a["b"])()],_.prototype,"_imagePromise",void 0),Object(i["a"])([Object(a["b"])()],_.prototype,"bitmaps",void 0),Object(i["a"])([Object(a["b"])()],_.prototype,"container",void 0),Object(i["a"])([Object(a["b"])()],_.prototype,"fetchSource",void 0),Object(i["a"])([Object(a["b"])()],_.prototype,"hidpi",void 0),Object(i["a"])([Object(a["b"])()],_.prototype,"imageMaxWidth",void 0),Object(i["a"])([Object(a["b"])()],_.prototype,"imageMaxHeight",void 0),Object(i["a"])([Object(a["b"])()],_.prototype,"imageRotationSupported",void 0),Object(i["a"])([Object(a["b"])()],_.prototype,"imageNormalizationSupported",void 0),Object(i["a"])([Object(a["b"])()],_.prototype,"requestUpdate",void 0),Object(i["a"])([Object(a["b"])()],_.prototype,"updating",null),_=Object(i["a"])([Object(o["a"])("esri.views.2d.layers.support.ExportStrategy")],_);const w=_},beba:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return h})),r.d(t,"e",(function(){return c})),r.d(t,"f",(function(){return o})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return u})),r.d(t,"i",(function(){return d})),r.d(t,"j",(function(){return f})),r.d(t,"k",(function(){return p}));r("d267");var i=r("a1ff");function n(e,t,r="nearest",n=!1){var s;const a=!(n&&"u8"===t.pixelType),o=a?5126:5121,c=null==t.pixels||0===t.pixels.length?null:a?t.getAsRGBAFloat():t.getAsRGBA(),h=null==(s=e.capabilities.textureFloat)?void 0:s.textureFloatLinear,u={width:t.width,height:t.height,target:3553,pixelFormat:6408,internalFormat:"webgl2"===e.webglVersion&&a?34836:6408,samplingMode:!h||"bilinear"!==r&&"cubic"!==r?9728:9729,dataType:o,wrapMode:33071,flipped:!1};return new i["a"](e,u,c)}function s(e,t){const r=4*t.size[0],n=t.size[1],s={width:r,height:n,target:3553,pixelFormat:6408,internalFormat:"webgl2"===e.webglVersion?34836:6408,dataType:5126,samplingMode:9728,wrapMode:33071,flipped:!1},a=new Float32Array(r*n*4);let o=0;for(let i=0;i<t.coefficients.length;i++)a[o++]=t.coefficients[i],i%3==2&&(a[o++]=1);return new i["a"](e,s,a)}function a(e,t){const r={width:t.length/4,height:1,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,flipped:!1};return new i["a"](e,r,t)}function o(e,t,r,i=1,n=!0,s=!1){return{u_flipY:n,u_isFloatTexture:s,u_applyTransform:!!e,u_opacity:i,u_transformSpacing:e?e.spacing:null,u_transformGridSize:e?e.size:null,u_targetImageSize:t,u_srcImageSize:r}}function c(e,t){return{u_colormapOffset:t||0,u_colormapMaxIndex:e?e.length/4-1:null}}function h(e,t){return{u_scale:e,u_offset:t}}function u(e){return{u_bandCount:e.bandCount,u_minOutput:e.outMin,u_maxOutput:e.outMax,u_minCutOff:e.minCutOff,u_maxCutOff:e.maxCutOff,u_factor:e.factor,u_useGamma:e.useGamma,u_gamma:e.gamma,u_gammaCorrection:e.gammaCorrection}}function l(e){return{u_hillshadeType:e.hillshadeType,u_sinZcosAs:e.sinZcosAs,u_sinZsinAs:e.sinZsinAs,u_cosZs:e.cosZs,u_weights:e.weights,u_factor:e.factor,u_minValue:e.minValue,u_maxValue:e.maxValue}}function d(e,t){const r=e.gl,i=t.glName,n=r.getProgramParameter(i,r.ACTIVE_UNIFORMS),s=new Map;let a;for(let o=0;o<n;o++)a=r.getActiveUniform(i,o),a&&s.set(a.name,{location:r.getUniformLocation(i,a.name),info:a});return s}function p(e,t,r){Object.keys(r).forEach(i=>{const n=t.get(i)||t.get(i+"[0]");n&&x(e,i,r[i],n)})}function f(e,t,r,i){r.length===i.length&&(i.some(e=>null==e)||r.some(e=>null==e)||r.forEach((r,n)=>{t.setUniform1i(r,n),e.bindTexture(i[n],n)}))}function x(e,t,r,i){if(null===i||null==r)return!1;const{info:n}=i;switch(n.type){case 5126:n.size>1?e.setUniform1fv(t,r):e.setUniform1f(t,r);break;case 35664:e.setUniform2fv(t,r);break;case 35665:e.setUniform3fv(t,r);break;case 35666:e.setUniform4fv(t,r);break;case 35675:e.setUniformMatrix3fv(t,r);break;case 35676:e.setUniformMatrix4fv(t,r);break;case 5124:n.size>1?e.setUniform1iv(t,r):e.setUniform1i(t,r);break;case 35670:e.setUniform1i(t,r?1:0);break;case 35667:case 35671:e.setUniform2iv(t,r);break;case 35668:case 35672:e.setUniform3iv(t,r);break;case 35669:case 35673:e.setUniform4iv(t,r);break;default:return!1}return!0}},c73a:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var i=r("b2b2"),n=r("1c92"),s=r("8c71"),a=r("738e"),o=r("7c4b"),c=r("894c"),h=r("a1ff");function u(e){return e&&"render"in e}function l(e){return e&&!("render"in e)}function d(e){const t=document.createElement("canvas");return t.width=e.width,t.height=e.height,e.render(t.getContext("2d")),t}function p(e,t,r){const i={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};return t&&r&&(i.width=t,i.height=r),new h["a"](e,i)}class f extends o["a"]{constructor(e=null,t,r=!0){super(),this.requestRenderOnSourceChangedEnabled=r,this._textureInvalidated=!0,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.blendFunction=t,this.source=e,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null)}get isSourceScaled(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}get height(){return void 0!==this._height?this._height:this.sourceHeight}set height(e){this._height=e}get source(){return this._source}set source(e){this._source=e,this.invalidateTexture()}get sourceHeight(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}get sourceWidth(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}get width(){return void 0!==this._width?this._width:this.sourceWidth}set width(e){this._width=e}beforeRender(e){super.beforeRender(e),this.updateTexture(e.context)}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())}_createTransforms(){return{dvs:Object(s["b"])()}}setTransform(e){const t=Object(n["b"])(this.transforms.dvs),[r,i]=e.toScreenNoRotation([0,0],[this.x,this.y]),s=this.resolution/this.pixelRatio/e.resolution,o=s*this.width,c=s*this.height,h=Math.PI*this.rotation/180;Object(n["c"])(t,t,Object(a["b"])(r,i)),Object(n["c"])(t,t,Object(a["b"])(o/2,c/2)),Object(n["m"])(t,t,-h),Object(n["c"])(t,t,Object(a["b"])(-o/2,-c/2)),Object(n["j"])(t,t,Object(a["b"])(o,c)),Object(n["k"])(this.transforms.dvs,e.displayViewMat3,t)}setSamplingProfile(e){this._texture&&(e.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(e.samplingMode))}bind(e,t){this._texture&&e.bindTexture(this._texture,t)}updateTexture(e){var t;if(!this.stage)return null==(t=this._texture)||t.dispose(),void(this._texture=null);if(!this._textureInvalidated)return;this._textureInvalidated=!1,this._texture||(this.source?this._texture=p(e,this.sourceWidth,this.sourceHeight):this._texture=p(e));const r=this.source;if(r){if(this._texture.resize(this.sourceWidth,this.sourceHeight),u(r))if(r instanceof c["a"]){const e=r.getRenderedRasterPixels();this._texture.setData(Object(i["l"])(e)?e.renderedRasterPixels:null)}else this._texture.setData(d(r));else l(r)&&this._texture.setData(r);this.ready()}else this._texture.setData(null)}onAttach(){this.invalidateTexture()}onDetach(){this.invalidateTexture()}}},db21:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return a}));const i=!0,n=32,s=1.5,a=200}}]);
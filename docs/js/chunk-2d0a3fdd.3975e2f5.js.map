{"version":3,"sources":["webpack:///./node_modules/@arcgis/core/views/3d/layers/WMTSLayerView3D.js"],"names":["p","getLogger","c","e","this","view","then","basemapTerrain","tilingSchemeLocked","t","tilingScheme","i","layer","activeLayer","r","tileMatrixSet","tileInfo","s","_getTileInfoSupportError","fullExtent","_getTileInfoCompatibilityError","_getCompatibleTileMatrixSet","tileMatrixSetId","id","_set","addResolvingPromise","when","_initialized","emit","super","canResume","_getTileInfoError","suspended","updatingHandles","add","refresh","error","notifyChange","tileMatrixSets","find","readOnly","prototype","m"],"mappings":"kHAAA,2LAI4vB,MAAMA,EAAE,OAAEC,UAAU,wCAAwC,IAAIC,EAAE,cAAc,cAAD,CAAG,eAAE,eAAE,WAAM,2BAA2B,OAAM,EAAG,aAAa,MAAMC,EAAE,eAAEC,KAAKC,KAAK,mCAAmCC,KAAK,KAAM,MAAMH,EAAE,IAAI,IAAI,OAAE,wCAAwC,sFAAsF,IAAIC,KAAKC,KAAKE,eAAeC,mBAAmB,MAAML,IAAI,MAAMM,EAAEL,KAAKC,KAAKE,eAAeG,aAAaC,EAAEP,KAAKQ,MAAMC,YAAY,IAAIC,EAAE,GAAGH,GAAGA,EAAEI,cAAc,CAACD,EAAEH,EAAEI,cAAc,MAAMZ,EAAEW,EAAEE,SAASC,EAAEb,KAAKc,yBAAyBf,EAAEW,EAAEK,aAAaf,KAAKgB,+BAA+BjB,EAAEM,GAAG,GAAGQ,EAAE,MAAMA,MAAM,CAAC,GAAGH,EAAEV,KAAKiB,+BAA+BP,EAAE,MAAMX,IAAIQ,EAAEW,gBAAgBR,EAAES,GAAGnB,KAAKoB,KAAK,WAAWV,EAAEE,UAAUZ,KAAKoB,KAAK,aAAaV,EAAEK,YAAYf,KAAKQ,MAAMO,WAAWL,EAAEK,aAAcf,KAAKqB,oBAAoBtB,GAAGC,KAAKsB,KAAK,IAAKtB,KAAKuB,gBAAiB,UAAUvB,KAAKwB,KAAK,gBAAgB,YAAY,IAAIC,MAAMC,YAAY,OAAM,EAAG,MAAM3B,EAAEC,KAAKQ,MAAMC,YAAYE,cAAc,OAAOZ,IAAIC,KAAK2B,kBAAkB5B,EAAEa,SAASb,EAAEgB,YAAY,kBAAkBf,KAAK4B,WAAW5B,KAAKwB,KAAK,gBAAgB,eAAexB,KAAK6B,gBAAgBC,IAAI9B,KAAK,4BAA4B,IAAKA,KAAK+B,WAAY/B,KAAK6B,gBAAgBC,IAAI9B,KAAK,gBAAgB,IAAKA,KAAK+B,WAAY/B,KAAK6B,gBAAgBC,IAAI9B,KAAKQ,MAAM,cAAeT,IAAI,IAAIM,EAAEN,EAAEY,cAAc,GAAGN,EAAE,CAAC,MAAMN,EAAEC,KAAK2B,kBAAkBtB,EAAEO,SAASP,EAAEU,YAAYhB,IAAIH,EAAEoC,MAAM,+DAA+DjC,GAAGM,EAAE,WAAWA,EAAEL,KAAKiB,8BAA8BZ,EAAEN,EAAEmB,gBAAgBb,EAAEc,GAAGvB,EAAEoC,MAAM,+EAA+EhC,KAAKiC,aAAa,aAAajC,KAAK0B,aAAa1B,KAAK+B,YAAa,8BAA8B,OAAO/B,KAAKQ,MAAMC,YAAYyB,eAAeC,KAAMpC,IAAI,MAAMM,EAAEN,EAAEa,SAAS,OAAOZ,KAAK2B,kBAAkBtB,EAAEN,EAAEgB,cAAe,kBAAkBhB,EAAEM,GAAG,OAAOL,KAAKc,yBAAyBf,EAAEM,IAAIL,KAAKgB,+BAA+BjB,EAAEC,KAAKC,KAAKE,eAAeG,gBAAgB,eAAE,CAAC,eAAE,CAAC8B,UAAS,KAAMtC,EAAEuC,UAAU,uBAAuB,MAAM,eAAE,CAAC,kBAAKvC,EAAEuC,UAAU,kBAAa,GAAQ,eAAE,CAAC,kBAAKvC,EAAEuC,UAAU,aAAQ,GAAQ,eAAE,CAAC,kBAAKvC,EAAEuC,UAAU,iBAAY,GAAQ,eAAE,CAAC,kBAAKvC,EAAEuC,UAAU,gBAAW,GAAQvC,EAAE,eAAE,CAAC,eAAE,yCAAyCA,GAAG,IAAIwC,EAAExC,EAAiB","file":"js/chunk-2d0a3fdd.3975e2f5.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import\"../../../core/has.js\";import t from\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as r}from\"../../../core/accessorSupport/decorators/subclass.js\";import s from\"../../../core/Error.js\";import\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import{whenTrueOnce as o}from\"../../../core/watchUtils.js\";import{RefreshableLayerView as a}from\"../../layers/RefreshableLayerView.js\";import{LayerView3D as l}from\"./LayerView3D.js\";import{TiledLayerView3D as n}from\"./TiledLayerView3D.js\";import h from\"../../layers/LayerView.js\";const p=t.getLogger(\"esri.views.3d.layers.WMTSLayerView3d\");let c=class extends(a(n(l(h)))){get hasMixedImageFormats(){return!0}initialize(){const e=o(this.view,\"basemapTerrain.tilingSchemeDone\").then((()=>{const e=()=>new s(\"layerview:no-compatible-tiling-scheme\",\"None of the tiling schemes supported by the service are compatible with the scene.\");if(!this.view.basemapTerrain.tilingSchemeLocked)throw e();const t=this.view.basemapTerrain.tilingScheme,i=this.layer.activeLayer;let r;if(i&&i.tileMatrixSet){r=i.tileMatrixSet;const e=r.tileInfo,s=this._getTileInfoSupportError(e,r.fullExtent)||this._getTileInfoCompatibilityError(e,t);if(s)throw s}else{if(r=this._getCompatibleTileMatrixSet(),!r)throw e();i.tileMatrixSetId=r.id}this._set(\"tileInfo\",r.tileInfo),this._set(\"fullExtent\",r.fullExtent),this.layer.fullExtent=r.fullExtent}));this.addResolvingPromise(e),this.when((()=>this._initialized()))}refresh(){this.emit(\"data-changed\")}canResume(){if(!super.canResume())return!1;const e=this.layer.activeLayer.tileMatrixSet;return e&&!this._getTileInfoError(e.tileInfo,e.fullExtent)}async doRefresh(){this.suspended||this.emit(\"data-changed\")}_initialized(){this.updatingHandles.add(this,\"layer.activeLayer.styleId\",(()=>this.refresh())),this.updatingHandles.add(this,\"tileMatrixSet\",(()=>this.refresh())),this.updatingHandles.add(this.layer,\"activeLayer\",(e=>{let t=e.tileMatrixSet;if(t){const e=this._getTileInfoError(t.tileInfo,t.fullExtent);e&&(p.error(\"The selected tile matrix set is not compatible with the view\",e),t=null)}else t=this._getCompatibleTileMatrixSet(),t?e.tileMatrixSetId=t.id:p.error(\"The layer does not provide a tiling scheme that is compatible with the view\");this.notifyChange(\"suspended\"),this.canResume()&&this.refresh()}))}_getCompatibleTileMatrixSet(){return this.layer.activeLayer.tileMatrixSets.find((e=>{const t=e.tileInfo;return!this._getTileInfoError(t,e.fullExtent)}))}_getTileInfoError(e,t){return this._getTileInfoSupportError(e,t)||this._getTileInfoCompatibilityError(e,this.view.basemapTerrain.tilingScheme)}};e([i({readOnly:!0})],c.prototype,\"hasMixedImageFormats\",null),e([i()],c.prototype,\"fullExtent\",void 0),e([i()],c.prototype,\"layer\",void 0),e([i()],c.prototype,\"suspended\",void 0),e([i()],c.prototype,\"tileInfo\",void 0),c=e([r(\"esri.views.3d.layers.WMTSLayerView3D\")],c);var m=c;export default m;\n"],"sourceRoot":""}
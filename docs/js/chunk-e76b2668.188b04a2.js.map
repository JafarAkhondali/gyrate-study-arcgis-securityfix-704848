{"version":3,"sources":["webpack:///./node_modules/@arcgis/core/views/3d/layers/ImageryTileLayerView3D.js","webpack:///./node_modules/@arcgis/core/renderers/support/clickToleranceUtils.js","webpack:///./node_modules/@arcgis/core/views/layers/ImageryTileLayerView.js","webpack:///./node_modules/@arcgis/core/views/layers/support/popupUtils.js","webpack:///./node_modules/@arcgis/core/layers/support/rasterFunctions/rasterProjectionHelper.js","webpack:///./node_modules/@arcgis/core/views/support/drapedUtils.js"],"names":["p","super","arguments","this","isAlignedMapTile","layer","increaseRasterJobHandlerUsage","e","updateFullExtent","addResolvingPromise","r","view","then","basemapTerrain","tilingScheme","tileInfo","t","indexOf","format","compatibleWith","i","toTileInfo","_set","updatingHandles","add","refresh","decreaseRasterJobHandlerUsage","document","createElement","getContext","size","width","height","clearRect","getImageData","lods","scale","length","levelRangeFromScaleRange","s","a","l","symbolizer","canRenderInWebGL","n","requestRawData","signal","requestAsImageElement","m","fetchTile","HTMLImageElement","d","pixelBlock","_blankTile","applyRenderer","h","symbolizerRenderer","rendererJSON","symbolizerParameters","generateWebGLParameters","_getSymbolizerOptions","transformGrid","bandIds","lodAt","resolution","isGCS","spatialReference","isGeographic","x","y","JSON","stringify","lij","emit","suspended","readOnly","prototype","xoffset","Math","max","abs","yoffset","stops","filter","type","map","maxSize","minSize","o","f","floor","renderer","event","pointerType","visualVariables","symbol","uniqueValueInfos","forEach","classBreakInfos","u","_rasterFieldPrefix","fullExtent","datumTransformation","dynamicRangeAdjustment","Promise","reject","popupEnabled","popupTemplate","value","identify","join","ObjectId","_formatAttributeValue","rasterInfo","attributeTable","features","attributes","Value","VALUE","String","hasOwnProperty","clone","sourceLayer","push","resolve","fieldInfos","_getFieldInfo","trim","_formatDelimitedString","_formatNumberFromString","toLowerCase","some","fieldName","replace","split","Number","isNaN","async","getRequiredFields","fields","lastEditInfoEnabled","objectIdField","typeIdField","globalIdField","relationships","includes","keyField","defaultPopupTemplateEnabled","defaultPopupTemplate","isWGS84","isWebMercator","equals","cols","rows","M","c","center","xmin","xmax","ymin","ymax","w","origin","valid","g","R","j","apply","min","b","v","N","S","ceil","z","W","G","P","L","inverseTransform","NaN","q","A","Float32Array","E","F","offsets","error","coefficients","spacing","log","pixelSize","LN2","storageInfo","maximumPyramidLevel","round","pyramidLevel","pyramidResolution","nativePixelSize","excessiveReading","extent","projectedPixelSize","scales","srcResolutions","isCustomTilingScheme","wkid","overlayPixelSizeInMapUnits","basemapSpatialReference","toMap","intersects"],"mappings":"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","file":"js/chunk-e76b2668.188b04a2.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import\"../../../core/has.js\";import{unwrap as r}from\"../../../core/maybe.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as t}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import{whenTrueOnce as s}from\"../../../core/watchUtils.js\";import{RefreshableLayerView as a}from\"../../layers/RefreshableLayerView.js\";import o from\"../terrain/RasterTile.js\";import{LayerView3D as l}from\"./LayerView3D.js\";import{TiledLayerView3D as n}from\"./TiledLayerView3D.js\";import m from\"../../layers/LayerView.js\";import{createQueryGeometry as d}from\"../../support/drapedUtils.js\";import{ImageryTileLayerView as h}from\"../../layers/ImageryTileLayerView.js\";let p=class extends(h(a(n(l(m))))){constructor(){super(...arguments),this.isAlignedMapTile=!0}initialize(){this.layer.increaseRasterJobHandlerUsage();const e=this.updateFullExtent();this.addResolvingPromise(e);const r=s(this.view,\"basemapTerrain.tilingSchemeLocked\").then((()=>{const e=this.view.basemapTerrain.tilingScheme,{tileInfo:r}=this.layer,t=[\"png\",\"png24\",\"png32\",\"jpg\",\"mixed\"].indexOf(r.format)>-1&&e.compatibleWith(r);this.isAlignedMapTile=t;const i=t?r:e.toTileInfo();this._set(\"tileInfo\",i),this.updatingHandles.add(this,\"layer.renderer\",(()=>this.refresh())),this.updatingHandles.add(this,\"layer.interpolation\",(()=>this.refresh())),this.updatingHandles.add(this,\"layer.bandIds\",(()=>this.refresh())),this.updatingHandles.add(this,\"layer.multidimensionalDefinition\",(()=>this.refresh()))}));this.addResolvingPromise(r)}destroy(){this.layer.decreaseRasterJobHandlerUsage(),this.view=null}get _blankTile(){const e=document.createElement(\"canvas\"),r=e.getContext(\"2d\"),[t,i]=this.tileInfo.size;return e.width=t,e.height=i,r.clearRect(0,0,t,i),r.getImageData(0,0,t,i)}get imageFormatIsOpaque(){return\"jpg\"===this.layer.tileInfo.format}get hasMixedImageFormats(){return\"mixed\"===this.layer.tileInfo.format}get dataLevelRange(){const e=this.tileInfo.lods,r=this.layer.tileInfo.lods,t=e[0].scale,i=r[r.length-1].scale;return this.levelRangeFromScaleRange(t,i)}async fetchTile(e,t,i,s){const a=this.tileInfo,l=this.layer.symbolizer.canRenderInWebGL,n={tileInfo:a,requestRawData:l,signal:r(s.signal),requestAsImageElement:this.isAlignedMapTile},m=await this.layer.fetchTile(e,t,i,n);if(m instanceof HTMLImageElement)return m;let d=m&&m.pixelBlock;if(!d)return this._blankTile;if(!l&&(d=await this.layer.applyRenderer(m),null==d))return this._blankTile;const h=new o([e,t,i],d,a.size[0],a.size[1]);return l&&(h.symbolizerRenderer=this.layer.symbolizer.rendererJSON,h.symbolizerParameters=this.layer.symbolizer.generateWebGLParameters(this._getSymbolizerOptions(e)),h.transformGrid=m.transformGrid),h.bandIds=this.layer.bandIds,h}_getSymbolizerOptions(e){const r=this.tileInfo.lodAt(e).resolution;return{pixelBlock:null,isGCS:this.view.spatialReference.isGeographic,resolution:{x:r,y:r},bandIds:this.layer.bandIds}}ensureSymbolizerParameters(e){JSON.stringify(e.symbolizerRenderer)!==JSON.stringify(this.layer.symbolizer.rendererJSON)&&(e.symbolizerParameters=this.layer.symbolizer.generateWebGLParameters(this._getSymbolizerOptions(e.lij[0])))}createFetchPopupFeaturesQueryGeometry(e,r){return d(e,r,this.view)}refresh(){this.emit(\"data-changed\")}async doRefresh(e){this.suspended||this.emit(\"data-changed\")}};e([t({readOnly:!0})],p.prototype,\"_blankTile\",null),e([t({readOnly:!0})],p.prototype,\"imageFormatIsOpaque\",null),e([t({readOnly:!0})],p.prototype,\"hasMixedImageFormats\",null),e([t({readOnly:!0})],p.prototype,\"dataLevelRange\",null),p=e([i(\"esri.views.3d.layers.ImageryTileLayerView3D\")],p);var y=p;export default y;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nfunction t(t,e){return e?\"xoffset\"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):\"yoffset\"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function e(t){let e=0,n=0;for(let r=0;r<t.length;r++){const s=t[r].size;\"number\"==typeof s&&(e+=s,n++)}return e/n}function n(t,n){return\"number\"==typeof t?t:t&&t.stops&&t.stops.length?e(t.stops):n}function r(t,e){if(!e)return t;const r=e.filter((t=>\"size\"===t.type)).map((e=>{const{maxSize:r,minSize:s}=e;return(n(r,t)+n(s,t))/2}));let s=0;const o=r.length;if(0===o)return t;for(let n=0;n<o;n++)s+=r[n];const f=Math.floor(s/o);return Math.max(f,t)}function s(e){const n=e&&e.renderer,s=\"touch\"===(e&&e.event&&e.event.pointerType)?9:6;if(!n)return s;const o=\"visualVariables\"in n?r(s,n.visualVariables):s;if(\"simple\"===n.type)return t(o,n.symbol);if(\"unique-value\"===n.type){let e=o;return n.uniqueValueInfos.forEach((n=>{e=t(e,n.symbol)})),e}if(\"class-breaks\"===n.type){let e=o;return n.classBreakInfos.forEach((n=>{e=t(e,n.symbol)})),e}return n.type,o}export{s as calculateTolerance};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import{isSome as t}from\"../../core/maybe.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import{subclass as i}from\"../../core/accessorSupport/decorators/subclass.js\";import o from\"../../core/Error.js\";import\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import s from\"../../Graphic.js\";import{getDefaultDatumTransformationForDataset as a,projectExtent as n}from\"../../layers/support/rasterFunctions/rasterProjectionHelper.js\";import{getFetchPopupTemplate as l}from\"./support/popupUtils.js\";const p=p=>{let u=class extends p{constructor(){super(...arguments),this._rasterFieldPrefix=\"Raster.\",this.layer=null,this.view=null,this.fullExtent=null,this.tileInfo=null,this.datumTransformation=null}get hasTilingEffects(){return this.layer.renderer&&\"dynamicRangeAdjustment\"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment}async fetchPopupFeatures(e,r){const{layer:i}=this;if(!e)return Promise.reject(new o(\"imageryTileLayerView:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:i}));const{popupEnabled:a}=i,n=l(i,r);if(!a||!t(n))throw new o(\"imageryTileLayerView:fetchPopupFeatures\",\"Missing required popupTemplate or popupEnabled\",{popupEnabled:a,popupTemplate:n});const p=[],{value:u}=await i.identify(e);if(u){var f,m;const e=u.join(\", \"),t={ObjectId:0},r=\"Raster.ServicePixelValue\";t[r]=this._formatAttributeValue(e,r);const o=null==(f=i.rasterInfo)||null==(m=f.attributeTable)?void 0:m.features;if(o&&o.length>0){const r=o.filter((t=>{const r=t.attributes.value||t.attributes.Value||t.attributes.VALUE;return String(r)===e}));if(r.length>0){const e=r[0];if(e)for(const r in e.attributes)if(e.attributes.hasOwnProperty(r)){const i=this._rasterFieldPrefix+r;t[i]=this._formatAttributeValue(e.attributes[r],i)}}}const a=new s(this.fullExtent.clone(),null,t);a.layer=i,a.sourceLayer=a.layer,p.push(a)}return p}updateFullExtent(){const e=this.layer.tileInfo;let t;e&&e.spatialReference||(t=new o(\"layerview:tiling-information-missing\",\"The layer doesn't provide tiling information\",{layer:this.layer}));const r=a(this.layer.fullExtent,this.view.spatialReference,!1),i=n(this.layer.fullExtent,this.view.spatialReference,r);return null==i&&(t=new o(\"layerview:projection-not-supported\",\"The layer extent cannot be projected to the view's spatial reference\",{layer:this.layer})),this._set(\"fullExtent\",i),this.datumTransformation||(this.datumTransformation=a(this.layer.fullExtent,this.view.spatialReference,!0)),t?Promise.reject(t):Promise.resolve()}_formatAttributeValue(e,t){if(\"string\"==typeof e){const r=this.layer.popupTemplate&&this.layer.popupTemplate.fieldInfos,i=this._getFieldInfo(r,t),o=i&&i.format;if(o){let t,r;return e.trim().indexOf(\",\")>-1?(t=\",\",r=t+\" \",this._formatDelimitedString(e,t,r,o)):e.trim().indexOf(\" \")>-1?(t=r=\" \",this._formatDelimitedString(e,t,r,o)):this._formatNumberFromString(e,o)}}return e}_getFieldInfo(e,t){if(!e||!e.length||!t)return;const r=t.toLowerCase();let i;return e.some((e=>!(!e.fieldName||e.fieldName.toLowerCase()!==r&&e.fieldName.toLowerCase()!==r.replace(/ /g,\"_\"))&&(i=e,!0))),i}_formatDelimitedString(e,t,r,i){return e&&t&&r&&i?e.trim().split(t).map((e=>this._formatNumberFromString(e,i))).join(r):e}_formatNumberFromString(e,t){if(!e||!t)return e;const r=Number(e);return isNaN(r)?e:t.format(r)}};return e([r()],u.prototype,\"layer\",void 0),e([r()],u.prototype,\"view\",void 0),e([r()],u.prototype,\"fullExtent\",void 0),e([r()],u.prototype,\"tileInfo\",void 0),e([r({readOnly:!0})],u.prototype,\"hasTilingEffects\",null),u=e([i(\"esri.views.layers.ImageryTileLayerView\")],u),u};export default p;export{p as ImageryTileLayerView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import{getFeatureEditFields as p,fixFields as l,hasField as t}from\"../../../layers/support/fieldUtils.js\";async function i(i,d=i.popupTemplate){if(!e(d))return[];const o=await d.getRequiredFields(i.fields),{lastEditInfoEnabled:s}=d,{objectIdField:u,typeIdField:a,globalIdField:n,relationships:f}=i;if(o.includes(\"*\"))return[\"*\"];const r=s?await p(i):[],m=l(i.fields,[...o,...r]);return a&&m.push(a),m&&u&&t(i.fields,u)&&-1===m.indexOf(u)&&m.push(u),m&&n&&t(i.fields,n)&&-1===m.indexOf(n)&&m.push(n),f&&f.forEach((e=>{const{keyField:p}=e;m&&p&&t(i.fields,p)&&-1===m.indexOf(p)&&m.push(p)})),m}function d(p,l){return p.popupTemplate?p.popupTemplate:e(l)&&l.defaultPopupTemplateEnabled&&e(p.defaultPopupTemplate)?p.defaultPopupTemplate:null}export{d as getFetchPopupTemplate,i as getRequiredFields};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Error.js\";import{getInfo as n}from\"../../../geometry/support/spatialReferenceUtils.js\";import{project as t}from\"../../../geometry/support/webMercatorUtils.js\";import o from\"../../../geometry/Point.js\";import i from\"../../../geometry/Extent.js\";import\"../../../geometry.js\";import{getMetersPerUnitForSR as r}from\"../../../core/unitUtils.js\";import{isLoaded as a,isSupported as s,load as l,getTransformation as c,project as x}from\"../../../geometry/projection.js\";const u=5e-4,m=function(e,n){const t=(e.isWGS84||e.isWebMercator)&&(n.isWGS84||n.isWebMercator);return!(e.equals(n)||t)},p=function(e,n){const t=(e[0]+e[4]+e[4*n.cols]+e[4*n.cols+4])/4,o=(e[1]+e[5]+e[4*n.rows+1]+e[4*n.rows+5])/4;return[Math.abs(t-e[2*n.rows+2]),Math.abs(o-e[2*n.rows+3])]},f=32;async function h(){if(a()||!s())return null;await l()}function y(n,t,o){if(!m(n.spatialReference,t))return null;if(!a())throw new e(\"rasterprojectionhelper-projectResolution\",\"projection engine is not loaded\");return o?c(t,n.spatialReference,n):c(n.spatialReference,t,n)}function M(n,o,r,s=null){if(n.spatialReference.equals(o))return n;const l=m(n.spatialReference,o);if(l&&!a())throw new e(\"rasterprojectionhelper-projectResolution\",\"projection engine is not loaded\");const c=r.center,u=new i({xmin:c.x-n.x/2,xmax:c.x+n.x/2,ymin:c.y-n.y/2,ymax:c.y+n.y/2,spatialReference:n.spatialReference}),p=l?x(u,o,s):t(u,o);if(null==p)return null;return{x:p.xmax-p.xmin,y:p.ymax-p.ymin}}function w(e,n=.01){return r(e)?n/r(e):0}function d(o,i,r=null,s=!0){const l=o.spatialReference;if(l.equals(i))return o;const c=m(l,i);if(c&&!a())throw new e(\"rasterprojectionhelper-projectResolution\",\"projection engine is not loaded\");const p=c?x(o,i,r):t(o,i);if(p&&s&&i.isGeographic){var f,h;const[e,t]=l.isWebMercator?n(l).origin:null!=(f=null==(h=n(l))?void 0:h.valid)?f:[],i=w(l);i&&null!=e&&null!=t&&(Math.abs(o.x-e)<i&&Math.abs(180-p.x)<u?p.x-=360:Math.abs(o.x-t)<i&&Math.abs(180+p.x)<u&&(p.x+=360))}return p}function g(i,r,s=null,l=!0){var c,p,f,h;const y=i.spatialReference;if(y.equals(r))return i;const M=m(y,r);if(M&&!a())throw new e(\"rasterprojectionhelper-projectExtent\",\"projection engine is not loaded\");const g=M?x(i,r,s):t(i,r);let[R,j]=null!=(c=null==(p=n(y))?void 0:p.origin)?c:[];if(g&&l&&y.isWebMercator&&r.isGeographic&&null!=R&&null!=j){const e=.001,n=1e3;if(Math.abs(i.xmin-R)<e&&Math.abs(j-i.xmax)>n&&Math.abs(180-g.xmax)<u){g.xmin=-180;const e=[];e.push(new o(i.xmax,i.ymin,y)),e.push(new o(i.xmax,(i.ymin+i.ymax)/2,y)),e.push(new o(i.xmax,i.ymax,y));const n=e.map((e=>d(e,r,s))).filter((e=>!isNaN(null==e?void 0:e.x))).map((e=>e.x));g.xmax=Math.max.apply(null,n)}if(Math.abs(i.xmax-j)<e&&Math.abs(R-i.xmin)>n&&Math.abs(180+g.xmin)<u){g.xmax=180;const e=[];e.push(new o(i.xmin,i.ymin,y)),e.push(new o(i.xmin,(i.ymin+i.ymax)/2,y)),e.push(new o(i.xmin,i.ymax,y));const n=e.map((e=>d(e,r,s))).filter((e=>!isNaN(null==e?void 0:e.x))).map((e=>e.x));g.xmin=Math.min.apply(null,n)}}[R,j]=r.isWebMercator?n(r).origin:null!=(f=null==(h=n(r))?void 0:h.valid)?f:[];const b=w(r);return b&&null!=R&&null!=j&&(Math.abs(g.xmin-R)<b&&(g.xmin=R),Math.abs(g.xmax-j)<b&&(g.xmax=j)),g}function R(t,i,r,s=null,l=null,c=!1,x=[f,f]){var u,h;if(m(t.spatialReference,i.spatialReference)&&!a())throw new e(\"rasterprojectionhelper-projectResolution\",\"projection engine is not loaded\");if(!(t&&i&&r))return null;const{xmin:y,ymin:M,xmax:w,ymax:g}=t,R=t.spatialReference,j=i.spatialReference,[b,v]=null!=(u=null==(h=n(R))?void 0:h.valid)?u:[],N={x:x[0]*r.x,y:x[1]*r.y},S={cols:Math.ceil((w-y)/N.x-.1)+1,rows:Math.ceil((g-M)/N.y-.1)+1},z=N.x,W=N.y,G=[];let P,L=!1;for(let e=0;e<S.cols;e++){const n=[];for(let t=0;t<S.rows;t++){let r=d(new o({x:y+z*e,y:g-W*t,spatialReference:R}),j,s);l&&(r=l.inverseTransform(r)),n.push(r),e>0&&c&&r&&P[t]&&null!=b&&r.x<P[t].x&&(r.x+=v-b),r?(G.push((r.x-i.xmin)/(i.xmax-i.xmin)),G.push((i.ymax-r.y)/(i.ymax-i.ymin))):(G.push(NaN),G.push(NaN),L=!0)}P=n}const q=p(G,S),A=new Float32Array((S.cols-1)*(S.rows-1)*2*6),E=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),F=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let e=0;e<S.cols-1;e++){for(let n=0;n<S.rows-1;n++){let t=e*S.rows*2+2*n;const o=G[t],i=G[t+1],r=G[t+2],a=G[t+3];t+=2*S.rows;const s=G[t],l=G[t+1],c=G[t+2],x=G[t+3];let u=0,m=12*(n*(S.cols-1)+e);for(let e=0;e<3;e++)A[m++]=E[u++]*o+E[u++]*r+E[u++]*c;u=0;for(let e=0;e<3;e++)A[m++]=E[u++]*i+E[u++]*a+E[u++]*x;u=0;for(let e=0;e<3;e++)A[m++]=F[u++]*o+F[u++]*s+F[u++]*c;u=0;for(let e=0;e<3;e++)A[m++]=F[u++]*i+F[u++]*l+F[u++]*x}if(L)for(let e=0;e<A.length;e++)isNaN(A[e])&&(A[e]=-1)}return{offsets:G,error:q,coefficients:A,spacing:x,size:[S.cols-1,S.rows-1]}}function j(e,n,t){const i=Math.log(e.x/n.pixelSize.x)/Math.LN2,r=Math.log(e.y/n.pixelSize.y)/Math.LN2,a=n.storageInfo.maximumPyramidLevel||0;let s=\"down\"===t?Math.floor(Math.min(i,r)):\"up\"===t?Math.ceil(Math.max(i,r)):Math.round((i+r)/2),l=!1;s<0?s=0:s>a&&(l=s>a+3,s=a);const c=2**s;return{pyramidLevel:s,pyramidResolution:new o({x:c*n.nativePixelSize.x,y:c*n.nativePixelSize.y,spatialReference:n.spatialReference}),excessiveReading:l}}function b(e,n,t=512,i=!0){const{extent:a,spatialReference:s,pixelSize:l}=e,c=M(new o({x:l.x,y:l.y,spatialReference:s}),n,a);if(null==c)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const x=(c.x+c.y)/2,u=r(n),m=x*u*96*39.37,p=n.isGeographic?512/t*295828763.7958547:512/t*591657527.591555;let f=!1;const h=g(a,n);i&&(n.isGeographic||n.isWebMercator)&&(f=h.xmin*h.xmax<0);let y,w=m;const d=1.001;if(f){w=p;const e=.29858214164761665,n=e*(96*u*39.37);y=M(new o({x:e,y:e,spatialReference:{wkid:3857}}),s,h),y.x*=w/n,y.y*=w/n}else{y={x:l.x,y:l.y};const n=Math.ceil(Math.log(Math.min(e.width,e.height)/32)/Math.LN2);let t=0;for(;w<p*(d/2)&&t<n;)t++,w*=2,y.x*=2,y.y*=2;Math.max(w,p)/Math.min(w,p)<=d&&(w=p)}const R=[w],j=[{x:y.x,y:y.y}],b=70.5310735,v=Math.min(b,m)/d;for(;w>=v;)w/=2,y.x/=2,y.y/=2,R.push(w),j.push({x:y.x,y:y.y});return{projectedPixelSize:c,scales:R,srcResolutions:j,isCustomTilingScheme:!f}}export{b as computeProjectedScales,f as defaultGridSpacing,y as getDefaultDatumTransformationForDataset,R as getProjectionOffsetGrid,h as load,g as projectExtent,d as projectPoint,M as projectResolution,j as snapPyramid};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../core/maybe.js\";import r from\"../../geometry/Extent.js\";import\"../../geometry.js\";import{getMetersPerUnitForSR as n}from\"../../core/unitUtils.js\";import{calculateTolerance as i}from\"../../renderers/support/clickToleranceUtils.js\";function a(t,i,a,o=new r){let s;if(\"2d\"===a.type)s=i*a.resolution;else if(\"3d\"===a.type){const r=a.overlayPixelSizeInMapUnits(t),o=a.basemapSpatialReference;s=e(o)&&!o.equals(a.spatialReference)?n(o)/n(a.spatialReference):i*r}const m=t.x-s,p=t.y-s,c=t.x+s,l=t.y+s,{spatialReference:f}=a;return o.xmin=Math.min(m,c),o.ymin=Math.min(p,l),o.xmax=Math.max(m,c),o.ymax=Math.max(p,l),o.spatialReference=f,o}function o(e,r,n){const o=n.toMap(e);if(t(o))return!1;return a(o,i(),n,s).intersects(r)}const s=new r;export{a as createQueryGeometry,o as intersectsDrapedGeometry};\n"],"sourceRoot":""}
{"version":3,"sources":["webpack:///./node_modules/@arcgis/core/views/2d/layers/WMSLayerView2D.js","webpack:///./node_modules/@arcgis/core/views/2d/engine/BitmapContainer.js","webpack:///./node_modules/@arcgis/core/views/layers/LayerView.js","webpack:///./node_modules/@arcgis/core/views/layers/support/ClipArea.js","webpack:///./node_modules/@arcgis/core/views/layers/support/ClipRect.js","webpack:///./node_modules/@arcgis/core/views/layers/support/Geometry.js","webpack:///./node_modules/@arcgis/core/views/layers/support/Path.js","webpack:///./node_modules/@arcgis/core/views/2d/layers/LayerView2D.js","webpack:///./node_modules/@arcgis/core/views/2d/engine/ImageryBitmapSource.js","webpack:///./node_modules/@arcgis/core/views/2d/engine/webgl/Mesh2D.js","webpack:///./node_modules/@arcgis/core/views/2d/engine/webgl/ClippingInfo.js","webpack:///./node_modules/@arcgis/core/views/2d/engine/webgl/WGLContainer.js","webpack:///./node_modules/@arcgis/core/views/layers/WMSLayerView.js","webpack:///./node_modules/@arcgis/core/layers/support/ExportWMSImageParameters.js","webpack:///./node_modules/@arcgis/core/views/2d/viewStateUtils.js","webpack:///./node_modules/@arcgis/core/views/2d/layers/support/ExportStrategy.js","webpack:///./node_modules/@arcgis/core/views/2d/engine/Bitmap.js"],"names":["l","getLogger","u","layer","e","view","t","this","supportsSpatialReference","spatialReference","addResolvingPromise","Promise","reject","strategy","update","catch","error","imageMaxHeight","imageMaxWidth","r","_bitmapContainer","container","addChild","fetchSource","fetchImage","bind","requestUpdate","imageRotationSupported","imageNormalizationSupported","hidpi","handles","add","watch","remove","destroy","removeChild","removeAllChildren","x","i","y","s","a","n","p","m","children","some","width","height","resolution","h","c","d","xmin","ymin","xmax","ymax","Math","round","extent","updating","updateRequested","timeExtent","timestamp","refreshTimestamp","prototype","blendFunction","registerRenderPass","name","brushes","bitmap","target","drawPhase","MAP","super","prepareRenderPasses","EventedMixin","parent","when","id","title","declaredClass","get","canResume","getSuspendInfo","suspended","legendEnabled","updatingHandles","isUpdating","_override","_clearOverride","visible","suspendInfo","ready","viewNotReady","loaded","layerNotLoaded","layerInvisible","readOnly","type","Boolean","arguments","left","right","top","bottom","_get","Number","String","json","write","base","key","typeMap","polygon","geometry","clone","types","read","path","ofType","rect","clips","moving","attached","lastUpdateId","fadeTransitionEnabled","opacity","blendMode","effect","on","notifyChange","whenLayerView","then","destroyed","attach","detach","minScale","maxScale","o","isFulfilled","isResolved","_set","isVisibleAtScale","scale","pixelBlock","originalPixelBlock","filter","getAsRGBA","createImageData","data","set","putImageData","renderedRasterPixels","Uint8Array","buffer","BYTES_PER_ELEMENT","coords","lengths","length","push","f","slice","_cache","vertices","indices","primitiveType","isMapSpace","fromScreenExtent","Uint32Array","floor","fromPolygon","fromMapExtent","fromRect","toScreen","indexBuffer","dispose","vertexBuffers","createIndex","Object","keys","reduce","createVertex","parseFloat","_clip","stage","_handle","_invalidate","mesh","vao","_destroyGL","size","_lastWidth","_lastHeight","_createMesh","getIndexBuffer","getVertexBuffers","requestRender","max","_createScreenRect","fromPath","fromGeometry","constructor","_clips","forEach","_updateClippingInfo","createRenderParams","painter","globalOpacity","profiler","LABEL","computedOpacity","recordContainerStart","beforeRenderLayer","_clippingInfos","updateTransforms","state","renderChildren","compositeLayer","recordContainerEnd","_renderPasses","beforeRender","render","afterRender","requireFBO","requiresDedicatedFBO","clip","LABEL_ALPHA","DEBUG","HIGHLIGHT","setTransform","onAttach","onDetach","items","map","fromClipArea","exportImageParameters","commitProperty","popupEnabled","createFetchPopupFeaturesQuery","resolve","fetchFeatureInfo","sublayers","propertyName","visibleSublayers","join","unshift","layers","imageFormat","imageTransparency","version","format","request","service","styles","transparent","PI","rotation","abs","cos","sin","g","_imagePromise","pixelRatio","stationary","valid","_singleExport","min","worldScreenWidth","_tiledExport","async","includes","fadeOut","fadeIn","console","invalidateTexture","signal","center","_export","create","scales","getTileCoverage","getTileBounds","all","S","document","createElement","getContext","pixelFormat","internalFormat","dataType","wrapMode","_","requestRenderOnSourceChangedEnabled","_textureInvalidated","stencilRef","coordScale","_height","_source","_width","transforms","dvs","source","_texture","sourceWidth","sourceHeight","HTMLImageElement","naturalHeight","naturalWidth","updateTexture","toScreenNoRotation","displayViewMat3","mips","descriptor","hasMipmap","generateMipmap","setSamplingMode","samplingMode","context","bindTexture","resize","getRenderedRasterPixels","setData"],"mappings":"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","file":"js/chunk-4eb32158.4929de10.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import\"../../../core/has.js\";import t from\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as r}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import s from\"../../../core/Error.js\";import\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import{isAbortError as a}from\"../../../core/promiseUtils.js\";import o from\"../../../geometry/Extent.js\";import{RefreshableLayerView as n}from\"../../layers/RefreshableLayerView.js\";import p from\"../../layers/LayerView.js\";import{WMSLayerView as m}from\"../../layers/WMSLayerView.js\";import{BitmapContainer as h}from\"../engine/BitmapContainer.js\";import{LayerView2DMixin as c}from\"./LayerView2D.js\";import d from\"./support/ExportStrategy.js\";const l=t.getLogger(\"esri.views.2d.layers.WMSLayerView2D\");let u=class extends(m(n(c(p)))){initialize(){const{layer:e,view:t}=this;e.supportsSpatialReference(t.spatialReference)||this.addResolvingPromise(Promise.reject(new s(\"layerview:spatial-reference-incompatible\",\"The spatial references supported by this WMS layer are incompatible with the spatial reference of the view\",{layer:e})))}hitTest(){return null}update(e){this.strategy.update(e).catch((e=>{a(e)||l.error(e)}))}attach(){const{layer:e}=this,{imageMaxHeight:t,imageMaxWidth:r}=e;this._bitmapContainer=new h,this.container.addChild(this._bitmapContainer),this.strategy=new d({container:this._bitmapContainer,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxHeight:t,imageMaxWidth:r,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1}),this.handles.add(this.watch(\"exportImageVersion\",(()=>this.requestUpdate())),\"exportImageVersion\")}detach(){this.handles.remove(\"exportImageVersion\"),this.strategy.destroy(),this.container.removeChild(this._bitmapContainer),this._bitmapContainer.removeAllChildren()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}createFetchPopupFeaturesQuery(e){const{view:t}=this,r=this._bitmapContainer,{x:i,y:s}=e,{spatialReference:a}=t;let n=null,p=0,m=0;if(r.children.some((e=>{const{width:t,height:r,resolution:h,x:c,y:d}=e,l=c+h*t,u=d-h*r;return i>=c&&i<=l&&s<=d&&s>=u&&(n=new o({xmin:c,ymin:u,xmax:l,ymax:d,spatialReference:a}),p=t,m=r,!0)})),!n)return null;const h=n.width/p,c=Math.round((i-n.xmin)/h),d=Math.round((n.ymax-s)/h);return{extent:n,width:p,height:m,x:c,y:d}}async doRefresh(){this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(e,t,r,i){return this.layer.fetchImage(e,t,r,{timeExtent:this.timeExtent,timestamp:this.refreshTimestamp,...i})}};e([r()],u.prototype,\"strategy\",void 0),e([r()],u.prototype,\"updating\",void 0),u=e([i(\"esri.views.2d.layers.WMSLayerView2D\")],u);var y=u;export default y;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{WGLDrawPhase as e}from\"./webgl/enums.js\";import{brushes as r}from\"./brushes.js\";import s from\"./webgl/WGLContainer.js\";class t extends s{get requiresDedicatedFBO(){return this.children.some((e=>\"additive\"===e.blendFunction))}prepareRenderPasses(s){const t=s.registerRenderPass({name:\"bitmap\",brushes:[r.bitmap],target:()=>this.children,drawPhase:e.MAP});return[...super.prepareRenderPasses(s),t]}}export{t as BitmapContainer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import t from\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import i from\"../../core/Accessor.js\";import o from\"../../core/Evented.js\";import{IdentifiableMixin as l}from\"../../core/Identifiable.js\";import{EsriPromiseMixin as n}from\"../../core/Promise.js\";import{HandleOwnerMixin as a}from\"../../core/HandleOwner.js\";let p=class extends(a(l(n(o.EventedMixin(i))))){constructor(e){super(e),this.layer=null,this.parent=null}initialize(){this.when().catch((e=>{if(\"layerview:create-error\"!==e.name){const r=this.layer&&this.layer.id||\"no id\",s=this.layer&&this.layer.title||\"no title\";throw t.getLogger(this.declaredClass).error(\"#resolve()\",`Failed to resolve layer view (layer title: '${s}', id: '${r}')`,e),e}}))}get fullOpacity(){const e=e=>null==e?1:e;return e(this.get(\"layer.opacity\"))*e(this.get(\"parent.fullOpacity\"))}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer.legendEnabled}get updating(){return!!(this.updatingHandles&&this.updatingHandles.updating||this.isUpdating())}get visible(){return!0===this.get(\"layer.visible\")}set visible(e){void 0!==e?this._override(\"visible\",e):this._clearOverride(\"visible\")}canResume(){return!this.get(\"parent.suspended\")&&this.get(\"view.ready\")&&this.get(\"layer.loaded\")&&this.visible||!1}getSuspendInfo(){const e=this.parent&&this.parent.suspended?this.parent.suspendInfo:{},t=this;return t.view&&t.view.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0),this.visible||(e.layerInvisible=!0),e}isUpdating(){return!1}};e([r()],p.prototype,\"fullOpacity\",null),e([r()],p.prototype,\"layer\",void 0),e([r()],p.prototype,\"parent\",void 0),e([r({readOnly:!0})],p.prototype,\"suspended\",null),e([r({readOnly:!0})],p.prototype,\"suspendInfo\",null),e([r({readOnly:!0})],p.prototype,\"legendEnabled\",null),e([r({type:Boolean,readOnly:!0})],p.prototype,\"updating\",null),e([r()],p.prototype,\"visible\",null),p=e([s(\"esri.views.layers.LayerView\")],p);var d=p;export default d;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../chunks/tslib.es6.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/accessorSupport/decorators/property.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import{JSONSupport as s}from\"../../../core/JSONSupport.js\";let e=class extends s{};e=r([o(\"esri.views.layers.support.ClipArea\")],e);var p=e;export default p;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as r}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import e from\"./ClipArea.js\";var s;let i=s=class extends e{constructor(){super(...arguments),this.type=\"rect\",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new s({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}get version(){return(this._get(\"version\")||0)+1}};t([r({type:[Number,String],json:{write:!0}})],i.prototype,\"left\",void 0),t([r({type:[Number,String],json:{write:!0}})],i.prototype,\"right\",void 0),t([r({type:[Number,String],json:{write:!0}})],i.prototype,\"top\",void 0),t([r({type:[Number,String],json:{write:!0}})],i.prototype,\"bottom\",void 0),t([r({readOnly:!0})],i.prototype,\"version\",null),i=s=t([o(\"esri.views.layers.support.ClipRect\")],i);var p=i;export default p;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../chunks/tslib.es6.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as e}from\"../../../core/accessorSupport/decorators/subclass.js\";import\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import t from\"../../../geometry/Geometry.js\";import s from\"../../../geometry/Extent.js\";import p from\"../../../geometry/Polygon.js\";import{fromJSON as m}from\"../../../geometry/support/jsonUtils.js\";import\"../../../geometry.js\";import i from\"./ClipArea.js\";var y;const c={base:t,key:\"type\",typeMap:{extent:s,polygon:p}};let n=y=class extends i{constructor(){super(...arguments),this.type=\"geometry\",this.geometry=null}get version(){return(this._get(\"version\")||0)+1}clone(){return new y({geometry:this.geometry.clone()})}};r([o({types:c,json:{read:m,write:!0}})],n.prototype,\"geometry\",void 0),r([o({readOnly:!0})],n.prototype,\"version\",null),n=y=r([e(\"esri.views.layers.support.Geometry\")],n);var l=n;export default l;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../chunks/tslib.es6.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as s}from\"../../../core/accessorSupport/decorators/subclass.js\";import\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import t from\"./ClipArea.js\";let e=class extends t{constructor(){super(...arguments),this.type=\"path\",this.path=[]}get version(){return(this._get(\"version\")||0)+1}};r([o({type:[[[Number]]],json:{write:!0}})],e.prototype,\"path\",void 0),r([o({readOnly:!0})],e.prototype,\"version\",null),e=r([s(\"esri.views.layers.support.Path\")],e);var p=e;export default p;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as e}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as s}from\"../../../core/accessorSupport/decorators/subclass.js\";import\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import i from\"../../../core/Collection.js\";import{referenceSetter as r}from\"../../../core/collectionUtils.js\";import{init as o}from\"../../../core/watchUtils.js\";import a from\"../../layers/support/ClipArea.js\";import p from\"../../layers/support/ClipRect.js\";import{Container as h}from\"../engine/Container.js\";import n from\"../../layers/support/Geometry.js\";import d from\"../../layers/support/Path.js\";const c=i.ofType({key:\"type\",base:a,typeMap:{rect:p,path:d,geometry:n}}),l=i=>{let a=class extends i{constructor(){super(...arguments),this.clips=new c,this.moving=!1,this.attached=!1,this.lastUpdateId=-1,this.updateRequested=!1}initialize(){var t;this.container||(this.container=new h),this.container.fadeTransitionEnabled=!0,this.container.opacity=0,this.container.clips=this.clips,this.handles.add([o(this,\"suspended\",(t=>{this.container&&(this.container.visible=!t),this.view&&!t&&this.updateRequested&&this.view.requestUpdate()}),!0),o(this,[\"layer.opacity\",\"container\"],(()=>{var t,e;this.container&&(this.container.opacity=null!=(t=null==(e=this.layer)?void 0:e.opacity)?t:1)}),!0),o(this,[\"layer.blendMode\"],(t=>{this.container&&(this.container.blendMode=t)}),!0),o(this,[\"layer.effect\"],(t=>{this.container&&(this.container.effect=t)}),!0),this.clips.on(\"change\",(()=>{this.container.clips=this.clips,this.notifyChange(\"clips\")}))]),null!=(t=this.view)&&t.whenLayerView?this.view.whenLayerView(this.layer).then((t=>{t!==this||this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)}),(()=>{})):this.when().then((()=>{this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)}),(()=>{}))}destroy(){this.attached&&(this.detach(),this.attached=!1),this.handles.remove(\"initialize\"),this.updateRequested=!1}get updating(){return!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())}isVisibleAtScale(t){let e=!0;const s=this.layer,i=s.minScale,r=s.maxScale;if(null!=i&&null!=r){let s=!i,o=!r;!s&&t<=i&&(s=!0),!o&&t>=r&&(o=!0),e=s&&o}return e}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())}processUpdate(t){!this.isFulfilled()||this.isResolved()?(this._set(\"updateParameters\",t),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(t))):this.updateRequested=!1}isUpdating(){return!1}isRendering(){return!1}canResume(){return!!super.canResume()&&this.isVisibleAtScale(this.view.scale)}};return t([e({type:c,set(t){const e=r(t,this._get(\"clips\"),c);this._set(\"clips\",e)}})],a.prototype,\"clips\",void 0),t([e()],a.prototype,\"moving\",void 0),t([e()],a.prototype,\"attached\",void 0),t([e()],a.prototype,\"container\",void 0),t([e()],a.prototype,\"suspended\",void 0),t([e({readOnly:!0})],a.prototype,\"updateParameters\",void 0),t([e()],a.prototype,\"updateRequested\",void 0),t([e()],a.prototype,\"updating\",null),t([e()],a.prototype,\"view\",void 0),a=t([s(\"esri.views.2d.layers.LayerView2D\")],a),a};export{l as LayerView2DMixin};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nclass e{constructor(e,t,i){this.pixelBlock=e,this.extent=t,this.originalPixelBlock=i}get width(){return this.pixelBlock?this.pixelBlock.width:0}get height(){return this.pixelBlock?this.pixelBlock.height:0}render(e){const t=this.pixelBlock;if(!t)return;const i=this.filter({pixelBlock:t}),l=i.pixelBlock.getAsRGBA(),h=e.createImageData(i.pixelBlock.width,i.pixelBlock.height);h.data.set(l),e.putImageData(h,0,0)}getRenderedRasterPixels(){const e=this.filter({pixelBlock:this.pixelBlock});return{width:e.pixelBlock.width,height:e.pixelBlock.height,renderedRasterPixels:new Uint8Array(e.pixelBlock.getAsRGBA().buffer)}}}export default e;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../../core/maybe.js\";import t from\"../../../../core/Logger.js\";import r from\"../../../../core/Error.js\";import o from\"../../../../layers/graphics/OptimizedGeometry.js\";import{convertFromNestedArray as n,convertFromPolygon as s}from\"../../../../layers/graphics/featureConversionUtils.js\";import{a as c}from\"../../../../chunks/vec2f64.js\";import{earcut as i}from\"../../../../core/libs/earcut/earcut.js\";import{s as a}from\"../../../../chunks/vec2.js\";import f from\"../../../webgl/BufferObject.js\";import{i1616to32 as h}from\"./number.js\";const m=t.getLogger(\"esri.views.2d.engine.webgl.Mesh2D\"),u=e=>{switch(e.BYTES_PER_ELEMENT){case 1:return 5121;case 2:return 5123;case 4:return 5125;default:throw new r(\"Cannot get DataType of array\")}},y=(e,t,r,o)=>{let n=0;for(let s=1;s<r;s++){const r=e[2*(t+s-1)],o=e[2*(t+s-1)+1];n+=(e[2*(t+s)]-r)*(e[2*(t+s)+1]+o)}return o?n>0:n<0},x=({coords:e,lengths:t},r)=>{const o=[];for(let n=0,s=0;n<t.length;s+=t[n],n+=1){const c=s,a=[];for(;n<t.length-1&&y(e,s+t[n],t[n+1],r);n+=1,s+=t[n])a.push(s+t[n]-c);const f=e.slice(2*c,2*(s+t[n])),h=i(f,a,2);for(const e of h)o.push(e+c)}return o};class g{constructor(e,t,r,o=!1){this._cache={},this.vertices=e,this.indices=t,this.primitiveType=r,this.isMapSpace=o}static fromRect({x:e,y:t,width:r,height:o}){const n=e,s=t,c=n+r,i=s+o;return g.fromScreenExtent({xmin:n,ymin:s,xmax:c,ymax:i})}static fromPath(e){const t=n(new o,e.path,!1,!1),r=t.coords,s=new Uint32Array(x(t,!0)),c=new Uint32Array(r.length/2);for(let o=0;o<c.length;o++)c[o]=h(Math.floor(r[2*o]),Math.floor(r[2*o+1]));return new g({geometry:c},s,4)}static fromGeometry(e,t){const o=t.geometry.type;switch(o){case\"polygon\":return g.fromPolygon(e,t.geometry);case\"extent\":return g.fromMapExtent(e,t.geometry);default:return m.error(new r(\"mapview-bad-type\",`Unable to create a mesh from type ${o}`,t)),g.fromRect({x:0,y:0,width:1,height:1})}}static fromPolygon(e,t){const r=s(new o,t,!1,!1),n=r.coords,i=new Uint32Array(x(r,!1)),f=new Uint32Array(n.length/2),m=c(),u=c();for(let o=0;o<f.length;o++)a(m,n[2*o],n[2*o+1]),e.toScreen(u,m),f[o]=h(Math.floor(u[0]),Math.floor(u[1]));return new g({geometry:f},i,4,!0)}static fromScreenExtent({xmin:e,xmax:t,ymin:r,ymax:o}){const n={geometry:new Uint32Array([h(e,r),h(t,r),h(e,o),h(e,o),h(t,r),h(t,o)])},s=new Uint32Array([0,1,2,3,4,5]);return new g(n,s,4)}static fromMapExtent(e,t){const[r,o]=e.toScreen([0,0],[t.xmin,t.ymin]),[n,s]=e.toScreen([0,0],[t.xmax,t.ymax]),c={geometry:new Uint32Array([h(r,o),h(n,o),h(r,s),h(r,s),h(n,o),h(n,s)])},i=new Uint32Array([0,1,2,3,4,5]);return new g(c,i,4)}destroy(){e(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(const t in this._cache.vertexBuffers)e(this._cache.vertexBuffers[t])&&this._cache.vertexBuffers[t].dispose()}get elementType(){return u(this.indices)}getIndexBuffer(e,t=35044){return this._cache.indexBuffer||(this._cache.indexBuffer=f.createIndex(e,t,this.indices)),this._cache.indexBuffer}getVertexBuffers(e,t=35044){return this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce(((r,o)=>({...r,[o]:f.createVertex(e,t,this.vertices[o])})),{})),this._cache.vertexBuffers}}export default g;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{isSome as t,isNone as e}from\"../../../../core/maybe.js\";import r from\"../../../../core/Logger.js\";import s from\"../../../../core/Error.js\";import i from\"../../../webgl/VertexArrayObject.js\";import{DisplayObject as h}from\"../DisplayObject.js\";import o from\"./Mesh2D.js\";const a=r.getLogger(\"esri.views.2d.engine.webgl.ClippingInfo\"),c=t=>parseFloat(t)/100;class n extends h{constructor(t,e){super(),this._clip=e,this._cache={},this.stage=t,this._handle=e.watch(\"version\",(()=>this._invalidate())),this.ready()}static fromClipArea(t,e){return new n(t,e)}_destroyGL(){t(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null),t(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)}destroy(){this._destroyGL(),this._handle.remove()}getVAO(t,r,s,h){const[o,a]=r.size;if(\"geometry\"!==this._clip.type&&this._lastWidth===o&&this._lastHeight===a||(this._lastWidth=o,this._lastHeight=a,this._destroyGL()),e(this._cache.vao)){const e=this._createMesh(r,this._clip),o=e.getIndexBuffer(t),a=e.getVertexBuffers(t);this._cache.mesh=e,this._cache.vao=new i(t,s,h,a,o)}return this._cache.vao}_invalidate(){this._destroyGL(),this.requestRender()}_createScreenRect(t,e){const[r,s]=t.size,i=\"string\"==typeof e.left?c(e.left)*r:e.left,h=\"string\"==typeof e.right?c(e.right)*r:e.right,o=\"string\"==typeof e.top?c(e.top)*s:e.top,a=\"string\"==typeof e.bottom?c(e.bottom)*s:e.bottom,n=i,p=o;return{x:n,y:p,width:Math.max(r-h-n,0),height:Math.max(s-a-p,0)}}_createMesh(t,e){switch(e.type){case\"rect\":return o.fromRect(this._createScreenRect(t,e));case\"path\":return o.fromPath(e);case\"geometry\":return o.fromGeometry(t,e);default:return a.error(new s(\"mapview-bad-type\",\"Unable to create ClippingInfo mesh from clip of type: ${clip.type}\")),o.fromRect({x:0,y:0,width:1,height:1})}}}export default n;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport\"../../../../core/has.js\";import{isNone as e,isSome as r}from\"../../../../core/maybe.js\";import{WGLDrawPhase as s}from\"./enums.js\";import{Container as t}from\"../Container.js\";import{brushes as i}from\"../brushes.js\";import n from\"./ClippingInfo.js\";class o extends t{constructor(){super(...arguments),this.name=this.constructor.name}set clips(e){this._clips=e,this.children.forEach((r=>r.clips=e)),this._updateClippingInfo()}doRender(e){const r=this.createRenderParams(e),{painter:t,globalOpacity:i,profiler:n,drawPhase:o}=r,a=o===s.LABEL?1:i*this.computedOpacity;n.recordContainerStart(this.name),t.beforeRenderLayer(r,this._clippingInfos?255:0,a),this.updateTransforms(e.state),this.renderChildren(r),t.compositeLayer(r,a),n.recordContainerEnd()}renderChildren(r){e(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(r.painter));for(const e of this.children)e.beforeRender(r);for(const e of this._renderPasses)try{e.render(r)}catch(s){}for(const e of this.children)e.afterRender(r)}createRenderParams(e){return{...e,requireFBO:this.requiresDedicatedFBO}}prepareRenderPasses(e){return[e.registerRenderPass({name:\"clip\",brushes:[i.clip],target:()=>this._clippingInfos,drawPhase:s.MAP|s.LABEL|s.LABEL_ALPHA|s.DEBUG|s.HIGHLIGHT})]}updateTransforms(e){for(const r of this.children)r.setTransform(e)}onAttach(){super.onAttach(),this._updateClippingInfo()}onDetach(){super.onDetach(),this._updateClippingInfo()}_updateClippingInfo(){if(r(this._clippingInfos)&&(this._clippingInfos.forEach((e=>e.destroy())),this._clippingInfos=null),!this.stage)return;const e=this._clips;r(e)&&e.length&&(this._clippingInfos=e.items.map((e=>n.fromClipArea(this.stage,e)))),this.requestRender()}}export default o;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import o from\"../../core/Error.js\";import\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import{combinedViewLayerTimeExtentProperty as s}from\"../../layers/support/commonProperties.js\";import{ExportWMSImageParameters as p}from\"../../layers/support/ExportWMSImageParameters.js\";const i=i=>{let a=class extends i{initialize(){this.exportImageParameters=new p({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get exportImageVersion(){var e;return null==(e=this.exportImageParameters)||e.commitProperty(\"version\"),this.commitProperty(\"timeExtent\"),(this._get(\"exportImageVersion\")||0)+1}fetchPopupFeatures(e){const{layer:r}=this;if(!e)return Promise.reject(new o(\"wmslayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:r}));const{popupEnabled:t}=r;if(!t)return Promise.reject(new o(\"wmslayerview:fetchPopupFeatures\",\"popupEnabled should be true\",{popupEnabled:t}));const s=this.createFetchPopupFeaturesQuery(e);if(!s)return Promise.resolve([]);const{extent:p,width:i,height:a,x:m,y:n}=s;if(!(p&&i&&a))throw new o(\"wmslayerview:fetchPopupFeatures\",\"WMSLayer does not support fetching features.\",{extent:p,width:i,height:a});const u=r.fetchFeatureInfo(p,i,a,m,n);return Promise.resolve(u?[u]:[])}};return e([r()],a.prototype,\"exportImageParameters\",void 0),e([r({readOnly:!0})],a.prototype,\"exportImageVersion\",null),e([r()],a.prototype,\"layer\",void 0),e([r(s)],a.prototype,\"timeExtent\",void 0),a=e([t(\"esri.layers.mixins.WMSLayerView\")],a),a};export default i;export{i as WMSLayerView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import t from\"../../core/Accessor.js\";import{HandleOwnerMixin as o}from\"../../core/HandleOwner.js\";const a={visible:\"visibleSublayers\"};let l=class extends(o(t)){constructor(e){super(e),this.scale=0}set layer(e){this._get(\"layer\")!==e&&(this._set(\"layer\",e),this.handles.remove(\"layer\"),e&&this.handles.add([e.sublayers.on(\"change\",(()=>this.notifyChange(\"visibleSublayers\"))),e.on(\"wms-sublayer-update\",(e=>this.notifyChange(a[e.propertyName])))],\"layer\"))}get layers(){const{visibleSublayers:e}=this;return e.filter((e=>e.name)).map((e=>e.name)).join(\",\")}get version(){this.commitProperty(\"layers\");const e=this.layer;return e&&e.commitProperty(\"imageTransparency\"),(this._get(\"version\")||0)+1}get visibleSublayers(){const{layer:e,scale:r}=this,s=null==e?void 0:e.sublayers,t=[],o=e=>{const{minScale:s,maxScale:a,sublayers:l,visible:i}=e;i&&(0===r||(0===s||r<=s)&&(0===a||r>=a))&&(l?l.forEach(o):t.unshift(e))};return null==s||s.forEach(o),t}toJSON(){const{layer:e,layers:r}=this,{imageFormat:s,imageTransparency:t,version:o}=e;return{format:s,request:\"GetMap\",service:\"WMS\",styles:\"\",transparent:t,version:o,layers:r}}};e([r()],l.prototype,\"layer\",null),e([r({readOnly:!0})],l.prototype,\"layers\",null),e([r({type:Number})],l.prototype,\"scale\",void 0),e([r({readOnly:!0})],l.prototype,\"version\",null),e([r({readOnly:!0})],l.prototype,\"visibleSublayers\",null),l=e([s(\"esri.layers.support.ExportWMSImageParameters\")],l);export{l as ExportWMSImageParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nconst t=Math.PI/180;function n(n){return n*t}function o(t,n,o){const{resolution:r,size:u}=o;return t[0]=r*(Math.round(n[0]/r)+u[0]%2*.5),t[1]=r*(Math.round(n[1]/r)+u[1]%2*.5),t}function r(t,o){const r=n(o.rotation),u=Math.abs(Math.cos(r)),a=Math.abs(Math.sin(r)),[s,c]=o.size;return t[0]=Math.round(c*a+s*u),t[1]=Math.round(c*u+s*a),t}function u(t,n,o,r){const[u,a]=n,[s,c]=r,i=.5*o;return t[0]=u-i*s,t[1]=a-i*c,t[2]=u+i*s,t[3]=a+i*c,t}function a(t,n){const[o,r,u,a]=t,[s,c,i,e]=n;return!(o>i||u<s||r>e||a<c)}export{a as bboxIntersects,u as getBBox,r as getOuterSize,o as snapToPixel};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import\"../../../../core/has.js\";import\"../../../../core/Logger.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{property as e}from\"../../../../core/accessorSupport/decorators/property.js\";import{subclass as i}from\"../../../../core/accessorSupport/decorators/subclass.js\";import\"../../../../core/urlUtils.js\";import\"../../../../core/uuid.js\";import\"../../../../portal/support/resourceExtension.js\";import{debounce as o}from\"../../../../core/promiseUtils.js\";import r from\"../../../../core/Accessor.js\";import{getInfo as s}from\"../../../../geometry/support/spatialReferenceUtils.js\";import a from\"../../../../geometry/Extent.js\";import{create as p}from\"../../../../geometry/support/aaBoundingRect.js\";import n from\"../../../../layers/support/TileInfo.js\";import m from\"../../tiling/TileKey.js\";import l from\"../../tiling/TileInfoView.js\";import{getOuterSize as h,getBBox as d}from\"../../viewStateUtils.js\";import{Bitmap as c}from\"../../engine/Bitmap.js\";const u=p(),g=[0,0],f=new m(0,0,0,0),x={container:null,fetchSource:null,requestUpdate:null,imageMaxWidth:2048,imageMaxHeight:2048,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1};let y=class extends r{constructor(t){super(t),this._imagePromise=null,this.hidpi=x.hidpi,this.imageMaxWidth=x.imageMaxWidth,this.imageMaxHeight=x.imageMaxHeight,this.imageRotationSupported=x.imageRotationSupported,this.imageNormalizationSupported=x.imageNormalizationSupported,this.update=o((async(t,e)=>{const i=t.state,o=s(i.spatialReference),r=this.hidpi?t.pixelRatio:1;if(!t.stationary||this.destroyed)return null;this.imageRotationSupported?(g[0]=i.size[0],g[1]=i.size[1]):h(g,i);const a=Math.floor(g[0]*r)>this.imageMaxWidth||Math.floor(g[1]*r)>this.imageMaxHeight,p=o&&(i.extent.xmin<o.valid[0]||i.extent.xmax>o.valid[1]),n=!this.imageNormalizationSupported&&p,m=!a&&!n,l=this.imageRotationSupported?i.rotation:0;if(m)this._imagePromise=this._singleExport(i,g,l,r,e);else{let t=Math.min(this.imageMaxWidth,this.imageMaxHeight);n&&(t=Math.min(i.worldScreenWidth,t)),this._imagePromise=this._tiledExport(i,t,l,r,e)}return this._imagePromise.then((async t=>{if(this._imagePromise=null,!this.destroyed){for(const e of this.container.children)t.includes(e)||e.fadeOut().then((()=>{e.remove()}));for(const e of t)this.container.addChild(e),e.fadeIn()}})).catch((t=>{throw this._imagePromise=null,t}))}),5e3)}destroy(){}get updating(){return null!==this._imagePromise}updateExports(t){for(const e of this.container.children){if(!e.visible||!e.stage)return;t(e)?console.error(\"ExportStrategy.updateExports doesn't support promise yet\"):(e.invalidateTexture(),e.requestRender())}}_export(t,e,i,o,r,s){return Promise.resolve().then((()=>this.fetchSource(t,Math.floor(e*r),Math.floor(i*r),{rotation:o,pixelRatio:r,signal:s}))).then((i=>{const s=new c(i,\"additive\");return s.x=t.xmin,s.y=t.ymax,s.resolution=t.width/e,s.rotation=o,s.pixelRatio=r,s}))}_singleExport(t,e,i,o,r){d(u,t.center,t.resolution,e);const s=new a(u[0],u[1],u[2],u[3],t.spatialReference);return this._export(s,e[0],e[1],i,o,r).then((t=>[t]))}_tiledExport(t,e,i,o,r){const s=n.create({size:e,spatialReference:t.spatialReference,scales:[t.scale]}),p=new l(s),m=p.getTileCoverage(t);if(!m)return null;const h=[];return m.forEach(((s,n,m,l)=>{f.set(s,n,m,l),p.getTileBounds(u,f);const d=new a(u[0],u[1],u[2],u[3],t.spatialReference);h.push(this._export(d,e,e,i,o,r))})),Promise.all(h)}};t([e()],y.prototype,\"_imagePromise\",void 0),t([e()],y.prototype,\"container\",void 0),t([e()],y.prototype,\"fetchSource\",void 0),t([e()],y.prototype,\"hidpi\",void 0),t([e()],y.prototype,\"imageMaxWidth\",void 0),t([e()],y.prototype,\"imageMaxHeight\",void 0),t([e()],y.prototype,\"imageRotationSupported\",void 0),t([e()],y.prototype,\"imageNormalizationSupported\",void 0),t([e()],y.prototype,\"requestUpdate\",void 0),t([e()],y.prototype,\"updating\",null),y=t([i(\"esri.views.2d.layers.support.ExportStrategy\")],y);var S=y;export default S;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport\"../../../core/has.js\";import{i as t,a as e,r as i,j as s,m as r}from\"../../../chunks/mat3.js\";import{c as h}from\"../../../chunks/mat3f32.js\";import{f as n}from\"../../../chunks/vec2f32.js\";import\"../../../chunks/builtins.js\";import\"../../webgl/checkWebGLError.js\";import o from\"../../webgl/Texture.js\";import\"../../webgl/FramebufferObject.js\";import{DisplayObject as u}from\"./DisplayObject.js\";import a from\"./ImageryBitmapSource.js\";function d(t){return t&&\"render\"in t}function c(t){return t&&!(\"render\"in t)}function l(t){const e=document.createElement(\"canvas\");return e.width=t.width,e.height=t.height,t.render(e.getContext(\"2d\")),e}function x(t,e,i){const s={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};return e&&i&&(s.width=e,s.height=i),new o(t,s)}class _ extends u{constructor(t=null,e,i=!0){super(),this.requestRenderOnSourceChangedEnabled=i,this._textureInvalidated=!0,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.transforms={dvs:h()},this.blendFunction=e,this.source=t,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null)}get isSourceScaled(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}get height(){return void 0!==this._height?this._height:this.sourceHeight}set height(t){this._height=t}get source(){return this._source}set source(t){this._source=t,this.invalidateTexture()}get sourceHeight(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}get sourceWidth(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}get width(){return void 0!==this._width?this._width:this.sourceWidth}set width(t){this._width=t}beforeRender(t){super.beforeRender(t),this.updateTexture(t)}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())}setTransform(h){const o=t(this.transforms.dvs),[u,a]=h.toScreenNoRotation([0,0],this.x,this.y),d=this.resolution/this.pixelRatio/h.resolution,c=d*this.width,l=d*this.height,x=Math.PI*this.rotation/180;e(o,o,n(u,a)),e(o,o,n(c/2,l/2)),i(o,o,-x),e(o,o,n(-c/2,-l/2)),s(o,o,n(c,l)),r(this.transforms.dvs,h.displayViewMat3,o)}setSamplingProfile(t){this._texture&&(t.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(t.samplingMode))}bind({context:t},e){this._texture&&t.bindTexture(this._texture,e)}updateTexture({context:t}){var e;if(!this.stage)return null==(e=this._texture)||e.dispose(),void(this._texture=null);if(!this._textureInvalidated)return;this._textureInvalidated=!1,this._texture||(this.source?this._texture=x(t,this.sourceWidth,this.sourceHeight):this._texture=x(t));const i=this.source;if(i){if(this._texture.resize(this.sourceWidth,this.sourceHeight),d(i))if(i instanceof a){const t=i.getRenderedRasterPixels();this._texture.setData(t.renderedRasterPixels)}else this._texture.setData(l(i));else c(i)&&this._texture.setData(i);this.ready()}else this._texture.setData(null)}onAttach(){this.invalidateTexture()}onDetach(){this.invalidateTexture()}}export{_ as Bitmap};\n"],"sourceRoot":""}
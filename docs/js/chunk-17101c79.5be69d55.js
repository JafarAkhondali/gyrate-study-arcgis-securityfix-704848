(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17101c79"],{"018d":function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var s=i("7f83"),n=i("b2b2"),a=i("ae54");function o(e,t){return[e,t]}function r(e,t,i){return e[0]=t,e[1]=i,e}function h(e,t,i,s,n){return e[0]=t,e[1]=i,e[2]=s,e[3]=n,e}const l=new a["a"]("0/0/0/0");class c{constructor(e,t,i,s,n,a,o,r,h,l,c,u){this.level=e,this.resolution=t,this.scale=i,this.origin=s,this.first=n,this.last=a,this.size=o,this.norm=r,this.worldStart=h,this.worldEnd=l,this.worldSize=c,this.wrap=u}static create(e,t,i=null){const a=Object(s["e"])(e.spatialReference),h=t.origin||o(e.origin.x,e.origin.y),l=o(e.size[0]*t.resolution,e.size[1]*t.resolution),u=o(-1/0,-1/0),d=o(1/0,1/0),p=o(1/0,1/0);Object(n["l"])(i)&&(r(u,Math.max(0,Math.floor((i.xmin-h[0])/l[0])),Math.max(0,Math.floor((h[1]-i.ymax)/l[1]))),r(d,Math.max(0,Math.floor((i.xmax-h[0])/l[0])),Math.max(0,Math.floor((h[1]-i.ymin)/l[1]))),r(p,d[0]-u[0]+1,d[1]-u[1]+1));const{cols:m,rows:g}=t;let f,b,w,y;return!i&&m&&g&&(r(u,m[0],g[0]),r(d,m[1],g[1]),r(p,m[1]-m[0]+1,g[1]-g[0]+1)),e.isWrappable?(f=o(Math.ceil(Math.round((a.valid[1]-a.valid[0])/t.resolution)/e.size[0]),p[1]),b=o(Math.floor((a.origin[0]-h[0])/l[0]),u[1]),w=o(f[0]+b[0]-1,d[1]),y=!0):(b=u,w=d,f=p,y=!1),new c(t.level,t.resolution,t.scale,h,u,d,p,l,b,w,f,y)}normalizeCol(e){if(!this.wrap)return e;const t=this.worldSize[0];return e<0?t-1-Math.abs((e+1)%t):e%t}denormalizeCol(e,t){return this.wrap?this.worldSize[0]*t+e:e}getWorldForColumn(e){return this.wrap?Math.floor(e/this.worldSize[0]):0}getFirstColumnForWorld(e){return e*this.worldSize[0]+this.first[0]}getLastColumnForWorld(e){return e*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(e){return(e-this.origin[0])/this.norm[0]}getXForColumn(e){return this.origin[0]+e*this.norm[0]}getRowForY(e){return(this.origin[1]-e)/this.norm[1]}getYForRow(e){return this.origin[1]-e*this.norm[1]}getTileBounds(e,t,i=!1){l.set(t);const s=i?l.col:this.denormalizeCol(l.col,l.world),n=l.row;return h(e,this.getXForColumn(s),this.getYForRow(n+1),this.getXForColumn(s+1),this.getYForRow(n)),e}getTileCoords(e,t,i=!1){l.set(t);const s=i?l.col:this.denormalizeCol(l.col,l.world);return Array.isArray(e)?r(e,this.getXForColumn(s),this.getYForRow(l.row)):(e.x=this.getXForColumn(s),e.y=this.getYForRow(l.row)),e}}var u=i("ba6a");class d{constructor(e,t,i){this.row=e,this.colFrom=t,this.colTo=i}}const p=new a["a"]("0/0/0/0");class m{constructor(e,t,i,s,n,a,o,r){this.x=e,this.ymin=t,this.ymax=i,this.invM=s,this.leftAdjust=n,this.rightAdjust=a,this.leftBound=o,this.rightBound=r}static create(e,t){e[1]>t[1]&&([e,t]=[t,e]);const[i,s]=e,[n,a]=t,o=n-i,r=a-s,h=0!==r?o/r:0,l=(Math.ceil(s)-s)*h,c=(Math.floor(s)-s)*h;return new m(i,Math.floor(s),Math.ceil(a),h,o<0?l:c,o<0?c:l,o<0?n:i,o<0?i:n)}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}}const g=[[0,0],[0,0],[0,0],[0,0]],f=1e-6;class b{constructor(e,t=null){this.tileInfo=e,this.fullExtent=t,this.scales=[],this._lodInfos=null,this._infoByScale={},this._infoByLevel={};const i=e.lods.slice();i.sort((function(e,t){return t.scale-e.scale}));const s=this._lodInfos=i.map(i=>c.create(e,i,t));i.forEach((e,t)=>{this._infoByLevel[e.level]=s[t],this._infoByScale[e.scale]=s[t],this.scales[t]=e.scale},this),this._wrap=e.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(e){return this._infoByLevel["number"==typeof e?e:e.level]}getTileBounds(e,t,i=!1){p.set(t);const s=this._infoByLevel[p.level];return s?s.getTileBounds(e,p,i):e}getTileCoords(e,t,i=!1){p.set(t);const s=this._infoByLevel[p.level];return s?s.getTileCoords(e,p,i):e}getTileCoverage(e,t=192,i="closest"){const s="closest"===i?this.getClosestInfoForScale(e.scale):this.getSmallestInfoForScale(e.scale),n=u["a"].pool.acquire(s),a=this._wrap;let o,r,h,l=1/0,c=-1/0;const p=n.spans;g[0][0]=g[0][1]=g[1][1]=g[3][0]=-t,g[1][0]=g[2][0]=e.size[0]+t,g[2][1]=g[3][1]=e.size[1]+t;for(const u of g)e.toMap(u,u),u[0]=s.getColumnForX(u[0]),u[1]=s.getRowForY(u[1]);const f=[];let b=3;for(let u=0;u<4;u++){if(g[u][1]===g[b][1]){b=u;continue}const e=m.create(g[u],g[b]);l=Math.min(e.ymin,l),c=Math.max(e.ymax,c),void 0===f[e.ymin]&&(f[e.ymin]=[]),f[e.ymin].push(e),b=u}if(null==l||null==c||c-l>100)return null;let w=[];for(o=l;o<c;){null!=f[o]&&(w=w.concat(f[o])),r=1/0,h=-1/0;for(let e=w.length-1;e>=0;e--){const t=w[e];r=Math.min(r,t.getLeftCol()),h=Math.max(h,t.getRightCol())}if(r=Math.floor(r),h=Math.floor(h),o>=s.first[1]&&o<=s.last[1])if(a)if(s.size[0]<s.worldSize[0]){const e=Math.floor(h/s.worldSize[0]);for(let t=Math.floor(r/s.worldSize[0]);t<=e;t++)p.push(new d(o,Math.max(s.getFirstColumnForWorld(t),r),Math.min(s.getLastColumnForWorld(t),h)))}else p.push(new d(o,r,h));else r>s.last[0]||h<s.first[0]||(r=Math.max(r,s.first[0]),h=Math.min(h,s.last[0]),p.push(new d(o,r,h)));o+=1;for(let e=w.length-1;e>=0;e--){const t=w[e];t.ymax>=o?t.incrRow():w.splice(e,1)}}return n}getTileParentId(e){p.set(e);const t=this._infoByLevel[p.level],i=this._lodInfos.indexOf(t)-1;return i<0?null:(this._getTileIdAtLOD(p,this._lodInfos[i],p),p.id)}getTileResolution(e){const t=this._infoByLevel["object"==typeof e?e.level:e];return t?t.resolution:-1}getTileScale(e){const t=this._infoByLevel[e.level];return t?t.scale:-1}intersects(e,t){p.set(t);const i=this._infoByLevel[p.level],s=e.lodInfo;if(s.resolution>i.resolution){this._getTileIdAtLOD(p,s,p);const t=s.denormalizeCol(p.col,p.world);for(const i of e.spans)if(i.row===p.row&&i.colFrom<=t&&i.colTo>=t)return!0}if(s.resolution<i.resolution){const[t,n,a,o]=e.spans.reduce((e,t)=>(e[0]=Math.min(e[0],t.row),e[1]=Math.max(e[1],t.row),e[2]=Math.min(e[2],t.colFrom),e[3]=Math.max(e[3],t.colTo),e),[1/0,-1/0,1/0,-1/0]),r=i.denormalizeCol(p.col,p.world),h=s.getColumnForX(i.getXForColumn(r)),l=s.getRowForY(i.getYForRow(p.row)),c=s.getColumnForX(i.getXForColumn(r+1))-1,u=s.getRowForY(i.getYForRow(p.row+1))-1;return!(h>o||c<a||l>n||u<t)}const n=s.denormalizeCol(p.col,p.world);return e.spans.some(e=>e.row===p.row&&e.colFrom<=n&&e.colTo>=n)}normalizeBounds(e,t,i){if(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],this._wrap){const t=Object(s["e"])(this.tileInfo.spatialReference),n=-i*(t.valid[1]-t.valid[0]);e[0]+=n,e[2]+=n}return e}getSmallestInfoForScale(e){const t=this.scales;if(this._infoByScale[e])return this._infoByScale[e];if(e>t[0])return this._infoByScale[t[0]];for(let i=1;i<t.length-1;i++)if(e>t[i]+f)return this._infoByScale[t[i-1]];return this._infoByScale[t[t.length-1]]}getClosestInfoForScale(e){const t=this.scales;return this._infoByScale[e]||(e=t.reduce((t,i)=>Math.abs(i-e)<Math.abs(t-e)?i:t,t[0])),this._infoByScale[e]}scaleToLevel(e){const t=this.scales;if(this._infoByScale[e])return this._infoByScale[e].level;for(let i=t.length-1;i>=0;i--)if(e<t[i])return i===t.length-1?this._infoByScale[t[t.length-1]].level:this._infoByScale[t[i]].level+(t[i]-e)/(t[i]-t[i+1]);return this._infoByScale[t[0]].level}scaleToZoom(e){return this.tileInfo.scaleToZoom(e)}_getTileIdAtLOD(e,t,i){const s=this._infoByLevel[i.level];return e.set(i),t.resolution<s.resolution?null:(t.resolution===s.resolution||(e.level=t.level,e.col=Math.floor(i.col*s.resolution/t.resolution+.01),e.row=Math.floor(i.row*s.resolution/t.resolution+.01)),e)}}},"0554":function(e,t,i){"use strict";function s(e,t,i,s){const n=3*e,a=3*(i-e)-n,o=1-n-a,r=3*t,h=3*(s-t)-r,l=1-r-h;function c(e){return((o*e+a)*e+n)*e}function u(e){return((l*e+h)*e+r)*e}function d(e){return(3*o*e+2*a)*e+n}function p(e,t){let i,s,n,a,o,r;for(n=e,r=0;r<8;r++){if(a=c(n)-e,Math.abs(a)<t)return n;if(o=d(n),Math.abs(o)<1e-6)break;n-=a/o}if(i=0,s=1,n=e,n<i)return i;if(n>s)return s;for(;i<s;){if(a=c(n),Math.abs(a-e)<t)return n;e>a?i=n:s=n,n=.5*(s-i)+i}return n}return function(e,t=1e-6){return u(p(e,t))}}i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return s}));const n=/^cubic-bezier\((.*)\)/,a={};function o(e){let t=a[e]||null;if(!t){const i=n.exec(e);if(i){const e=i[1].split(",").map(e=>parseFloat(e.trim()));4!==e.length||e.some(e=>isNaN(e))||(t=s.apply(s,e))}}return t}a.ease=s(.25,.1,.25,1),a.linear=s(0,0,1,1),a.easeIn=a["ease-in"]=s(.42,0,1,1),a.easeOut=a["ease-out"]=s(0,0,.58,1),a.easeInOut=a["ease-in-out"]=s(.42,0,.58,1)},"07cd":function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var s=i("a4ee"),n=i("fc29"),a=i("59b2"),o=(i("b50f"),i("c120"),i("cea0"),i("d386")),r=i("3349"),h=i("b541");function l(e,t){return e.length=0,t.forEach(t=>e.push(t)),e}const c=new Set,u=[],d=new Map,p=[0,0];let m=class extends n["a"]{constructor(e){super(e),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){const{concurrency:e,process:t,strategy:i}=this;this._queue=new h["a"]({concurrency:e,process:(e,i)=>{const s=this._keyToItem.get(e);return t(s,{signal:i})},peeker:"scale-first"===i?e=>this._peekByScaleFirst(e):e=>this._peekByCenterFirst(e)})}destroy(){this.clear(),this._queue.destroy(),this._queue=null}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(e){const t="string"==typeof e?e:e.id;this._queue.abort(t)}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating")}has(e){return"string"==typeof e?this._keyToItem.has(e):this._keyToItem.has(e.id)}isOngoing(e){const t="string"==typeof e?e:e.id;return this.has(t)&&this._queue.isOngoing(t)}pause(){this._queue.pause()}push(e){const t=e.key.id;if(this._queue.has(t))return this._queue.get(t);const i=this._queue.push(t),s=()=>{this._keyToItem.delete(t),this.notifyChange("updating")};return this._keyToItem.set(t,e),i.then(s,s),this.notifyChange("updating"),i}reset(){this._queue.reset()}resume(){this._queue.resume()}_peekByScaleFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView;let i=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY;e.forEach(e=>{const t=this._keyToItem.get(e),n=this.tileInfoView.getTileScale(t.key);d.has(n)||(d.set(n,[]),i=Math.max(n,i),s=Math.min(n,s)),d.get(n).push(t.key),c.add(n)});let n=this.state.scale;d.has(n)||(l(u,c),u.sort((e,t)=>e-t),n=u.reduce((e,t)=>Math.abs(t-n)<Math.abs(e-n)?t:e,u[0])),n=Math.min(n,i),n=Math.max(n,s);const a=d.get(n),o=t.getClosestInfoForScale(n),r=o.getColumnForX(this.state.center[0]),h=o.getRowForY(this.state.center[1]);return a.sort((e,t)=>{const i=o.denormalizeCol(e.col,e.world),s=o.denormalizeCol(t.col,t.world);return Math.sqrt((r-i)*(r-i)+(h-e.row)*(h-e.row))-Math.sqrt((r-s)*(r-s)+(h-t.row)*(h-t.row))}),c.clear(),d.clear(),a[0].id}_peekByCenterFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView,i=this.state.center;let s=Number.POSITIVE_INFINITY,n=null;return e.forEach(e=>{const a=this._keyToItem.get(e);t.getTileCoords(p,a.key);const o=Object(r["b"])(p,i);o<s&&(s=o,n=a.key)}),n.id}};Object(s["a"])([Object(a["b"])({constructOnly:!0})],m.prototype,"concurrency",void 0),Object(s["a"])([Object(a["b"])({constructOnly:!0})],m.prototype,"process",void 0),Object(s["a"])([Object(a["b"])()],m.prototype,"state",void 0),Object(s["a"])([Object(a["b"])({constructOnly:!0})],m.prototype,"strategy",void 0),Object(s["a"])([Object(a["b"])({constructOnly:!0})],m.prototype,"tileInfoView",void 0),Object(s["a"])([Object(a["b"])({readOnly:!0})],m.prototype,"updating",null),m=Object(s["a"])([Object(o["a"])("esri.views.2d.tiling.TileQueue")],m);const g=m},"3e7b":function(e,t,i){"use strict";var s=i("a4ee"),n=i("fc29"),a=i("59b2"),o=(i("b50f"),i("c120"),i("cea0"),i("d386")),r=i("3349"),h=i("b541");function l(e,t){return e.length=0,t.forEach(t=>e.push(t)),e}const c=new Set,u=[],d=new Map,p=[0,0];let m=class extends n["a"]{constructor(e){super(e),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){const{concurrency:e,process:t}=this;this._queue=new h["a"]({concurrency:e,process:(e,i)=>{const s=this._keyToItem.get(e);return t(s,{signal:i})},peeker:e=>e.values().next().value})}destroy(){this.clear(),this._queue.destroy(),this._queue=null}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(e){const t="string"==typeof e?e:e.id;this._queue.abort(t)}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating")}has(e){return"string"==typeof e?this._keyToItem.has(e):this._keyToItem.has(e.id)}isOngoing(e){const t="string"==typeof e?e:e.id;return this.has(t)&&this._queue.isOngoing(t)}pause(){this._queue.pause()}push(e,t){const i=e.key.id+"-"+t;if(this.has(i))return this.get(i);const s=this._queue.push(i),n=()=>{this._keyToItem.delete(i),this.notifyChange("updating")};return this._keyToItem.set(i,e),s.then(n,n),this.notifyChange("updating"),s}reset(){this._queue.reset(),this.notifyChange("updating")}resume(){this._queue.resume()}_peekByScaleFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView;let i=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY;e.forEach(e=>{const t=this._keyToItem.get(e),n=this.tileInfoView.getTileScale(t.key);d.has(n)||(d.set(n,[]),i=Math.max(n,i),s=Math.min(n,s)),d.get(n).push(t.key),c.add(n)});let n=this.state.scale;d.has(n)||(l(u,c),u.sort((e,t)=>e-t),n=u.reduce((e,t)=>Math.abs(t-n)<Math.abs(e-n)?t:e,u[0])),n=Math.min(n,i),n=Math.max(n,s);const a=d.get(n),o=t.getClosestInfoForScale(n),r=o.getColumnForX(this.state.center[0]),h=o.getRowForY(this.state.center[1]);return a.sort((e,t)=>{const i=o.denormalizeCol(e.col,e.world),s=o.denormalizeCol(t.col,t.world);return Math.sqrt((r-i)*(r-i)+(h-e.row)*(h-e.row))-Math.sqrt((r-s)*(r-s)+(h-t.row)*(h-t.row))}),c.clear(),d.clear(),a[0].id}_peekByCenterFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView,i=this.state.center;let s=Number.POSITIVE_INFINITY,n=null;return e.forEach(e=>{const a=this._keyToItem.get(e);t.getTileCoords(p,a.key);const o=Object(r["b"])(p,i);o<s&&(s=o,n=a.key)}),n.id}};Object(s["a"])([Object(a["b"])({constructOnly:!0})],m.prototype,"concurrency",void 0),Object(s["a"])([Object(a["b"])({constructOnly:!0})],m.prototype,"process",void 0),Object(s["a"])([Object(a["b"])()],m.prototype,"state",void 0),Object(s["a"])([Object(a["b"])({constructOnly:!0})],m.prototype,"strategy",void 0),Object(s["a"])([Object(a["b"])({constructOnly:!0})],m.prototype,"tileInfoView",void 0),Object(s["a"])([Object(a["b"])({readOnly:!0})],m.prototype,"updating",null),m=Object(s["a"])([Object(o["a"])("esri.views.2d.tiling.PagedTileQueue")],m)},4637:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var s,n,a,o={exports:{}};s=o,n=function(){function e(e,i,n,a,o){t(e,i,n||0,a||e.length-1,o||s)}function t(e,s,n,a,o){for(;a>n;){if(a-n>600){var r=a-n+1,h=s-n+1,l=Math.log(r),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(r-c)/r)*(h-r/2<0?-1:1);t(e,s,Math.max(n,Math.floor(s-h*c/r+u)),Math.min(a,Math.floor(s+(r-h)*c/r+u)),o)}var d=e[s],p=n,m=a;for(i(e,n,s),o(e[a],d)>0&&i(e,n,a);p<m;){for(i(e,p,m),p++,m--;o(e[p],d)<0;)p++;for(;o(e[m],d)>0;)m--}0===o(e[n],d)?i(e,n,m):i(e,++m,a),m<=s&&(n=m+1),s<=m&&(a=m-1)}}function i(e,t,i){var s=e[t];e[t]=e[i],e[i]=s}function s(e,t){return e<t?-1:e>t?1:0}return e},void 0!==(a=n())&&(s.exports=a);const r=o.exports},"4a7a":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const s=e=>-1!==e.indexOf("Brush");class n{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),s(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark("Esri."+e))}}},"901f":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var s=i("4637");function n(e,t){if(!(this instanceof n))return new n(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this.toBBox=t:this._initFormat(t)),this.clear()}function a(e,t,i){if(!i)return t.indexOf(e);for(var s=0;s<t.length;s++)if(i(e,t[s]))return s;return-1}function o(e,t){r(e,0,e.children.length,t,e)}function r(e,t,i,s,n){n||(n=b(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var a,o=t;o<i;o++)a=e.children[o],h(n,e.leaf?s(a):a);return n}function h(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function l(e,t){return e.minX-t.minX}function c(e,t){return e.minY-t.minY}function u(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function d(e){return e.maxX-e.minX+(e.maxY-e.minY)}function p(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function m(e,t){var i=Math.max(e.minX,t.minX),s=Math.max(e.minY,t.minY),n=Math.min(e.maxX,t.maxX),a=Math.min(e.maxY,t.maxY);return Math.max(0,n-i)*Math.max(0,a-s)}function g(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function f(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function b(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function w(e,t,i,n,a){for(var o,r=[t,i];r.length;)(i=r.pop())-(t=r.pop())<=n||(o=t+Math.ceil((i-t)/n/2)*n,Object(s["a"])(e,o,t,i,a),r.push(t,o,o,i))}n.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,i=[],s=this.toBBox;if(!f(e,t))return i;for(var n,a,o,r,h=[];t;){for(n=0,a=t.children.length;n<a;n++)o=t.children[n],f(e,r=t.leaf?s(o):o)&&(t.leaf?i.push(o):g(e,r)?this._all(o,i):h.push(o));t=h.pop()}return i},collides:function(e){var t=this.data,i=this.toBBox;if(!f(e,t))return!1;for(var s,n,a,o,r=[];t;){for(s=0,n=t.children.length;s<n;s++)if(a=t.children[s],f(e,o=t.leaf?i(a):a)){if(t.leaf||g(e,o))return!0;r.push(a)}t=r.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,i=e.length;t<i;t++)this.insert(e[t]);return this}var s=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===s.height)this._splitRoot(this.data,s);else{if(this.data.height<s.height){var n=this.data;this.data=s,s=n}this._insert(s,this.data.height-s.height-1,!0)}else this.data=s;return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=b([]),this},remove:function(e,t){if(!e)return this;for(var i,s,n,o,r=this.data,h=this.toBBox(e),l=[],c=[];r||l.length;){if(r||(r=l.pop(),s=l[l.length-1],i=c.pop(),o=!0),r.leaf&&-1!==(n=a(e,r.children,t)))return r.children.splice(n,1),l.push(r),this._condense(l),this;o||r.leaf||!g(r,h)?s?(i++,r=s.children[i],o=!1):r=null:(l.push(r),c.push(i),i=0,s=r,r=r.children[0])}return this},toBBox:function(e){return e},compareMinX:l,compareMinY:c,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var i=[];e;)e.leaf?t.push.apply(t,e.children):i.push.apply(i,e.children),e=i.pop();return t},_build:function(e,t,i,s){var n,a=i-t+1,r=this._maxEntries;if(a<=r)return o(n=b(e.slice(t,i+1)),this.toBBox),n;s||(s=Math.ceil(Math.log(a)/Math.log(r)),r=Math.ceil(a/Math.pow(r,s-1))),(n=b([])).leaf=!1,n.height=s;var h,l,c,u,d=Math.ceil(a/r),p=d*Math.ceil(Math.sqrt(r));for(w(e,t,i,p,this.compareMinX),h=t;h<=i;h+=p)for(w(e,h,c=Math.min(h+p-1,i),d,this.compareMinY),l=h;l<=c;l+=d)u=Math.min(l+d-1,c),n.children.push(this._build(e,l,u,s-1));return o(n,this.toBBox),n},_chooseSubtree:function(e,t,i,s){for(var n,a,o,r,h,l,c,d;s.push(t),!t.leaf&&s.length-1!==i;){for(c=d=1/0,n=0,a=t.children.length;n<a;n++)h=u(o=t.children[n]),(l=p(e,o)-h)<d?(d=l,c=h<c?h:c,r=o):l===d&&h<c&&(c=h,r=o);t=r||t.children[0]}return t},_insert:function(e,t,i){var s=this.toBBox,n=i?e:s(e),a=[],o=this._chooseSubtree(n,this.data,t,a);for(o.children.push(e),h(o,n);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(n,a,t)},_split:function(e,t){var i=e[t],s=i.children.length,n=this._minEntries;this._chooseSplitAxis(i,n,s);var a=this._chooseSplitIndex(i,n,s),r=b(i.children.splice(a,i.children.length-a));r.height=i.height,r.leaf=i.leaf,o(i,this.toBBox),o(r,this.toBBox),t?e[t-1].children.push(r):this._splitRoot(i,r)},_splitRoot:function(e,t){this.data=b([e,t]),this.data.height=e.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,i){var s,n,a,o,h,l,c,d;for(l=c=1/0,s=t;s<=i-t;s++)o=m(n=r(e,0,s,this.toBBox),a=r(e,s,i,this.toBBox)),h=u(n)+u(a),o<l?(l=o,d=s,c=h<c?h:c):o===l&&h<c&&(c=h,d=s);return d},_chooseSplitAxis:function(e,t,i){var s=e.leaf?this.compareMinX:l,n=e.leaf?this.compareMinY:c;this._allDistMargin(e,t,i,s)<this._allDistMargin(e,t,i,n)&&e.children.sort(s)},_allDistMargin:function(e,t,i,s){e.children.sort(s);var n,a,o=this.toBBox,l=r(e,0,t,o),c=r(e,i-t,i,o),u=d(l)+d(c);for(n=t;n<i-t;n++)a=e.children[n],h(l,e.leaf?o(a):a),u+=d(l);for(n=i-t-1;n>=t;n--)a=e.children[n],h(c,e.leaf?o(a):a),u+=d(c);return u},_adjustParentBBoxes:function(e,t,i){for(var s=i;s>=0;s--)h(t[s],e)},_condense:function(e){for(var t,i=e.length-1;i>=0;i--)0===e[i].children.length?i>0?(t=e[i-1].children).splice(t.indexOf(e[i]),1):this.clear():o(e[i],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}},a611:function(e,t,i){"use strict";i.d(t,"a",(function(){return Tt}));var s=i("a4ee"),n=i("8d60"),a=i("2c4f"),o=i("4d10"),r=i("ce50"),h=i("c120"),l=i("fa2a"),c=i("e92d"),u=i("b2b2"),d=i("3795"),p=i("dfa0"),m=i("59b2"),g=(i("b50f"),i("cea0"),i("d386")),f=i("05a9"),b=i("7aa6"),w=(i("e06a"),i("cb72")),y=i("f4cc"),_=i("a915"),v=i("9786"),O=i("dff3"),j=i("de65"),x=i("535f"),k=i("f61d"),T=i("fc29"),M=i("5815"),S=i("0554"),I=i("a98b"),V=i("4ae5");class C{constructor(e,t,i,s){const n=e.targetGeometry,a=t.targetGeometry;s?"string"==typeof s&&(s=Object(S["b"])(s)||S["a"].ease):s=S["a"].ease,this.easing=s,this.duration=i,this.sCenterX=n.x,this.sCenterY=n.y,this.sScale=e.scale,this.sRotation=e.rotation,this.tCenterX=a.x,this.tCenterY=a.y,this.tScale=t.scale,this.tRotation=t.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360)}applyRatio(e,t){const i=this.easing(t);let s,n,a,o;t>=1?(s=this.tCenterX,n=this.tCenterY,a=this.tRotation,o=this.tScale):(s=this.sCenterX+i*this.dCenterX,n=this.sCenterY+i*this.dCenterY,a=this.sRotation+i*this.dRotation,o=this.sScale+i*this.dScale),e.targetGeometry.x=s,e.targetGeometry.y=n,e.scale=o,e.rotation=a}}let z=class extends T["a"]{constructor(e){super(e),this.duration=200,this.transition=null,this.easing=S["a"].ease,this.view=null,this.viewpoint=null,this.viewpoint=new w["a"]({targetGeometry:new V["a"],scale:0,rotation:0}),this._updateTask=Object(M["a"])({postRender:this._postRender.bind(this)}),this._updateTask.pause()}destroy(){this._updateTask.remove(),this._updateTask=null}animate(e,t,i){this.stop();const s=this.viewpoint;Object(I["d"])(s,t),this.transition=new C(this.viewpoint,e.target,i&&i.duration||this.duration,i&&i.easing||this.easing);const n=()=>{this.animation===e&&this._updateTask&&("finished"===e.state&&(this.transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(n,n),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinous(e,t){this.stop(),this.updateFunction=t,this.viewpoint=e;const i=new k["a"]({target:e.clone()}),s=()=>{this.animation===i&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return i.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=i,i}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){const t=this.animation;if(t&&t.state!==k["a"].State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime);else{const e=(performance.now()-this._startTime)/this.transition.duration,t=e>=1;this.transition.applyRatio(this.viewpoint,e),t&&this.animation.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};Object(s["a"])([Object(m["b"])()],z.prototype,"animation",void 0),Object(s["a"])([Object(m["b"])()],z.prototype,"duration",void 0),Object(s["a"])([Object(m["b"])()],z.prototype,"transition",void 0),Object(s["a"])([Object(m["b"])()],z.prototype,"easing",void 0),Object(s["a"])([Object(m["b"])()],z.prototype,"view",void 0),Object(s["a"])([Object(m["b"])()],z.prototype,"viewpoint",void 0),z=Object(s["a"])([Object(g["a"])("esri.views.2d.AnimationManager")],z);const P=z;class R{constructor(e){this.view=e,this._frameTaskHandle=null,this._updateRequested=!1,this.stationary=!0,this.updateEnabled=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions},this.update=()=>{if(this._updateRequested=!1,!this.updateEnabled)return;const{basemapView:e,graphicsView:t,labelManager:i,layerViews:s,state:{id:n}}=this.view;e.baseLayerViews.forEach(this._updateLayerView,this),s.forEach(this._updateLayerView,this),e.referenceLayerViews.forEach(this._updateLayerView,this),Object(u["l"])(i)&&(i.lastUpdateId!==n&&(i.viewChange(),i.lastUpdateId=n),i.updateRequested&&i.processUpdate(this._updateParameters)),Object(u["l"])(t)&&(t.lastUpdateId!==n&&(t.viewChange(),t.lastUpdateId=n),t.updateRequested&&t.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||this._frameTaskHandle.pause()}}destroy(){this.stop()}start(){this.stationary=this.view.stationary,this._updateParameters={state:this.view.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:this.view.renderingOptions},this._stationaryHandle=this.view.watch("stationary",e=>{this.stationary=e,this.requestFrame()}),this._frameTaskHandle=Object(M["a"])(this)}stop(){this._frameTaskHandle&&(this._stationaryHandle.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){const t=this.view.state,i=e.lastUpdateId;null!=i&&(this.stationary||e.moving)||(e.moving=!0,e.moveStart()),i!==t.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=t.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews.forEach(this._updateLayerView,this)}}function D(){return Promise.all([Promise.all([i.e("chunk-68ddeb1e"),i.e("chunk-70c316c0")]).then(i.bind(null,"b69b")),Promise.all([i.e("chunk-68ddeb1e"),i.e("chunk-93a83094"),i.e("chunk-5bee4ec9"),i.e("chunk-205026ce"),i.e("chunk-7395b133")]).then(i.bind(null,"b460"))])}const E=()=>D().then(()=>Promise.all([i.e("chunk-68ddeb1e"),i.e("chunk-93a83094"),i.e("chunk-5bee4ec9"),i.e("chunk-6a475288"),i.e("chunk-e854ea94")]).then(i.bind(null,"02b4"))),N=()=>D().then(()=>Promise.all([i.e("chunk-93a83094"),i.e("chunk-205026ce"),i.e("chunk-3f2b1731")]).then(i.bind(null,"189c6"))),L={"base-dynamic":()=>D().then(()=>Promise.all([i.e("chunk-68ddeb1e"),i.e("chunk-93a83094"),i.e("chunk-5bee4ec9"),i.e("chunk-cf8f17e2"),i.e("chunk-2d210a10")]).then(i.bind(null,"b969"))),"base-tile":E,"bing-maps":E,csv:N,"geo-rss":()=>D().then(()=>Promise.all([i.e("chunk-68ddeb1e"),i.e("chunk-93a83094"),i.e("chunk-5bee4ec9"),i.e("chunk-205026ce"),i.e("chunk-563b5cee")]).then(i.bind(null,"5319"))),feature:N,geojson:N,graphics:()=>D().then(()=>Promise.all([i.e("chunk-68ddeb1e"),i.e("chunk-93a83094"),i.e("chunk-5bee4ec9"),i.e("chunk-205026ce"),i.e("chunk-a850eaa6")]).then(i.bind(null,"c70f"))),group:()=>D().then(()=>Promise.all([i.e("chunk-68ddeb1e"),i.e("chunk-93a83094"),i.e("chunk-5bee4ec9"),i.e("chunk-611b16a5")]).then(i.bind(null,"d86a"))),imagery:()=>D().then(()=>Promise.all([i.e("chunk-68ddeb1e"),i.e("chunk-93a83094"),i.e("chunk-5bee4ec9"),i.e("chunk-205026ce"),i.e("chunk-15de587a")]).then(i.bind(null,"7f5c"))),"imagery-tile":()=>D().then(()=>Promise.all([i.e("chunk-68ddeb1e"),i.e("chunk-93a83094"),i.e("chunk-5bee4ec9"),i.e("chunk-ccd0dc52")]).then(i.bind(null,"aebc"))),kml:()=>D().then(()=>Promise.all([i.e("chunk-68ddeb1e"),i.e("chunk-93a83094"),i.e("chunk-5bee4ec9"),i.e("chunk-205026ce"),i.e("chunk-499788a8")]).then(i.bind(null,"a0ce"))),"map-image":()=>D().then(()=>Promise.all([i.e("chunk-68ddeb1e"),i.e("chunk-93a83094"),i.e("chunk-5bee4ec9"),i.e("chunk-205026ce"),i.e("chunk-db9be0b0")]).then(i.bind(null,"e818"))),"map-notes":()=>D().then(()=>Promise.all([i.e("chunk-68ddeb1e"),i.e("chunk-93a83094"),i.e("chunk-5bee4ec9"),i.e("chunk-205026ce"),i.e("chunk-7f037dcf")]).then(i.bind(null,"791a"))),"ogc-feature":()=>D().then(()=>Promise.all([i.e("chunk-93a83094"),i.e("chunk-205026ce"),i.e("chunk-3f2b1731"),i.e("chunk-02817b8c")]).then(i.bind(null,"6cbe"))),"open-street-map":E,route:()=>D().then(()=>Promise.all([i.e("chunk-68ddeb1e"),i.e("chunk-93a83094"),i.e("chunk-5bee4ec9"),i.e("chunk-205026ce"),i.e("chunk-64a69429")]).then(i.bind(null,"04b6"))),stream:()=>D().then(()=>Promise.all([i.e("chunk-93a83094"),i.e("chunk-205026ce"),i.e("chunk-3f2b1731"),i.e("chunk-2d237116")]).then(i.bind(null,"fa16"))),"subtype-group":()=>D().then(()=>Promise.all([i.e("chunk-93a83094"),i.e("chunk-205026ce"),i.e("chunk-3f2b1731"),i.e("chunk-2d0e62e7")]).then(i.bind(null,"983e"))),tile:E,"vector-tile":()=>D().then(()=>Promise.all([i.e("chunk-68ddeb1e"),i.e("chunk-93a83094"),i.e("chunk-5bee4ec9"),i.e("chunk-205026ce"),i.e("chunk-519208f8")]).then(i.bind(null,"46bf"))),wcs:()=>D().then(()=>Promise.all([i.e("chunk-68ddeb1e"),i.e("chunk-93a83094"),i.e("chunk-5bee4ec9"),i.e("chunk-ccd0dc52")]).then(i.bind(null,"aebc"))),"web-tile":E,wfs:N,wms:()=>D().then(()=>Promise.all([i.e("chunk-68ddeb1e"),i.e("chunk-93a83094"),i.e("chunk-5bee4ec9"),i.e("chunk-cf8f17e2"),i.e("chunk-12b6a992")]).then(i.bind(null,"2535"))),wmts:()=>D().then(()=>Promise.all([i.e("chunk-68ddeb1e"),i.e("chunk-93a83094"),i.e("chunk-5bee4ec9"),i.e("chunk-6a475288"),i.e("chunk-2d0bff4d")]).then(i.bind(null,"4072"))),analysis:null,"base-elevation":null,"building-scene":null,elevation:null,"integrated-mesh":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};function F(e){const t=e.declaredClass?e.declaredClass.slice(e.declaredClass.lastIndexOf(".")+1):"Unknown",i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new r["a"](i+":view-not-supported",t+" is not supported in 2D")}const B={hasLayerViewModule:e=>Object(u["l"])(L[e.type]),importLayerView:e=>{const t=L[e.type];if(!Object(u["l"])(t))throw F(e);return t(e)}};var q,Y=i("ce6d"),Z=i("50e6"),X=i("8188"),A=i("2172"),G=i("3349"),U=i("32ed");function K(e,t){const{spatialReference:i}=t,s=[t.x,t.y];let n=Number.POSITIVE_INFINITY,a=0,o=0;const r=[0,0],h="extent"===e.type?[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]:e.rings;for(const l of h)for(let e=0;e<l.length-1;e++){Object(U["h"])(r,s,l,e);const t=Object(G["b"])(s,r);t<n&&(n=t,a=r[0],o=r[1])}return{coordinate:new V["a"]({x:a,y:o,spatialReference:i}),distance:n}}const H=c["a"].getLogger("esri.views.MapView");let W=q=class extends T["a"]{constructor(e){super(e),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){return Object(u["k"])(this.geometry)||!this.spatialReference?null:this.spatialReference.equals(this.geometry.spatialReference)?this.geometry:Object(v["a"])(this.geometry,this.spatialReference)?Object(v["d"])(this.geometry,this.spatialReference):Object(X["h"])()?Object(X["m"])(this.geometry,this.spatialReference):(H.error("#constraints.geometry","unsupported coordinate system. The source geometry cannot be projected to the view's coordinate system. The projection engine cannot be loaded.",{geometry:this.geometry}),null)}constrain(e,t){if(Object(u["k"])(this.normalizedGeometry))return e;const i=e.targetGeometry;if("extent"===this.normalizedGeometry.type?Object(A["e"])(this.normalizedGeometry,i):Object(A["g"])(this.normalizedGeometry,i))return e;const{coordinate:s}=K(this.normalizedGeometry,i);return s?(e.targetGeometry=s,e):e}clone(){var e,t;return new q({geometry:null==(e=this.geometry)?void 0:e.clone(),spatialReference:null==(t=this.spatialReference)?void 0:t.clone()})}};var $;Object(s["a"])([Object(m["b"])({constructOnly:!0})],W.prototype,"geometry",void 0),Object(s["a"])([Object(m["b"])({readOnly:!0})],W.prototype,"normalizedGeometry",null),Object(s["a"])([Object(m["b"])({constructOnly:!0})],W.prototype,"spatialReference",void 0),W=q=Object(s["a"])([Object(g["a"])("esri.views.2d.constraints.GeometryConstraint")],W);let J=$=class extends T["a"]{constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(e,t){return this.enabled&&t?(this.rotationEnabled||(e.rotation=t.rotation),e):e}clone(){return new $({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};Object(s["a"])([Object(m["b"])()],J.prototype,"enabled",void 0),Object(s["a"])([Object(m["b"])()],J.prototype,"rotationEnabled",void 0),J=$=Object(s["a"])([Object(g["a"])("esri.views.2d.constraints.RotationConstraint")],J);const Q=J;var ee;let te=ee=class extends T["a"]{constructor(e){super(e),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let e,{lods:t,minScale:i,maxScale:s,minZoom:n,maxZoom:a}=this,o=-1,r=-1,h=!1,l=!1;if(0!==i&&0!==s&&i<s&&([i,s]=[s,i]),!t||!t.length)return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",s);t=t.map(e=>e.clone()),t.sort((e,t)=>t.scale-e.scale),t.forEach((e,t)=>e.level=t);for(const c of t)!h&&i>0&&i>=c.scale&&(o=c.level,h=!0),!l&&s>0&&s>=c.scale&&(r=e?e.level:-1,l=!0),e=c;-1===n&&(n=0===i?0:o),-1===a&&(a=0===s?t.length-1:r),n=Math.max(n,0),n=Math.min(n,t.length-1),a=Math.max(a,0),a=Math.min(a,t.length-1),n>a&&([n,a]=[a,n]),i=t[n].scale,s=t[a].scale,t.splice(0,n),t.splice(a-n+1,t.length),t.forEach((e,t)=>{this._lodByScale[e.scale]=e,this._scales[t]=e.scale}),this._set("effectiveLODs",t),this._set("effectiveMinZoom",n),this._set("effectiveMaxZoom",a),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",s)}constrain(e,t){if(t&&e.scale===t.scale)return e;const i=this.effectiveMinScale,s=this.effectiveMaxScale,n=e.targetGeometry,a=t&&t.targetGeometry,o=0!==s&&e.scale<s,r=0!==i&&e.scale>i;if(o||r){const o=r?i:s;if(a){const i=(o-t.scale)/(e.scale-t.scale);n.x=a.x+(n.x-a.x)*i,n.y=a.y+(n.y-a.y)*i}e.scale=o}return this.snapToZoom&&this.effectiveLODs&&(e.scale=this._getClosestScale(e.scale)),e}fit(e){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(e,null);const t=this.scaleToZoom(e.scale),i=Math.abs(t-Math.floor(t));return e.scale=this.zoomToScale(i>.99?Math.round(t):Math.floor(t)),e}zoomToScale(e){if(!this.effectiveLODs)return 0;e-=this.effectiveMinZoom,e=Math.max(0,e);const t=this._scales;if(e<=0)return t[0];if(e>=t.length)return t[t.length-1];const i=Math.round(e-.5),s=Math.round(e);return t[s]+(s-e)*(t[i]-t[s])}scaleToZoom(e){if(!this.effectiveLODs)return-1;const t=this._scales;let i,s;if(e>=t[0])return this.effectiveMinZoom;if(e<=t[t.length-1])return this.effectiveMaxZoom;for(let n=0;n<t.length-1;n++){if(i=t[n],s=t[n+1],s===e)return n+this.effectiveMinZoom+1;if(i>e&&s<e)return n+this.effectiveMinZoom+1-(e-s)/(i-s)}}snapToClosestScale(e){if(!this.effectiveLODs)return e;const t=this.scaleToZoom(e);return this.zoomToScale(Math.round(t))}snapToNextScale(e,t=.5){if(!this.effectiveLODs)return e*t;const i=Math.round(this.scaleToZoom(e));return this.zoomToScale(i+1)}snapToPreviousScale(e,t=2){if(!this.effectiveLODs)return e*t;const i=Math.round(this.scaleToZoom(e));return this.zoomToScale(i-1)}clone(){return new ee({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(e){return this._lodByScale[e]||(e=this._scales.reduce((t,i)=>Math.abs(i-e)<=Math.abs(t-e)?i:t,this._scales[0])),this._lodByScale[e].scale}};Object(s["a"])([Object(m["b"])({readOnly:!0})],te.prototype,"effectiveLODs",void 0),Object(s["a"])([Object(m["b"])({readOnly:!0})],te.prototype,"effectiveMinZoom",void 0),Object(s["a"])([Object(m["b"])({readOnly:!0})],te.prototype,"effectiveMaxZoom",void 0),Object(s["a"])([Object(m["b"])({readOnly:!0})],te.prototype,"effectiveMinScale",void 0),Object(s["a"])([Object(m["b"])({readOnly:!0})],te.prototype,"effectiveMaxScale",void 0),Object(s["a"])([Object(m["b"])()],te.prototype,"lods",void 0),Object(s["a"])([Object(m["b"])()],te.prototype,"minZoom",void 0),Object(s["a"])([Object(m["b"])()],te.prototype,"maxZoom",void 0),Object(s["a"])([Object(m["b"])()],te.prototype,"minScale",void 0),Object(s["a"])([Object(m["b"])()],te.prototype,"maxScale",void 0),Object(s["a"])([Object(m["b"])()],te.prototype,"snapToZoom",void 0),te=ee=Object(s["a"])([Object(g["a"])("esri.views.2d.constraints.ZoomConstraint")],te);const ie=te;var se=i("3af1"),ne=i("1219");const ae={base:null,key:"type",typeMap:{extent:se["a"],polygon:ne["a"]}};let oe=class extends Y["a"].EventedAccessor{constructor(){super(...arguments),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0}initialize(){this.watch(["_zoom","_rotation"],this.emit.bind(this,"update"),!0)}destroy(){this.view=null,this._set("_zoom",null),this._set("_rotation",null)}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get _defaultLODs(){var e,t,i;const s=null==(e=this.view)||null==(t=e.defaultsFromMap)?void 0:t.tileInfo,n=null==(i=this.view)?void 0:i.spatialReference;return s&&n&&s.spatialReference.equals(n)?s.lods:null}get _geometry(){return new W({geometry:this.geometry,spatialReference:this.view.spatialReference})}get _rotation(){return new Q({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),t=this.lods||this._defaultLODs,i=this.minZoom,s=this.maxZoom,n=this.minScale,a=this.maxScale,o=this.snapToZoom;return e&&e.lods===t&&e.minZoom===i&&e.maxZoom===s&&e.minScale===n&&e.maxScale===a&&e.snapToZoom===o?e:new ie({lods:t,minZoom:i,maxZoom:s,minScale:n,maxScale:a,snapToZoom:o})}canZoomInTo(e){const t=this.effectiveMaxScale;return 0===t||e>=t}canZoomOutTo(e){const t=this.effectiveMinScale;return 0===t||e<=t}constrain(e,t){return this._zoom.constrain(e,t),this._rotation.constrain(e,t),this._geometry.constrain(e,t),e}constrainByGeometry(e){return this._geometry.constrain(e)}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};Object(s["a"])([Object(m["b"])({readOnly:!0,aliasOf:"_zoom.effectiveLODs"})],oe.prototype,"effectiveLODs",void 0),Object(s["a"])([Object(m["b"])({readOnly:!0,aliasOf:"_zoom.effectiveMinScale"})],oe.prototype,"effectiveMinScale",void 0),Object(s["a"])([Object(m["b"])({readOnly:!0,aliasOf:"_zoom.effectiveMaxScale"})],oe.prototype,"effectiveMaxScale",void 0),Object(s["a"])([Object(m["b"])({readOnly:!0,aliasOf:"_zoom.effectiveMinZoom"})],oe.prototype,"effectiveMinZoom",void 0),Object(s["a"])([Object(m["b"])({readOnly:!0,aliasOf:"_zoom.effectiveMaxZoom"})],oe.prototype,"effectiveMaxZoom",void 0),Object(s["a"])([Object(m["b"])({types:ae,value:null})],oe.prototype,"geometry",null),Object(s["a"])([Object(m["b"])({type:[Z["a"]]})],oe.prototype,"lods",void 0),Object(s["a"])([Object(m["b"])()],oe.prototype,"minScale",void 0),Object(s["a"])([Object(m["b"])()],oe.prototype,"maxScale",void 0),Object(s["a"])([Object(m["b"])()],oe.prototype,"minZoom",void 0),Object(s["a"])([Object(m["b"])()],oe.prototype,"maxZoom",void 0),Object(s["a"])([Object(m["b"])()],oe.prototype,"rotationEnabled",void 0),Object(s["a"])([Object(m["b"])()],oe.prototype,"snapToZoom",void 0),Object(s["a"])([Object(m["b"])()],oe.prototype,"view",void 0),Object(s["a"])([Object(m["b"])()],oe.prototype,"_defaultLODs",null),Object(s["a"])([Object(m["b"])({type:W})],oe.prototype,"_geometry",null),Object(s["a"])([Object(m["b"])({type:Q})],oe.prototype,"_rotation",null),Object(s["a"])([Object(m["b"])({readOnly:!0,type:ie})],oe.prototype,"_zoom",null),oe=Object(s["a"])([Object(g["a"])("esri.views.2d.MapViewConstraints")],oe);const re=oe;var he=i("02f1"),le=i("ec6a");let ce=class extends T["a"]{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}};Object(s["a"])([Object(m["b"])()],ce.prototype,"left",void 0),Object(s["a"])([Object(m["b"])()],ce.prototype,"top",void 0),Object(s["a"])([Object(m["b"])()],ce.prototype,"right",void 0),Object(s["a"])([Object(m["b"])()],ce.prototype,"bottom",void 0),ce=Object(s["a"])([Object(g["a"])("esri.views.2d.PaddedViewState.Padding")],ce);let ue=class extends le["a"]{constructor(...e){super(...e),this.paddedViewState=new le["a"],this._updateContent=(()=>{const e=Object(he["b"])();return()=>{const t=this._get("size"),i=this._get("padding");if(!t||!i)return;const s=this.paddedViewState;Object(G["s"])(e,i.left+i.right,i.top+i.bottom),Object(G["f"])(e,t,e),Object(G["c"])(s.size,e);const n=s.viewpoint;n&&(this.viewpoint=n)}})(),this.watch(["size","padding"],this._updateContent,!0),this.padding=new ce,this.size=[0,0]}set padding(e){this._set("padding",e||new ce)}set viewpoint(e){if(e){const t=e.clone();this.paddedViewState.viewpoint=e,Object(I["a"])(t,e,this._get("size"),this._get("padding"));const i=this._viewpoint2D,s=t.targetGeometry;i.center[0]=s.x,i.center[1]=s.y,i.rotation=t.rotation,i.scale=t.scale,i.spatialReference=s.spatialReference,this._update()}}};Object(s["a"])([Object(m["b"])()],ue.prototype,"paddedViewState",void 0),Object(s["a"])([Object(m["b"])({type:ce})],ue.prototype,"padding",null),Object(s["a"])([Object(m["b"])()],ue.prototype,"viewpoint",null),ue=Object(s["a"])([Object(g["a"])("esri.views.2d.PaddedViewState")],ue);const de=ue;i("3e7b");var pe=i("018d"),me=(i("ae54"),i("07cd"),i("d302"),i("c39b")),ge=i("4a7a"),fe=i("5996");const be=c["a"].getLogger("esri.views.MapView");function we(e){return e&&"esri.Viewpoint"===e.declaredClass}const ye=160;let _e=class extends(Object(j["a"])(x["a"])){constructor(e){super(e),this._stationaryTimer=null,this.frameTask=new R(this),this.featuresTilingScheme=null,this.fullOpacity=1,this.graphicsView=null,this.initialExtent=null,this.map=null,this.labelManager=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.resizeAlign="center",this.supportsGround=!1,this.timeline=new ge["a"],this.type="2d",this.constraints=new re,this.padding={top:0,right:0,bottom:0,left:0};const t=this.handles,i=()=>this.notifyChange("updating");t.add([this.watch("viewpoint",()=>{this._lastStationaryEventTimestamp=performance.now(),this._flipStationary(ye)},!0),this.on("resize",e=>this._resizeHandler(e)),this.watch("animationManager.animation",e=>{this.animation=e}),this.allLayerViews.on("change",()=>{i(),t.remove("map-view-base-layerViewsUpdating"),t.add(this.allLayerViews.map(e=>e.watch("updating",i)),"map-view-base-layerViewsUpdating")})],"map-view-base")}destroy(){this.destroyed||(this._set("preconditionsReady",!1),this._gotoTask=this.frameTask=null)}get _defaultsFromMapSettings(){return{required:{tileInfo:!0,heightModelInfo:!1,extent:!1}}}set animation(e){const t=this._get("animation");if(e===t)return;if(t&&t.stop(),!e||e.isFulfilled())return void this._set("animation",null);this._set("animation",e),this.frameTask.animationInProgress=!0;const i=()=>{e===this._get("animation")&&(this._set("animation",null),this.frameTask.requestFrame()),this.frameTask.animationInProgress=!1};e.when(i,i)}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:t}=this.state.paddedViewState;return new V["a"]({x:e[0],y:e[1],spatialReference:t})}set center(e){if(null==e)return;if(!this._normalizeInput(e))return void be.error("#center",`incompatible spatialReference ${JSON.stringify(e.spatialReference)} with view's spatialReference ${JSON.stringify(this.spatialReference)}`);if(!this.ready)return this._set("center",e),void this.notifyChange("initialExtentRequired");const t=this.viewpoint;Object(I["c"])(t,t,e),this.viewpoint=t}set constraints(e){const t=this._get("constraints");t&&(this.handles.remove("map-view-base-constraints"),t.destroy()),this._set("constraints",e),e&&(e.view=this,this.ready&&(this.state.viewpoint=e.fit(this.state.paddedViewState.viewpoint)),this.handles.add(e.on("update",()=>{this.ready&&this.state&&(this.state.viewpoint=e.fit(this.state.paddedViewState.viewpoint))}),"map-view-base-constraints"))}get extent(){return this.ready?this.state.paddedViewState.extent.clone():this._get("extent")}set extent(e){if(null==e)return;const t=this._normalizeInput(e);if(!t)return void be.error("#center",`incompatible spatialReference ${JSON.stringify(e.spatialReference)} with view's spatialReference ${JSON.stringify(this.spatialReference)}`);if(!t.width||!t.height)return void be.error("#extent","invalid extent size");if(!this.ready)return this._set("extent",t),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),void this.notifyChange("initialExtentRequired");const i=this.viewpoint;Object(I["v"])(i,i,t,this.size,{constraints:this.constraints}),this.viewpoint=i}get graphicsTileStore(){return new me["a"](this.featuresTilingScheme)}get initialExtentRequired(){const e=this._normalizeInput(this.center),t=this._normalizeInput(this.viewpoint),i=this._normalizeInput(this.extent),{scale:s,constraints:n}=this;let a=this.zoom;return!this.get("map.initialViewProperties.viewpoint")&&!i&&(n.effectiveLODs||(a=-1),(!e||0===s&&-1===a)&&(!t||!Object(u["l"])(t.targetGeometry)||"extent"!==t.targetGeometry.type&&!t.scale))}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.state?this.state.resolution:0}get rotation(){return this.ready?this.state.rotation:this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const t=this.viewpoint;Object(I["s"])(t,t,e),this.viewpoint=t}get scale(){return this.ready?this.state.scale:this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",-1);const t=this._get("extent");return t&&(this._set("extent",null),this._set("center",t.center)),void this.notifyChange("initialExtentRequired")}const t=this.viewpoint;Object(I["u"])(t,t,e),this.viewpoint=t}get stationary(){return!(this.animation||this.navigating||this._get("resizing")||this._stationaryTimer)}get updating(){return!this.destroyed&&(!0===this.get("layerViewManager.updating")||!0===this.get("labelManager.updating")||!0===this.get("graphicsView.updating")||this.allLayerViews.some(e=>!e.destroyed&&!("layerViews"in e)&&!0===e.updating))}get viewpoint(){if(!this.ready)return this._get("viewpoint");const e=this.state.paddedViewState;return e&&e.viewpoint.clone()}set viewpoint(e){if(null==e)return;const t=this._normalizeInput(e);if(!t)return void(!e.scale||isNaN(e.scale)?be.error("#viewpoint","invalid scale value of "+e.scale):Object(u["k"])(e.targetGeometry)?be.error("#viewpoint","geometry not defined"):be.error("#viewpoint",`incompatible spatialReference ${JSON.stringify(e.targetGeometry.spatialReference)} with view's spatialReference ${JSON.stringify(this.spatialReference)}`));if(!this.ready)return this._set("viewpoint",t),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),void this.notifyChange("initialExtentRequired");const i=new w["a"]({targetGeometry:new V["a"],scale:0,rotation:0});Object(I["d"])(i,t),this.constraints.constrain(i,this.state.paddedViewState.viewpoint),this.state.viewpoint=i,this.frameTask.requestFrame(),this._set("viewpoint",i)}get zoom(){return this.ready?this.constraints.scaleToZoom(this.scale):this._get("zoom")}set zoom(e){if(null==e)return;if(!this.ready){this.notifyChange("initialExtentRequired"),this._set("zoom",e),this._set("scale",0);const t=this._get("extent");t&&(this._set("extent",null),this._set("center",t.center))}if(!this.constraints.effectiveLODs)return;const t=this.viewpoint;Object(I["u"])(t,t,this.constraints.zoomToScale(e)),this.viewpoint=t,this._set("zoom",this.constraints.scaleToZoom(this.scale))}goTo(e,t){if(e)return this.animation&&(this.animation=null),this._createAnimation(),Object(d["m"])(this,"ready",t&&t.signal).then(()=>{const i={animate:!0,...t},s=Object(I["e"])(e,this);return this.animation.update(s),this._gotoTask={},i.animate?this._gotoAnimated(s,i):this._gotoImmediate(s,i)});be.error("#goTo()","target cannot be null or undefined")}hitTest(e){return Promise.reject("Should be implemented by subclasses")}popupHitTest(e){return this.hitTest(e).then(t=>({...t,mapPoint:this.toMap(e)}))}toMap(e){if(!this.ready)return null;const t=[0,0],[i,s]=this.state.toMap(t,[e.x,e.y]),n=this.spatialReference;return new V["a"]({x:i,y:s,spatialReference:n})}toScreen(e){if(!this.ready)return null;const t=this._normalizeInput(e),i=[t.x,t.y];return this.state.toScreen(i,i),Object(_["f"])(i[0],i[1])}pixelSizeAt(){return this.ready?this.state.resolution:(be.error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}getDefaultSpatialReference(){var e,t,i;return this.map&&"initialViewProperties"in this.map&&(null==(e=this.map)||null==(t=e.initialViewProperties)?void 0:t.spatialReference)||(null==(i=this.defaultsFromMap)?void 0:i.spatialReference)||null}getSpatialReferenceSupport({layer:e}){return e||this._get("ready")||null!==this._getDefaultViewpoint()?{}:null}importLayerView(e){return B.importLayerView(e)}hasLayerViewModule(e){return B.hasLayerViewModule(e)}_createAnimation(){return this.animation&&!this.animation.done||(this.animation=new k["a"]),this.animation}_cancellableGoTo(e,t,i){const s=()=>e===this._gotoTask,n=i.then(()=>{s()&&(this.animation=null)}).catch(e=>{throw s()&&(this.animation=null,t.done||(t.stop(),this.frameTask.animationInProgress=!1)),e}),a=new Promise(e=>e(n));return t.when().catch(()=>{s()&&a.cancel&&a.cancel()}),a}_gotoImmediate(e,t){const i=this._gotoTask,s=this.animation,n=e.then(e=>{if(Object(y["w"])(t),i!==this._gotoTask)throw new r["a"]("view:goto-interrupted","Goto was interrupted");this.viewpoint=s.target=e,s.finish()});return this._cancellableGoTo(i,s,n)}_gotoAnimated(e,t){const i=this._gotoTask,s=this.animation,n=e.then(e=>{if(Object(y["w"])(t),i!==this._gotoTask)throw new r["a"]("view:goto-interrupted","Goto was interrupted");return s.update(e),this.animationManager.animate(s,this.viewpoint,t),s.when().then(()=>{},()=>{})});return this._cancellableGoTo(i,s,n)}_resizeHandler(e){const t=this.state;if(!t)return;let i=this.state.paddedViewState.viewpoint;const s=this.state.paddedViewState.size.concat();t.size=[e.width,e.height],Object(I["q"])(i,i,s,this.state.paddedViewState.size,this.resizeAlign),i=this.constraints.constrain(i,null),this.state.viewpoint=i}_startup(){const e=this._getDefaultViewpoint();this.constraints.view=this,this.constraints.fit(e),this._set("animationManager",new P({view:this})),this._set("state",new de({padding:this._get("padding"),size:this.size,viewpoint:e})),this._set("featuresTilingScheme",new pe["a"](O["a"].create({spatialReference:this.spatialReference,size:512,numLODs:36}))),this._set("ready",!0),this.frameTask&&this.frameTask.start()}_teardown(){this.frameTask&&this.frameTask.stop(),this._set("ready",!1),this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null);const{center:[e,t],spatialReference:i,rotation:s,scale:n}=this.state.paddedViewState,a=new V["a"]({x:e,y:t,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",a),this._set("zoom",-1),this._set("rotation",s),this._set("scale",n),this._set("spatialReference",i),this.constraints.view=null,this.animationManager.destroy(),this._set("animationManager",null),this._set("state",null),this.animation=null}_flipStationary(e){return null!==this._stationaryTimer||(this._stationaryTimer=setTimeout(()=>{this._stationaryTimer=null;const e=performance.now()-this._lastStationaryEventTimestamp;e<ye&&(this._stationaryTimer=this._flipStationary(e))},e)),this._stationaryTimer}_normalizeInput(e,t=this.spatialReference){const i=e&&e.targetGeometry||e;return t?i?t.equals(i.spatialReference)?e:Object(v["a"])(i,t)?we(e)?(e.targetGeometry=Object(v["d"])(i,t),e):Object(v["d"])(i,t):null:null:e}_getDefaultViewpoint(){const e=this.constraints,t={zoom:this._get("zoom"),scale:this._get("scale"),center:this._normalizeInput(this._get("center")),extent:this._normalizeInput(this._get("extent")),rotation:this._get("rotation"),viewpoint:this._normalizeInput(this._get("viewpoint")),spatialReference:this._userSpatialReference};e.effectiveLODs?-1!==t.zoom&&(t.scale=e.zoomToScale(t.zoom)):t.zoom=-1;let i=null,s=null,n=0;const a=t.viewpoint&&t.viewpoint.rotation,o=t.viewpoint&&t.viewpoint.targetGeometry;Object(u["l"])(o)&&("extent"===o.type?i=o:"point"===o.type&&(s=o,n=t.viewpoint.scale));const r=this._normalizeInput(this.get("map.initialViewProperties.viewpoint.targetGeometry.extent")),h=this._normalizeInput(this.initialExtent),l=t.extent||i||r||h,c=t.center||s||l&&l.center,d=this.get("map.initialViewProperties.viewpoint.scale"),p=t.scale||n||d||l&&Object(I["f"])(l,this.size),m=this.get("map.initialViewProperties.viewpoint.rotation"),g=t.rotation||a||m||0;return c&&p?new w["a"]({targetGeometry:c,scale:p,rotation:g}):null}};Object(s["a"])([Object(m["b"])()],_e.prototype,"_stationaryTimer",void 0),Object(s["a"])([Object(m["b"])()],_e.prototype,"_defaultsFromMapSettings",null),Object(s["a"])([Object(m["b"])()],_e.prototype,"animation",null),Object(s["a"])([Object(m["b"])({readOnly:!0})],_e.prototype,"animationManager",void 0),Object(s["a"])([Object(m["b"])({value:null,type:V["a"],dependsOn:["state.id","ready"]})],_e.prototype,"center",null),Object(s["a"])([Object(m["b"])({type:re})],_e.prototype,"constraints",null),Object(s["a"])([Object(m["b"])({value:null,type:se["a"],dependsOn:["state.id","ready"]})],_e.prototype,"extent",null),Object(s["a"])([Object(m["b"])({readOnly:!0})],_e.prototype,"featuresTilingScheme",void 0),Object(s["a"])([Object(m["b"])()],_e.prototype,"fullOpacity",void 0),Object(s["a"])([Object(m["b"])({readOnly:!0})],_e.prototype,"graphicsTileStore",null),Object(s["a"])([Object(m["b"])()],_e.prototype,"graphicsView",void 0),Object(s["a"])([Object(m["b"])({type:se["a"]})],_e.prototype,"initialExtent",void 0),Object(s["a"])([Object(m["b"])({dependsOn:["map.initialViewProperties?.viewpoint","constraints.effectiveLODs","spatialReference"]})],_e.prototype,"initialExtentRequired",null),Object(s["a"])([Object(m["b"])()],_e.prototype,"map",void 0),Object(s["a"])([Object(m["b"])()],_e.prototype,"labelManager",void 0),Object(s["a"])([Object(m["b"])({value:{top:0,right:0,bottom:0,left:0},cast:e=>({top:0,right:0,bottom:0,left:0,...e})})],_e.prototype,"padding",null),Object(s["a"])([Object(m["b"])({type:Object})],_e.prototype,"renderingOptions",void 0),Object(s["a"])([Object(m["b"])()],_e.prototype,"resizeAlign",void 0),Object(s["a"])([Object(m["b"])({readOnly:!0,dependsOn:["state.id"]})],_e.prototype,"resolution",null),Object(s["a"])([Object(m["b"])({value:0,type:Number,dependsOn:["state.id","ready"]})],_e.prototype,"rotation",null),Object(s["a"])([Object(m["b"])({value:0,type:Number,dependsOn:["state.id","ready"]})],_e.prototype,"scale",null),Object(s["a"])([Object(m["b"])({type:fe["a"],dependsOn:["map.initialViewProperties?.spatialReference","defaultsFromMap.ready"]})],_e.prototype,"spatialReference",void 0),Object(s["a"])([Object(m["b"])({readOnly:!0})],_e.prototype,"state",void 0),Object(s["a"])([Object(m["b"])({dependsOn:["animation","navigating","resizing","_stationaryTimer"]})],_e.prototype,"stationary",null),Object(s["a"])([Object(m["b"])({readOnly:!0})],_e.prototype,"supportsGround",void 0),Object(s["a"])([Object(m["b"])({type:ge["a"],readOnly:!0})],_e.prototype,"timeline",void 0),Object(s["a"])([Object(m["b"])({readOnly:!0})],_e.prototype,"type",void 0),Object(s["a"])([Object(m["b"])({readOnly:!0,dependsOn:["layerViewManager.updating","labelManager.updating","graphicsView?.updating"]})],_e.prototype,"updating",null),Object(s["a"])([Object(m["b"])({value:null,type:w["a"],dependsOn:["state.id","ready"]})],_e.prototype,"viewpoint",null),Object(s["a"])([Object(m["b"])({value:-1,dependsOn:["state.id"]})],_e.prototype,"zoom",null),_e=Object(s["a"])([Object(g["a"])("esri.views.MapViewBase")],_e);const ve=_e;var Oe=i("af40"),je=i("7164"),xe=i("1bf0");class ke extends je["a"]{constructor(e,t){super(!0),this.view=e,this.registerIncoming("double-click",t,e=>this._handleDoubleClick(e,t))}_handleDoubleClick(e,t){Object(xe["b"])(e.data,"primary")&&(e.stopPropagation(),t?this.view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this.view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}}class Te extends je["a"]{constructor(e,t,i){super(!0),this.view=e,this.pointerType=t,this.registerIncoming("double-tap-drag",i,e=>this._handleDoubleTapDrag(e))}_handleDoubleTapDrag(e){const{data:t}=e,{pointerType:i}=t;if(i!==this.pointerType)return;e.stopPropagation();const{action:s,delta:n}=t,{view:a}=this,{mapViewNavigation:o}=a;switch(s){case"begin":{const{scale:e}=a;this._startScale=e,this._currentScale=e,this._previousDelta=n,o.begin();break}case"update":{if(this._previousDelta.y===n.y)return;this._previousDelta=n;const e=1.015**n.y,t=this._startScale*e,i=t/this._currentScale;o.setViewpointImmediate(i),this._currentScale=t;break}case"end":{const{constraints:e}=a,{effectiveLODs:t,snapToZoom:i}=e;if(!i||!t)return void o.end();const s=e.snapScale(this._currentScale),r=(n.y>0?Math.max(s,e.snapToPreviousScale(this._startScale)):Math.min(s,e.snapToNextScale(this._startScale)))/this._currentScale;o.zoom(r);break}}}}var Me=i("2b7b");class Se extends je["a"]{constructor(e,t,i){super(!0),this.view=e,this.pointerAction=t,this.registerIncoming("drag",i,e=>this._handleDrag(e)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation());const s=this.view.mapViewNavigation;this.dragEventSeparator=new Me["a"]({start:(e,t)=>{s.pan.begin(this.view,t.data),t.stopPropagation()},update:(e,t)=>{s.pan.update(this.view,t.data),t.stopPropagation()},end:(e,t)=>{s.pan.end(this.view,t.data),t.stopPropagation()},condition:(e,t)=>1===e&&Object(xe["b"])(t.data,this.pointerAction)})}_handleDrag(e){const t=this.view.mapViewNavigation;t.pinch.zoomMomentum||t.pinch.rotateMomentum?this.stopMomentumNavigation():this.dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}}class Ie extends je["a"]{constructor(e,t,i){super(!0),this.view=e,this.pointerAction=t;const s=this.view.mapViewNavigation;this.dragEventSeparator=new Me["a"]({start:(e,t)=>{s.rotate.begin(this.view,t.data),t.stopPropagation()},update:(e,t)=>{s.rotate.update(this.view,t.data),t.stopPropagation()},end:(e,t)=>{s.rotate.end(),t.stopPropagation()},condition:(e,t)=>1===e&&Object(xe["b"])(t.data,this.pointerAction)}),this.registerIncoming("drag",i,e=>this.dragEventSeparator.handle(e))}}var Ve=i("85d4");class Ce extends je["a"]{constructor(e){super(!0),this.view=e,this.frameTask=null,this.watchHandles=new Oe["a"],this.currentDevice=null,this.transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this.handle=this.registerIncoming("gamepad",e=>this.handleEvent(e)),this.handle.pause()}onInstall(e){super.onInstall(e),this.watchHandles.add([Object(d["a"])(this.view.navigation.gamepad,"enabled",e=>{e?(this.handle.resume(),this.frameTask||(this.frameTask=Object(M["a"])({update:e=>this.frameUpdate(e.deltaTime)}))):(this.handle.pause(),this.frameTask&&(this.frameTask.remove(),this.frameTask=null))})])}onUninstall(){this.watchHandles.removeAll(),this.frameTask&&(this.frameTask.remove(),this.frameTask=null),super.onUninstall()}handleEvent(e){const t=this.view.navigation.gamepad.device;t&&e.data.device!==t||this.currentDevice&&this.currentDevice!==e.data.device||("end"===e.data.action?(this.currentDevice=null,Object(Ve["d"])(this.transformation)):(this.currentDevice=e.data.device,Object(Ve["a"])(e.data,this.view.navigation.gamepad,this.transformation)))}frameUpdate(e){const t=this.transformation;if(Object(Ve["c"])(t))return;const i=this.view.viewpoint.clone(),s=this.view.navigation.gamepad.velocityFactor,n=Pe*s*e;Object(I["w"])(i,i,[t.translation[0]*n,-t.translation[1]*n]);const a=1+t.translation[2]*Re*e,o=this.view.constraints.rotationEnabled?-t.heading*ze*e:0,r=this.view.size,h=[r[0]/2,r[1]];Object(I["t"])(i,i,a,o,h,r);const l=this.view.constraints.constrain(i,this.view.viewpoint);this.view.viewpoint=l}}const ze=.06,Pe=.7,Re=6e-4;class De extends je["a"]{constructor(e,t,i){super(!0),this.view=e,this.keys=t,this._pressed=!1,this._keyMap={[t.left]:"left",[t.right]:"right",[t.up]:"up",[t.down]:"down"},this.registerIncoming("key-down",i,e=>this._handleKeyDown(e)),this.registerIncoming("key-up",i,e=>this._handleKeyUp(e)),this.registerIncoming("blur",i,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const i=this._keyMap[e.data.key];if(this._pressed=null!=i,this._pressed){if(t)switch(this.view.mapViewNavigation.begin(),i){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}}class Ee extends je["a"]{constructor(e,t,i){super(!0),this.view=e,this.keys=t,this._pressed=!1,this._keyToDirection={[t.clockwiseOption1]:"clockwise",[t.clockwiseOption2]:"clockwise",[t.counterClockwiseOption1]:"counterClockwise",[t.counterClockwiseOption2]:"counterClockwise",[t.resetOption1]:"reset",[t.resetOption2]:"reset"},this.registerIncoming("key-down",i,e=>this._handleKeyDown(e)),this.registerIncoming("key-up",i,e=>this._handleKeyUp(e)),this.registerIncoming("blur",i,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const i=e.modifiers;if(i.size>0&&!i.has("Shift")||!this.view.constraints.rotationEnabled)return;const s=this._keyToDirection[e.data.key];if(this._pressed=null!=s,this._pressed){if(t)switch(this.view.mapViewNavigation.begin(),s){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}}class Ne extends je["a"]{constructor(e,t,i){super(!0),this.view=e,this.keys=t,this._keysToZoomAction={},this.registerIncoming("key-down",i,e=>this._handleKeyDown(e)),t.zoomIn.forEach(e=>this._keysToZoomAction[e]=0),t.zoomOut.forEach(e=>this._keysToZoomAction[e]=1)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const t=e.modifiers;if(t.size>0&&!t.has("Shift"))return;const{key:i}=e.data;if(!(i in this._keysToZoomAction))return;const s=this._keysToZoomAction[i],{mapViewNavigation:n}=this.view;let a=null;switch(s){case 0:a=n.zoomIn();break;case 1:a=n.zoomOut();break;default:return}n.begin(),a.then(()=>n.end()),e.stopPropagation()}}const Le=.6;class Fe extends je["a"]{constructor(e,t){super(!0),this.view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",t,e=>this._handleMouseWheel(e))}_handleMouseWheel(e){if(!this.view.navigation.mouseWheelZoomEnabled)return;if(e.preventDefault(),e.stopPropagation(),!this._canZoom)return;const t=this.view.mapViewNavigation,{x:i,y:s,deltaY:n}=e.data,a=1/Le**(1/60*n),o=t.zoom(a,[i,s]);o&&(this._canZoom=!1,o.catch(()=>{}).then(()=>{this._canZoom=!0,t.end()}))}}class Be extends je["a"]{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",e=>this._handleDrag(e)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation());const t=this.view.mapViewNavigation;this.dragEventSeparator=new Me["a"]({start:(e,i)=>{t.pinch.begin(this.view,i.data),i.stopPropagation()},update:(e,i)=>{t.pinch.update(this.view,i.data),i.stopPropagation()},end:(e,i)=>{t.pinch.end(this.view),i.stopPropagation()},condition:e=>e>=2})}_handleDrag(e){this.dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}}var qe=i("6345"),Ye=i("2589"),Ze=i("16d5"),Xe=i("1729"),Ae=i("28eb"),Ge=i("bec4"),Ue=i("1740");class Ke extends je["a"]{constructor(e=Ge["a"].maximumDoubleClickDelay,t=Ge["a"].maximumDoubleClickDistance,i=Ge["a"].maximumDoubleTouchDelay,s=Ge["a"].maximumDoubleTouchDistance,n=Xe["a"]){super(!1),this.maximumDoubleClickDelay=e,this.maximumDoubleClickDistance=t,this.maximumDoubleTouchDelay=i,this.maximumDoubleTouchDistance=s,this._clock=n,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=Object(_["f"])(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new Me["a"]({start:(e,t)=>this._dragStart(e,t),update:(e,t)=>this._dragUpdate(t),end:(e,t)=>this._dragEnd(t)}),this.registerIncoming("drag",e=>this._dragEventSeparator.handle(e)),this.registerIncoming("pointer-down",e=>this._handlePointerDown(e)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{null!=e.doubleTapTimeout&&(e.doubleTapTimeout.remove(),e.doubleTapTimeout=null)})}get hasPendingInputs(){return Object(Ae["c"])(this._pointerState,e=>null!=e.doubleTapTimeout)}_clearPointerDown(e){const t=this._pointerState.get(e);t&&(t.doubleTapTimeout.remove(),t.doubleTapTimeout=null,this._pointerState.delete(e),this.refreshHasPendingInputs())}_createDoubleTapDragData(e,t,i){const{button:s,buttons:n,pointer:a,pointers:o,pointerType:r,timestamp:h}=i;return{action:e,delta:t,button:s,buttons:n,pointer:a,pointers:o,pointerType:r,timestamp:h}}_dragStart(e,t){if(!this._doubleTapDragReady||1!==e)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:i,modifiers:s}=t,{center:n}=i;this._dragStartCenter=n;const a=this._createDoubleTapDragData("begin",Object(_["f"])(0,0),i);this._doubleTapDrag.emit(a,void 0,s),t.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:i}=e,{center:s}=t,n=Object(_["f"])(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),a=this._createDoubleTapDragData("update",n,t);this._doubleTapDrag.emit(a,void 0,i),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:i}=e,{center:s}=t,n=Object(_["f"])(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),a=this._createDoubleTapDragData("end",n,t);this._doubleTapDrag.emit(a,void 0,i),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:t}=e,i=this._pointerId(t),s=this._pointerState.get(i),{pointerType:n}=t.native;if(s){const a="touch"===n?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;this._clearPointerDown(i),Object(Ue["c"])(s.event.data,t)>a?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_pointerId(e){const{native:t}=e,{pointerId:i,button:s,pointerType:n}=t;return"mouse"===n?`${i}:${s}`:""+n}_storePointerDown(e){const{data:t}=e,{pointerType:i}=t.native,s=this._pointerId(t),n="touch"===i?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay,a=this._clock.setTimeout(()=>this._clearPointerDown(s),n);this._pointerState.set(s,{event:e,doubleTapTimeout:a}),this.refreshHasPendingInputs()}}var He=i("0f18"),We=i("82a5"),$e=i("e35b");const Je={counter:"Ctrl",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let Qe=class extends T["a"]{constructor(){super(...arguments),this._handles=new Oe["a"]}initialize(){this._handles.add([Object(d["i"])(this.view,"ready",()=>this._disconnect()),Object(d["f"])(this.view,"ready",()=>this._connect())])}destroy(){this._handles&&(this._handles.removeAll(),this._handles=null),this._disconnect()}_disconnect(){this._inputManager&&(this.view.viewEvents.disconnect(),this._inputManager.destroy(),this._inputManager=null,this._source.destroy(),this._source=null)}_connect(){const e=this.view.surface,t=new qe["a"](e,this.view.input),i=[new We["a"],new $e["a"],new Ge["b"],new He["a"](this.view.navigation),new Ke],s=new Ye["a"]({eventSource:t,recognizers:i});s.installHandlers("prevent-context-menu",[new Ze["a"]],Ye["b"].INTERNAL),s.installHandlers("navigation",[new Be(this.view),new Ce(this.view),new Fe(this.view),new ke(this.view),new ke(this.view,[Je.counter]),new Se(this.view,"primary"),new De(this.view,Je.pan),new Ne(this.view,Je.zoom),new Ee(this.view,Je.rotate),new Ie(this.view,"secondary"),new Te(this.view,"touch")],Ye["b"].INTERNAL),this.view.viewEvents.connect(s),this._source=t,this._inputManager=s,Object(d["a"])(this.view.navigation,"browserTouchPanEnabled",e=>{this._source.browserTouchPanningEnabled=!e})}get test(){return{inputManager:this._inputManager}}};Object(s["a"])([Object(m["b"])()],Qe.prototype,"view",void 0),Qe=Object(s["a"])([Object(g["a"])("esri.views.2d.input.MapViewInputManager")],Qe);const et=Qe;var tt=i("9ef0");let it=0,st=class extends T["a"]{constructor(){super(...arguments),this.color=new tt["a"]([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25}get version(){return it++}};Object(s["a"])([Object(m["b"])({readOnly:!0})],st.prototype,"version",null),Object(s["a"])([Object(m["b"])({type:tt["a"]})],st.prototype,"color",void 0),Object(s["a"])([Object(m["b"])({type:tt["a"]})],st.prototype,"haloColor",void 0),Object(s["a"])([Object(m["b"])()],st.prototype,"haloOpacity",void 0),Object(s["a"])([Object(m["b"])()],st.prototype,"fillOpacity",void 0),st=Object(s["a"])([Object(g["a"])("esri.views.2d.support.HighlightOptions")],st);const nt=st;function at(e,t,i,s,n,a,o,r){let h;e.ignorePadding&&(s={left:0,right:0,top:0,bottom:0}),null!=e.width&&null!=e.height?h=[e.width,e.height]:null==e.width&&null!=e.height?h=[e.height,e.height]:null!=e.width&&null==e.height?h=[e.width,e.width]:null==e.width&&null==e.height&&(h=null);const l=i[0]-(s.left+s.right),c=i[1]-(s.top+s.bottom);let u,d,p=e.area||{x:0,y:0,width:l,height:c};if(h){const e=l/c,t=h[0]/h[1];if(t>e){const e=p.width/t;p={x:p.x,y:Math.round(p.y+(p.height-e)/2),width:p.width,height:Math.round(e)}}else{const e=p.height*t;p={x:Math.round(p.x+(p.width-e)/2),y:p.y,width:Math.round(e),height:p.height}}}else h=[p.width,p.height];return h[0]>p.width?(u=Math.min(h[0]/p.width,t),d=h[0]/p.width/u):(u=1,d=h[0]/p.width),{resolutionScale:u,cropArea:{x:Math.round((p.x+s.left)*u),y:Math.round((p.y+s.top)*u),width:Math.round(p.width*u),height:Math.round(p.height*u)},outputScale:d,format:n,quality:a,children:o,rotation:r}}var ot=i("4dc1"),rt=i("412f"),ht=i("c4da"),lt=i("ca85");let ct=class extends lt["a"]{constructor(e){super(e),this.components=["attribution","zoom"]}};Object(s["a"])([Object(m["b"])()],ct.prototype,"components",void 0),ct=Object(s["a"])([Object(g["a"])("esri.views.ui.2d.DefaultUI2D")],ct);const ut=ct;var dt,pt=i("6a0e"),mt=i("7ffa");let gt=dt=class extends pt["a"]{constructor(e){super(e),this.color=new tt["a"]([0,0,0,1])}clone(){return new dt(Object(mt["a"])({color:this.color}))}};Object(s["a"])([Object(m["b"])({type:tt["a"],json:{write:!0}})],gt.prototype,"color",void 0),gt=dt=Object(s["a"])([Object(g["a"])("esri.webmap.background.ColorBackground")],gt);const ft=gt,bt=c["a"].getLogger("esri.views.MapView");let wt,yt,_t,vt,Ot,jt;async function xt(){const[,{GraphicsView2D:e,GraphicContainer:t,LabelManager:s,MapViewNavigation:n,MagnifierView2D:a,Stage:o}]=await Promise.all([Promise.all([i.e("chunk-68ddeb1e"),i.e("chunk-70c316c0")]).then(i.bind(null,"b69b")),Promise.all([i.e("chunk-68ddeb1e"),i.e("chunk-93a83094"),i.e("chunk-5bee4ec9"),i.e("chunk-205026ce"),i.e("chunk-7395b133")]).then(i.bind(null,"b460"))]);yt=e,_t=t,vt=s,Ot=n,jt=a,wt=o}let kt=class extends(Object(f["a"])(Object(b["a"])(ve))){constructor(e){super(e),this._magnifierView=null,this._stage=null,this._resolveWhenReady=[],this.rootLayerViews=new o["a"]({getCollections:()=>{var e,t;return[null==(e=this.basemapView)?void 0:e.baseLayerViews,this.layerViews,null==(t=this.basemapView)?void 0:t.referenceLayerViews]},getChildrenFunction:()=>null}),this.floors=new a["a"],this.graphicsView=null,this.highlightOptions=new nt,this.inputManager=new et({view:this}),this.mapViewNavigation=null,this.supersampleScreenshotsEnabled=!1,this.ui=new ut,this.rendering=!1,Object(p["a"])()}destroy(){this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get background(){return this.get("map.initialViewProperties.background")||null}set background(e){void 0===e?this._clearOverride("background"):this._override("background",e)}get resourceManager(){return this._stage.resourceManager}get textureManager(){return this._stage.painter.textureManager}get navigating(){return!(!this.mapViewNavigation||!this.mapViewNavigation.interacting)}toMap(e){if(Object(rt["d"])(e)){const t=Object(rt["c"])(this,e);return super.toMap(t)}return super.toMap(e)}async hitTest(e,t){const i=Object(rt["d"])(e)?Object(rt["c"])(this,e):e;if(!this.ready||isNaN(i.x)||isNaN(i.y))return{screenPoint:i,results:[]};let s=new Set,n=!1,a=null,o=null;null!=t&&t.include?It(t.include,St(this,e=>s.add(e),e=>{a||(a=new Set),a.add(e)},e=>s.add(e),()=>n=!0)):(n=!0,s=new Set(this.allLayerViews)),null!=t&&t.exclude&&It(t.exclude,St(this,e=>s.delete(e),e=>{o||(o=new Set),o.add(e)}));const r=this.allLayerViews.filter(e=>!e.suspended&&s.has(e)).reverse(),h=this.toMap(i);let l=(await Promise.all([n?this.graphicsView.hitTest(h):null,...r.map(e=>e.hitTest(h,i))])).filter(u["l"]).flat();return a&&(l=l.filter(e=>a.has(Mt(e)))),o&&(l=l.filter(e=>!o.has(Mt(e)))),{screenPoint:i,results:l.map(e=>({mapPoint:h,graphic:e}))}}takeScreenshot(e){e=e||{};const t=this.supersampleScreenshotsEnabled?Math.min(4,Object(ot["d"])(this.size,Math.min(4096,this._stage.context.parameters.maxTextureSize))):1;let i;e.layers?(i=[],e.layers.forEach(e=>{const t=this.allLayerViews.find(t=>t.layer.id===e.id);t&&"container"in t&&t.container&&i.push(t.container)})):i=this._stage.children;const{format:s,quality:n}=Object(ot["c"])(e.format,e.quality),a=at(e,t,this.size,this.padding,s,n,i,e.rotation);return this._stage.takeScreenshot(a)}on(e,t,i,s){const n=this.inputManager&&this.viewEvents.on(e,t,i,s);return n||super.on(e,t)}hasEventListener(e){return super.hasEventListener(e)||this.viewEvents.hasHandler(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}validate(){let e=Object(ht["a"])({checkMajorWebPerformanceCaveat:!1});return Object(h["a"])("safari")&&Object(h["a"])("safari")<9&&(e=new r["a"]("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:Object(h["a"])("safari")})),Object(u["l"])(e)?(bt.warn("#validate()",e.message),Promise.reject(e)):xt()}_startup(){this.timeline.begin("MapView Startup"),super._startup(),this.graphics.owner=this;const e={disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},t=new wt(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenshotsEnabled,contextOptions:e,renderingOptions:this.renderingOptions,timeline:this.timeline}),i=new yt({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new _t(this.featuresTilingScheme)}),s=new Ot({view:this,animationManager:this.animationManager}),n=new vt({view:this});this._magnifierView=new jt,this._magnifierView.magnifier=this.magnifier,this._stage=t,this.frameTask.graphicsView=i,this._set("graphicsView",i),this._set("mapViewNavigation",s),this._set("labelManager",n),this.handles.add([this.rootLayerViews.on("change",()=>this._updateStageChildren()),t.on("post-render",()=>this._set("rendering",t.renderRequested)),t.on("will-render",()=>this._set("rendering",t.renderRequested)),t.on("webgl-error",e=>this.fatalError=e.error),Object(d["a"])(this,"stationary",e=>t.stationary=e,!0),Object(d["a"])(this,"state.id",()=>t.state=this.state,!0),Object(d["a"])(this,"background",e=>{t.background=e,this._magnifierView.background=e},!0),Object(d["a"])(this,"magnifier",e=>this._magnifierView.magnifier=e,!0),Object(d["a"])(this,"renderingOptions",e=>t.renderingOptions=e,!0),Object(d["a"])(this,"highlightOptions",()=>t.highlightOptions=this.highlightOptions,!0)],"map-view"),t.state=this.state,this._updateStageChildren();const a=this._resolveWhenReady;this._resolveWhenReady=[],a.forEach(e=>e(this)),this.timeline.end("MapView Startup")}_teardown(){this.handles.remove("map-view"),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._stage.destroy(),this.graphicsView.destroy(),this.mapViewNavigation.destroy(),this._stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,super._teardown()}_updateStageChildren(){this._stage.removeAllChildren(),this.rootLayerViews.forEach(e=>{this._stage.addChild(e.container)});const e=this.graphicsView;this._stage.addChild(e.container),this._stage.addChild(this._magnifierView)}};Object(s["a"])([Object(m["b"])({type:ft})],kt.prototype,"background",null),Object(s["a"])([Object(m["b"])()],kt.prototype,"floors",void 0),Object(s["a"])([Object(m["b"])()],kt.prototype,"graphicsView",void 0),Object(s["a"])([Object(m["b"])({type:nt})],kt.prototype,"highlightOptions",void 0),Object(s["a"])([Object(m["b"])({readOnly:!0})],kt.prototype,"inputManager",void 0),Object(s["a"])([Object(m["b"])({readOnly:!0})],kt.prototype,"resourceManager",null),Object(s["a"])([Object(m["b"])({readOnly:!0})],kt.prototype,"textureManager",null),Object(s["a"])([Object(m["b"])({readOnly:!0})],kt.prototype,"mapViewNavigation",void 0),Object(s["a"])([Object(m["b"])({type:Boolean})],kt.prototype,"navigating",null),Object(s["a"])([Object(m["b"])({type:Boolean,constructOnly:!0})],kt.prototype,"supersampleScreenshotsEnabled",void 0),Object(s["a"])([Object(m["b"])({type:ut})],kt.prototype,"ui",void 0),Object(s["a"])([Object(m["b"])({readOnly:!0})],kt.prototype,"rendering",void 0),Object(s["a"])([Object(m["b"])({constructOnly:!0})],kt.prototype,"renderCanvas",void 0),Object(s["a"])([Object(m["b"])({constructOnly:!0})],kt.prototype,"deactivatedWebGLExtensions",void 0),Object(s["a"])([Object(m["b"])({constructOnly:!0})],kt.prototype,"debugWebGLExtensions",void 0),kt=Object(s["a"])([Object(g["a"])("esri.views.MapView")],kt);const Tt=kt;function Mt(e){const t=e.getObjectId();var i,s,n,a;return t?`${null!=(i=null!=(s=null==(n=e.layer)?void 0:n.uid)?s:null==(a=e.sourceLayer)?void 0:a.uid)?i:"MapView"}/${t}`:'"MapView/'+e.uid}function St(e,t,i,s,a){return o=>{if(o instanceof n["a"]){if(o.layer===e)null==a||a();else{const t=e.allLayerViews.find(e=>e.layer===o.layer);t&&(null==s||s(t))}i(Mt(o))}else{const i=e.allLayerViews.find(e=>e.layer===o);i&&t(i)}}}function It(e,t){if(e)if(Object(l["c"])(e))for(const i of e)if(Object(l["c"])(i))for(const e of i)t(e);else t(i);else t(e)}},b541:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var s=i("b2b2"),n=i("f4cc"),a=i("8ca7"),o=i("5815");class r{constructor(e,t){this.item=e,this.controller=t,this.promise=null}}class h{constructor(e){this._deferreds=new Map,this._controllers=new Map,this._processingItems=new Map,this._isPaused=!1,this._schedule=null,this._task=null,this.concurrency=1,e.concurrency&&(this.concurrency=e.concurrency),this._queue=new a["a"](e.peeker),this.process=e.process;const t=e.scheduler;e.priority&&Object(s["l"])(t)&&(this._task=t.registerTask(e.priority,this))}destroy(){this.clear(),this._schedule&&(this._schedule.remove(),this._schedule=null),this._task&&(this._task.remove(),this._task=null)}get length(){return this._processingItems.size+this._queue.length}abort(e){const t=this._controllers.get(e);t&&t.abort()}clear(){this._queue.clear();const e=[];this._controllers.forEach(t=>e.push(t)),this._controllers.clear(),e.forEach(e=>e.abort()),this._processingItems.clear(),this._cancelNext()}forEach(e){this._deferreds.forEach((t,i)=>e(i))}get(e){const t=this._deferreds.get(e);return t?t.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._isPaused||(this._isPaused=!0,this._cancelNext())}push(e,t){const i=this.get(e);if(i)return i;const a=new AbortController;let o=null;t&&(o=Object(n["r"])(t,()=>a.abort()));const r=()=>{const t=this._processingItems.get(e);t&&t.controller.abort(),h(),c.reject(Object(n["e"])())},h=()=>{l.remove(),Object(s["l"])(o)&&o.remove(),this._deferreds.delete(e),this._controllers.delete(e),this._queue.remove(e),this._processingItems.delete(e),this._scheduleNext()},l=Object(n["s"])(a.signal,r),c=Object(n["f"])();return this._deferreds.set(e,c),this._controllers.set(e,a),c.promise.then(h,h),this._queue.push(e),this._scheduleNext(),c.promise}last(){return this._queue.last()}peek(){return this._queue.peek()}popLast(){return this._queue.popLast()}reset(){const e=[];this._processingItems.forEach(t=>e.push(t)),this._processingItems.clear();for(const t of e)this._queue.push(t.item),t.controller.abort();this._scheduleNext()}resume(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}get running(){return!this._isPaused&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(e){for(;!e.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),e.madeProgress()}_scheduleNext(){this._task||this._isPaused||this._schedule||(this._schedule=Object(o["b"])(()=>{this._schedule=null,this._next()}))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(e,t){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(t))}_processError(e,t){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(t))}_canProcessFulfillment(e){return!!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(Object(s["k"])(e))return;let t;const i=new AbortController,a=new r(e,i);this._processingItems.set(e,a);try{t=this.process(e,i.signal)}catch(o){this._processError(a,o)}Object(n["p"])(t)?(a.promise=t,t.then(e=>this._processResult(a,e),e=>this._processError(a,e))):this._processResult(a,t)}get test(){return{update:e=>this.runTask(e)}}}},ba6a:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var s=i("ecd7");class n{constructor(){this.spans=[]}acquire(e){this.lodInfo=e}release(){this.lodInfo=null,this.spans.length=0}forEach(e,t){const{spans:i,lodInfo:s}=this,{level:n}=s;if(0!==i.length)for(const{row:a,colFrom:o,colTo:r}of i)for(let i=o;i<=r;i++)e.call(t,n,a,s.normalizeCol(i),s.getWorldForColumn(i))}}n.pool=new s["a"](n)},c39b:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var s=i("ce6d"),n=i("c120"),a=i("901f"),o=i("ee0e"),r=i("ba6a"),h=i("ae54");const l={added:[],removed:[]},c=new Set,u=new h["a"](0,0,0,0);class d extends s["a"]{constructor(e){super(),this._tiles=new Map,this._index=Object(a["a"])(9,Object(n["a"])("esri-csp-restrictions")?e=>({minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=e}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const t={added:[],removed:[]};for(const i of e.added)if(!this.has(i)){const e=new o["a"](this.tileScheme,i);this._tiles.set(i,e),this._index.insert(e),t.added.push(e)}for(const i of e.removed)if(this.has(i)){const e=this.get(i);this._tiles.delete(i),this._index.remove(e),t.removed.push(e)}this.tiles.length=0,this._tiles.forEach(e=>this.tiles.push(e)),(t.added.length||t.removed.length)&&this.emit("update",t)}setViewState(e){const t=this.tileScheme.getTileCoverage(e,0);if(!t)return;const{spans:i,lodInfo:s}=t,{level:n}=s;if(i.length>0)for(const{row:a,colFrom:r,colTo:h}of i)for(let e=r;e<=h;e++){const t=u.set(n,a,s.normalizeCol(e),s.getWorldForColumn(e)).id;if(c.add(t),!this.has(t)){const e=new o["a"](this.tileScheme,t);this._tiles.set(t,e),this._index.insert(e),this.tiles.push(e),l.added.push(e)}}for(let a=this.tiles.length-1;a>=0;a--){const e=this.tiles[a];c.has(e.id)||(this._tiles.delete(e.id),this.tiles.splice(a,1),this._index.remove(e),l.removed.push(e))}(l.added.length||l.removed.length)&&this.emit("update",l),r["a"].pool.release(t),c.clear(),l.added.length=0,l.removed.length=0}}},d302:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var s=i("9180"),n=i("3349");class a{constructor(e,t,i){this.maxSize=e,this.tileInfoView=t,this.removedFunc=i,this._tilePerId=new Map,this._tileKeysPerLevel=[]}has(e){return this._tilePerId.has(e)}get(e){return this._tilePerId.get(e)}pop(e){const t=this._tilePerId.get(e);if(!t)return null;const i=t.key.level,s=this._tileKeysPerLevel[i];o(this._tilePerId,e);for(let n=0;n<s.length;n++)if(s[n].id===e){s.splice(n,1);break}return t.visible=!0,t}add(e){e.visible=!1;const t=e.key,i=t.id;if(this._tilePerId.has(i))return;this._tilePerId.set(i,e);const s=t.level;this._tileKeysPerLevel[s]||(this._tileKeysPerLevel[s]=[]),this._tileKeysPerLevel[s].push(t)}prune(e,t,i){let s=this._tilePerId.size;if(s<=this.maxSize)return;let n=this._tileKeysPerLevel.length-1;for(;s>this.maxSize&&n>=0;)n!==e&&(s=this._pruneAroundCenterTile(s,t,i,n)),n--;s>this.maxSize&&(s=this._pruneAroundCenterTile(s,t,i,e))}_pruneAroundCenterTile(e,t,i,s){const a=this._tileKeysPerLevel[s];if(!a||0===a.length)return e;const{size:o,origin:r}=this.tileInfoView.tileInfo,h=i*o[0],l=i*o[1],c=[0,0],u=[0,0];for(a.sort((e,i)=>(c[0]=r.x+h*(e.col+.5),c[1]=r.y-l*(e.row+.5),u[0]=r.x+h*(i.col+.5),u[1]=r.y-l*(i.row+.5),Object(n["a"])(c,t)-Object(n["a"])(u,t)));a.length>0;){const t=a.pop();if(this._removeTile(t.id),--e===this.maxSize)break}return e}_removeTile(e){const t=this._tilePerId.get(e);this.removedFunc&&this.removedFunc(t),o(this._tilePerId,e)}}function o(e,t){e.delete(t)}var r=i("ba6a"),h=i("ae54");const l=new h["a"](0,0,0,0),c=new Map,u=[],d=[];class p{constructor(e){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,this.resampling=null==e.resampling||!!e.resampling,e.cachePolicy&&(this.cachePolicy=e.cachePolicy),e.coveragePolicy&&(this.coveragePolicy=e.coveragePolicy),null!=e.buffer&&(this.buffer=e.buffer),e.cacheSize&&(this._tileCache=new a(e.cacheSize,this.tileInfoView,e=>{this.releaseTile(e)}))}destroy(){this.tileIndex.clear()}update(e){const{resampling:t,tileIndex:i}=this,s=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.coveragePolicy);if(d.length=0,u.length=0,c.clear(),!s)return;const{minScale:n,maxScale:a}=this.tileInfoView.tileInfo,{spans:o,lodInfo:h}=s,{level:p}=h,{scale:m,center:g,resolution:f}=e.state,b=!e.stationary&&m>this._previousScale;if(this._previousScale=m,this.tiles.length=0,!t&&(m>n||m<a))return this.tiles.length=0,c.clear(),i.forEach(e=>{this.releaseTile(e)}),i.clear(),d.length=0,u.length=0,c.clear(),r["a"].pool.release(s),!0;i.forEach(e=>e.visible=!0);let w=0,y=0;if(o.length>0)for(const{row:r,colFrom:u,colTo:d}of o)for(let e=u;e<=d;e++){w++;const t=l.set(p,r,h.normalizeCol(e),h.getWorldForColumn(e)).id;if(i.has(t)){const e=i.get(t);e.isReady?(c.set(t,e),y++):b||this._addParentTile(t,c)}else{let e;if(this._tileCache&&this._tileCache.has(t)){if(e=this._tileCache.pop(t),this.tileIndex.set(t,e),e.isReady){c.set(t,e),y++;continue}}else e=this.acquireTile(l),this.tileIndex.set(t,e);b||this._addParentTile(t,c)}}const _=y===w;i.forEach((e,t)=>{if(l.set(t),c.has(t))return;const i=this.tileInfoView.intersects(s,l),n="purge"===this.cachePolicy?l.level!==p:l.level>p;!i||!b&&_?!n&&i||u.push(t):e.isReady?n&&"purge"===this.cachePolicy&&this._hasReadyAncestor(l,p)?u.push(t):d.push(t):n&&u.push(t)});for(const r of d){const e=i.get(r);e&&e.isReady&&c.set(r,e)}for(const r of u){const e=i.get(r);this._tileCache?this._tileCache.add(e):this.releaseTile(e),i.delete(r)}return c.forEach(e=>this.tiles.push(e)),i.forEach(e=>{c.has(e.key.id)||(e.visible=!1)}),this._tileCache&&this._tileCache.prune(p,g,f),r["a"].pool.release(s),c.clear(),_}clear(e=!0){const{tileIndex:t}=this;e&&t.forEach(e=>{this.releaseTile(e)}),t.clear()}updateCacheSize(e){this._tileCache&&(this._tileCache.maxSize=e)}_addParentTile(e,t){let i=e,s=null;for(;i=this.tileInfoView.getTileParentId(i),i;)if(this.tileIndex.has(i)){if(s=this.tileIndex.get(i),s&&s.isReady){t.has(s.key.id)||t.set(s.key.id,s);break}}else if(this._tileCache&&this._tileCache.has(i)&&(s=this._tileCache.pop(i),this.tileIndex.set(i,s),s&&s.isReady)){t.has(s.key.id)||t.set(s.key.id,s);break}}_hasReadyAncestor(e,t){const i=Object(s["m"])();this.tileInfoView.getTileBounds(i,e,!0);for(const n of this.tileIndex.values())if(n.isReady&&n.key.level>=t&&n.key.level<e.level){const e=Object(s["m"])();if(this.tileInfoView.getTileBounds(e,n.key,!0),Object(s["g"])(e,i))return!0}return!1}}},ee0e:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var s=i("556f"),n=i("3af1"),a=i("9180"),o=i("79e4"),r=i("ae54");class h{constructor(e,t){this.key=new r["a"](0,0,0,0),this.bounds=Object(a["m"])(),this.objectIds=new Set,this.key.set(t);const i=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=i.resolution,this.scale=i.scale,this.level=i.level}get id(){return this.key.id}get extent(){return n["a"].fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createChildTiles(){const e=this.key.getChildKeys(),t=s["a"].acquire();for(let i=0;i<e.length;i++)t[i]=new h(this.tileInfoView,e[i]);return t}getQuantizationParameters(){return o["a"].fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}}}}]);
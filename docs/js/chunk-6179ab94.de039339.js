(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6179ab94"],{"057f":function(t,e,n){var r=n("fc6a"),i=n("241c").f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(e){return a.slice()}};t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?c(t):i(r(t))}},"06c5":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));n("fb6a"),n("d3b7"),n("b0c0"),n("a630"),n("3ca3");var r=n("6b75");function i(t,e){if(t){if("string"===typeof t)return Object(r["a"])(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r["a"])(t,e):void 0}}},"2a07":function(t,e,n){},3835:function(t,e,n){"use strict";function r(t){if(Array.isArray(t))return t}n.d(e,"a",(function(){return c}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");function i(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,c=!1;try{for(n=n.call(t);!(a=(r=n.next()).done);a=!0)if(o.push(r.value),e&&o.length===e)break}catch(u){c=!0,i=u}finally{try{a||null==n["return"]||n["return"]()}finally{if(c)throw i}}return o}}var o=n("06c5");function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t,e){return r(t)||i(t,e)||Object(o["a"])(t,e)||a()}},"4de4":function(t,e,n){"use strict";var r=n("23e7"),i=n("b727").filter,o=n("1dde"),a=o("filter");r({target:"Array",proto:!0,forced:!a},{filter:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(t,e,n){"use strict";var r=n("0366"),i=n("7b0b"),o=n("9bdd"),a=n("e95a"),c=n("50c4"),u=n("8418"),f=n("35a1");t.exports=function(t){var e,n,s,l,d,v,b=i(t),p="function"==typeof this?this:Array,h=arguments.length,y=h>1?arguments[1]:void 0,g=void 0!==y,m=f(b),w=0;if(g&&(y=r(y,h>2?arguments[2]:void 0,2)),void 0==m||p==Array&&a(m))for(e=c(b.length),n=new p(e);e>w;w++)v=g?y(b[w],w):b[w],u(n,w,v);else for(l=m.call(b),d=l.next,n=new p;!(s=d.call(l)).done;w++)v=g?o(l,y,[s.value,w],!0):s.value,u(n,w,v);return n.length=w,n}},"589c":function(t,e,n){"use strict";n("ba62")},"5e06":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrap"},[n("div",{staticClass:"container",attrs:{id:"viewDiv"}})])}],o=n("3835"),a=n("1da1"),c=(n("96cf"),n("d81d"),n("99af"),n("4de4"),n("d3b7"),n("ddb0"),n("a15b"),n("159b"),n("b64b"),n("bc3a")),u=n.n(c),f=n("6d1b"),s=n("8d60"),l=n("f6ad"),d=n("a611"),v=n("5bd5"),b=n("ce0b"),p=n("955e"),h={name:"UserCluster",components:{},data:function(){return{totalNum:0,map:null,view:null,filterList:[{id:0,count:0,label:"在线",value:"ONLINE",active:!0},{id:1,count:0,label:"离线",value:"OFFLINE",active:!0},{id:2,count:0,label:"未激活",value:"UNACTIVATED",active:!0}]}},mounted:function(){this.initMap(),this.initBind(),this.initDeviceLayer()},methods:{initMap:function(){var t=new f["a"]({basemap:"hybrid"}),e=new d["a"]({container:"viewDiv",map:t,zoom:11,center:[113.54735115356235,22.78385103258788]}),n=new l["a"]({view:e});e.ui.add(n,{position:"bottom-left"}),this.map=t,window._view=this.view=e},initBind:function(){var t=this;this.view.on("click",(function(e){t.view.hitTest(e).then((function(t){if(t.results&&t.results.length){var e=t.results[0].graphic.attributes;console.log("attribute：".concat(JSON.stringify(e)))}}))}))},getUniqueValueInfos:function(){var t=this.filterList.map((function(t,e){return{value:t.value,symbol:{type:"picture-marker",url:"".concat("/study-arcgis/","/static/images/svg/camera_m_").concat(e+1,".svg")}}}));return t},initDeviceLayer:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,r,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getDeviceData();case 2:n=e.sent,r=t.getUniqueValueInfos(),i={type:"cluster",clusterRadius:"100px",popupTemplate:{title:"设备聚合",content:"共有{cluster_count}个设备,状态为{cluster_type_91c828acc5960230bb07c9e0e6781429}的设备占比最多",fieldInfos:[{fieldName:"cluster_count",format:{places:0,digitSeparator:!0}}]},clusterMinSize:"24px",clusterMaxSize:"60px",labelingInfo:[{deconflictionStrategy:"none",labelExpressionInfo:{expression:"Text($feature.cluster_count, '#,###')"},symbol:{type:"text",color:"#3744e7",haloColor:"#fff",haloSize:"2px",yoffset:4,font:{weight:"bold",size:"14px"}},labelPlacement:"center-center"}]},o=new v["default"]({id:"deviceLayer",title:"设备图层",fields:[{name:"ObjectID",type:"oid"},{name:"id",type:"string"},{name:"deviceUid",type:"string"},{name:"deviceStatus",type:"string"}],featureReduction:i,outFields:["*"],objectIdField:"ObjectID",geometryType:"point",source:[],renderer:{type:"unique-value",valueExpression:"return $feature.deviceStatus",uniqueValueInfos:r,visualVariables:[{type:"size",valueExpression:"$view.scale",stops:[{value:5e5,size:2},{value:25e4,size:10},{value:125e3,size:15},{value:32e3,size:30}]}]},popupTemplate:{title:"{deviceUid}",content:[{type:"fields",fieldInfos:[{label:"设备Uid",fieldName:"deviceUid"},{label:"设备id",fieldName:"id"},{label:"设备状态",fieldName:"deviceStatus"}]}]}}),t.map.add(o),o.applyEdits({addFeatures:n}).then((function(t){console.log("deleteFeatures:".concat(t.deleteFeatureResults.length)),console.log("addFeatures:".concat(t.addFeatureResults.length))}));case 8:case"end":return e.stop()}}),e)})))()},checkItem:function(t){t.active=!t.active;var e=this.filterList.filter((function(t){return 1==t.active})).map((function(t){return t.value}));this.filterDeviceLayer({mode:"deviceStatus",values:e})},initDraw:function(){var t=new b["a"]({id:"canvas",title:"绘图面板"});this.map.add(t);var e=new p["a"]({layer:t,view:this.view,creationMode:"update"});this.view.ui.add(e,"bottom-right"),e.on("update",(function(t){t.graphics[0].geometry&&console.log(JSON.stringify(t.graphics[0].geometry.rings))})),this.sketch=e},filterDeviceLayer:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.mode,n=t.values,r=void 0===n?[]:n,i=this.map.findLayerById("deviceLayer");this.view.whenLayerView(i).then((function(t){var n="";r.length>0&&(n+=r.map((function(t){return"".concat(e,"='").concat(t,"'")})).join(" OR ")),console.log("queryStr: ",n),t.filter={where:n},i.refresh()}))},countDeviceData:function(t){var e=this,n={ONLINE:{count:0,index:0},OFFLINE:{count:0,index:1},UNACTIVATED:{count:0,index:2}};t.forEach((function(t){var e=n[t.deviceStatus];e&&e.count++})),Object.keys(n).forEach((function(t){var r=n[t],i=r.index,o=r.count;e.filterList[i].count=o}))},getDeviceData:function(){var t=this;return new Promise((function(e){u.a.get("".concat("/study-arcgis/","/static/mockData.json")).then((function(n){var r=n.data.data,i=[];r.forEach((function(t){for(var e=0;e<50;e++){var n=Object(o["a"])(t.location,2),r=n[0],a=n[1],c=Math.random(),u=Math.random(),f=(new Date).getTime();r+=(c>.5?1:-1)*c*1,a+=(u>.5?1:-1)*u*1,i.push({id:f,deviceUid:f,location:[r,a],deviceStatus:"UNACTIVATED"})}})),r=r.concat(i),console.log("data count: ".concat(r.length)),t.countDeviceData(r);var a=[];r.forEach((function(t){var e=Object(o["a"])(t.location,2),n=e[0],r=e[1],i=new s["a"]({geometry:{type:"point",latitude:r,longitude:n},attributes:t});a.push(i)})),e(a)}))}))}}},y=h,g=(n("aa4b"),n("589c"),n("2877")),m=Object(g["a"])(y,r,i,!1,null,"50483cc8",null);e["default"]=m.exports},"6b75":function(t,e,n){"use strict";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,"a",(function(){return r}))},"746f":function(t,e,n){var r=n("428f"),i=n("5135"),o=n("e538"),a=n("9bf2").f;t.exports=function(t){var e=r.Symbol||(r.Symbol={});i(e,t)||a(e,t,{value:o.f(t)})}},"99af":function(t,e,n){"use strict";var r=n("23e7"),i=n("d039"),o=n("e8b5"),a=n("861d"),c=n("7b0b"),u=n("50c4"),f=n("8418"),s=n("65f0"),l=n("1dde"),d=n("b622"),v=n("2d00"),b=d("isConcatSpreadable"),p=9007199254740991,h="Maximum allowed index exceeded",y=v>=51||!i((function(){var t=[];return t[b]=!1,t.concat()[0]!==t})),g=l("concat"),m=function(t){if(!a(t))return!1;var e=t[b];return void 0!==e?!!e:o(t)},w=!y||!g;r({target:"Array",proto:!0,forced:w},{concat:function(t){var e,n,r,i,o,a=c(this),l=s(a,0),d=0;for(e=-1,r=arguments.length;e<r;e++)if(o=-1===e?a:arguments[e],m(o)){if(i=u(o.length),d+i>p)throw TypeError(h);for(n=0;n<i;n++,d++)n in o&&f(l,d,o[n])}else{if(d>=p)throw TypeError(h);f(l,d++,o)}return l.length=d,l}})},"9bdd":function(t,e,n){var r=n("825a"),i=n("2a62");t.exports=function(t,e,n,o){try{return o?e(r(n)[0],n[1]):e(n)}catch(a){throw i(t),a}}},a15b:function(t,e,n){"use strict";var r=n("23e7"),i=n("44ad"),o=n("fc6a"),a=n("a640"),c=[].join,u=i!=Object,f=a("join",",");r({target:"Array",proto:!0,forced:u||!f},{join:function(t){return c.call(o(this),void 0===t?",":t)}})},a4d3:function(t,e,n){"use strict";var r=n("23e7"),i=n("da84"),o=n("d066"),a=n("c430"),c=n("83ab"),u=n("4930"),f=n("fdbf"),s=n("d039"),l=n("5135"),d=n("e8b5"),v=n("861d"),b=n("825a"),p=n("7b0b"),h=n("fc6a"),y=n("c04e"),g=n("5c6c"),m=n("7c73"),w=n("df75"),S=n("241c"),O=n("057f"),j=n("7418"),x=n("06cf"),E=n("9bf2"),A=n("d1e7"),D=n("9112"),I=n("6eeb"),N=n("5692"),T=n("f772"),L=n("d012"),k=n("90e3"),F=n("b622"),_=n("e538"),U=n("746f"),P=n("d44e"),z=n("69f3"),C=n("b727").forEach,M=T("hidden"),V="Symbol",$="prototype",R=F("toPrimitive"),J=z.set,q=z.getterFor(V),B=Object[$],Q=i.Symbol,W=o("JSON","stringify"),G=x.f,H=E.f,K=O.f,X=A.f,Y=N("symbols"),Z=N("op-symbols"),tt=N("string-to-symbol-registry"),et=N("symbol-to-string-registry"),nt=N("wks"),rt=i.QObject,it=!rt||!rt[$]||!rt[$].findChild,ot=c&&s((function(){return 7!=m(H({},"a",{get:function(){return H(this,"a",{value:7}).a}})).a}))?function(t,e,n){var r=G(B,e);r&&delete B[e],H(t,e,n),r&&t!==B&&H(B,e,r)}:H,at=function(t,e){var n=Y[t]=m(Q[$]);return J(n,{type:V,tag:t,description:e}),c||(n.description=e),n},ct=f?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof Q},ut=function(t,e,n){t===B&&ut(Z,e,n),b(t);var r=y(e,!0);return b(n),l(Y,r)?(n.enumerable?(l(t,M)&&t[M][r]&&(t[M][r]=!1),n=m(n,{enumerable:g(0,!1)})):(l(t,M)||H(t,M,g(1,{})),t[M][r]=!0),ot(t,r,n)):H(t,r,n)},ft=function(t,e){b(t);var n=h(e),r=w(n).concat(bt(n));return C(r,(function(e){c&&!lt.call(n,e)||ut(t,e,n[e])})),t},st=function(t,e){return void 0===e?m(t):ft(m(t),e)},lt=function(t){var e=y(t,!0),n=X.call(this,e);return!(this===B&&l(Y,e)&&!l(Z,e))&&(!(n||!l(this,e)||!l(Y,e)||l(this,M)&&this[M][e])||n)},dt=function(t,e){var n=h(t),r=y(e,!0);if(n!==B||!l(Y,r)||l(Z,r)){var i=G(n,r);return!i||!l(Y,r)||l(n,M)&&n[M][r]||(i.enumerable=!0),i}},vt=function(t){var e=K(h(t)),n=[];return C(e,(function(t){l(Y,t)||l(L,t)||n.push(t)})),n},bt=function(t){var e=t===B,n=K(e?Z:h(t)),r=[];return C(n,(function(t){!l(Y,t)||e&&!l(B,t)||r.push(Y[t])})),r};if(u||(Q=function(){if(this instanceof Q)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=k(t),n=function(t){this===B&&n.call(Z,t),l(this,M)&&l(this[M],e)&&(this[M][e]=!1),ot(this,e,g(1,t))};return c&&it&&ot(B,e,{configurable:!0,set:n}),at(e,t)},I(Q[$],"toString",(function(){return q(this).tag})),I(Q,"withoutSetter",(function(t){return at(k(t),t)})),A.f=lt,E.f=ut,x.f=dt,S.f=O.f=vt,j.f=bt,_.f=function(t){return at(F(t),t)},c&&(H(Q[$],"description",{configurable:!0,get:function(){return q(this).description}}),a||I(B,"propertyIsEnumerable",lt,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!u,sham:!u},{Symbol:Q}),C(w(nt),(function(t){U(t)})),r({target:V,stat:!0,forced:!u},{for:function(t){var e=String(t);if(l(tt,e))return tt[e];var n=Q(e);return tt[e]=n,et[n]=e,n},keyFor:function(t){if(!ct(t))throw TypeError(t+" is not a symbol");if(l(et,t))return et[t]},useSetter:function(){it=!0},useSimple:function(){it=!1}}),r({target:"Object",stat:!0,forced:!u,sham:!c},{create:st,defineProperty:ut,defineProperties:ft,getOwnPropertyDescriptor:dt}),r({target:"Object",stat:!0,forced:!u},{getOwnPropertyNames:vt,getOwnPropertySymbols:bt}),r({target:"Object",stat:!0,forced:s((function(){j.f(1)}))},{getOwnPropertySymbols:function(t){return j.f(p(t))}}),W){var pt=!u||s((function(){var t=Q();return"[null]"!=W([t])||"{}"!=W({a:t})||"{}"!=W(Object(t))}));r({target:"JSON",stat:!0,forced:pt},{stringify:function(t,e,n){var r,i=[t],o=1;while(arguments.length>o)i.push(arguments[o++]);if(r=e,(v(e)||void 0!==t)&&!ct(t))return d(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!ct(e))return e}),i[1]=e,W.apply(null,i)}})}Q[$][R]||D(Q[$],R,Q[$].valueOf),P(Q,V),L[M]=!0},a630:function(t,e,n){var r=n("23e7"),i=n("4df4"),o=n("1c7e"),a=!o((function(t){Array.from(t)}));r({target:"Array",stat:!0,forced:a},{from:i})},aa4b:function(t,e,n){"use strict";n("2a07")},b64b:function(t,e,n){var r=n("23e7"),i=n("7b0b"),o=n("df75"),a=n("d039"),c=a((function(){o(1)}));r({target:"Object",stat:!0,forced:c},{keys:function(t){return o(i(t))}})},ba62:function(t,e,n){},d28b:function(t,e,n){var r=n("746f");r("iterator")},e01a:function(t,e,n){"use strict";var r=n("23e7"),i=n("83ab"),o=n("da84"),a=n("5135"),c=n("861d"),u=n("9bf2").f,f=n("e893"),s=o.Symbol;if(i&&"function"==typeof s&&(!("description"in s.prototype)||void 0!==s().description)){var l={},d=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof d?new s(t):void 0===t?s():s(t);return""===t&&(l[e]=!0),e};f(d,s);var v=d.prototype=s.prototype;v.constructor=d;var b=v.toString,p="Symbol(test)"==String(s("test")),h=/^Symbol\((.*)\)[^)]+$/;u(v,"description",{configurable:!0,get:function(){var t=c(this)?this.valueOf():this,e=b.call(t);if(a(l,t))return"";var n=p?e.slice(7,-1):e.replace(h,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:d})}},e538:function(t,e,n){var r=n("b622");e.f=r},fb6a:function(t,e,n){"use strict";var r=n("23e7"),i=n("861d"),o=n("e8b5"),a=n("23cb"),c=n("50c4"),u=n("fc6a"),f=n("8418"),s=n("b622"),l=n("1dde"),d=l("slice"),v=s("species"),b=[].slice,p=Math.max;r({target:"Array",proto:!0,forced:!d},{slice:function(t,e){var n,r,s,l=u(this),d=c(l.length),h=a(t,d),y=a(void 0===e?d:e,d);if(o(l)&&(n=l.constructor,"function"!=typeof n||n!==Array&&!o(n.prototype)?i(n)&&(n=n[v],null===n&&(n=void 0)):n=void 0,n===Array||void 0===n))return b.call(l,h,y);for(r=new(void 0===n?Array:n)(p(y-h,0)),s=0;h<y;h++,s++)h in l&&f(r,s,l[h]);return r.length=s,r}})}}]);
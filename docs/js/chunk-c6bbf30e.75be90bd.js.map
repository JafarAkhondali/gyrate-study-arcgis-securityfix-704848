{"version":3,"sources":["webpack:///./node_modules/@arcgis/core/layers/support/ElevationTile.js","webpack:///./node_modules/@arcgis/core/layers/support/ElevationQuery.js","webpack:///./node_modules/@arcgis/core/layers/support/ElevationSampler.js"],"names":["t","a","this","tile","samplerData","e","extent","pixelData","values","width","height","safeWidth","noDataValue","dx","dy","x0","y1","i","h","s","l","r","n","o","d","Math","floor","u","f","p","x","D","c","w","ignoreInvisibleLayers","filter","visible","slice","length","fromGeometry","returnSampleInfo","E","query","_queryAllContinue","geometry","export","sampleInfo","type","g","spatialReference","signal","load","_createGeometryDescriptor","_selectTiles","_populateElevationTiles","_sampleGeometryWithElevation","_createQueryResult","_createSampler","_createSamplerAllContinue","tileInfo","equals","source","dest","elevationTiles","layer","options","pop","samplers","map","concat","coordinates","demResolution","push","clone","forEach","z","project","outSpatialReference","_extractSampleInfo","elevationTile","wkid","_preselectOutsideLayerExtent","_selectTilesClosestResolution","_selectTilesFinestContiguous","_selectTilesAuto","sample","outsideExtentTile","fullExtent","y","xmin","xmax","ymin","ymax","_findNearestDemResolutionLODIndex","selectTilesAtLOD","lods","abs","resolution","_","minDemResolution","_selectTilesFinestContiguousAt","tilemapCache","getTilesToFetch","Promise","all","fetchAvailability","level","row","col","allElevationTilesFetched","clearElevationTiles","cache","async","uid","id","get","fetchTile","put","populateElevationTiles","_selectTilesAutoFinest","_reduceTilesForMaximumRequests","_selectTilesAutoPrefetchUpsample","fetchAvailabilityUpsample","ok","error","remapTiles","forEachTileToFetch","maximumAutoTileRequests","upsampleTile","lodAt","_exporter","_cloneCoordinate","points","m","hasZ","hasM","spatiaReference","paths","super","tileAt","some","candidateTiles","fetchedCandidates","Set","intersection","maskExtents","_maximumLodForRequests","min","_selectCandidateTilesCoveringExtentAt","size","ceil","clear","add","_uniqueNonOverlappingTiles","has","sort","updateTileInfo","_tileIsMasked","findIndex","getLogger","max","projectIfRequired","contains","warn","union","elevationAt","R"],"mappings":"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","file":"js/chunk-c6bbf30e.75be90bd.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nclass t{constructor(t,a){if(this.tile=t,!a)return void(this.samplerData=null);const e=this.tile.extent;this.samplerData={pixelData:a.values,width:a.width,height:a.height,safeWidth:.99999999*(a.width-1),noDataValue:a.noDataValue,dx:(a.width-1)/(e[2]-e[0]),dy:(a.width-1)/(e[3]-e[1]),x0:e[0],y1:e[3]}}sample(t,e){if(this.samplerData)return a(this.samplerData,t,e)}}function a(t,a,i){const{safeWidth:h,width:s,pixelData:l,noDataValue:r}=t,n=e(t.dy*(t.y1-i),0,h),o=e(t.dx*(a-t.x0),0,h),d=Math.floor(n),u=Math.floor(o),f=d*s+u,p=f+s,x=l[f],D=l[p],c=l[f+1],w=l[p+1];if(x!==r&&D!==r&&c!==r&&w!==r){const t=o-u,a=x+(c-x)*t;return a+(D+(w-D)*t-a)*(n-d)}}function e(t,a,e){return t<a?a:t>e?e:t}export default t;export{t as ElevationTile};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../core/maybe.js\";import t from\"../../core/Error.js\";import{whenOrAbort as i,throwIfAbortError as o,eachAlways as s}from\"../../core/promiseUtils.js\";import l from\"../../geometry/Point.js\";import n from\"../../geometry/Multipoint.js\";import a from\"../../geometry/Polyline.js\";import{result as r}from\"../../core/asyncUtils.js\";import{getMetersPerUnitForSR as c}from\"../../core/unitUtils.js\";import{fromExtent as u,create as h,contains as p}from\"../../geometry/support/aaBoundingRect.js\";import{initializeProjection as m,project as f}from\"../../geometry/projection.js\";import{MultiTileElevationSampler as d}from\"./ElevationSampler.js\";import{ElevationTile as y}from\"./ElevationTile.js\";class T{async queryAll(e,i,o){if(!(e=o&&o.ignoreInvisibleLayers?e.filter((e=>e.visible)):e.slice()).length)throw new t(\"elevation-query:invalid-layer\",\"Elevation queries require at least one elevation layer to fetch tiles from\");const s=v.fromGeometry(i);let l=!1;o&&o.returnSampleInfo||(l=!0);const n={...E,...o,returnSampleInfo:!0},a=await this.query(e[e.length-1],s,n),r=await this._queryAllContinue(e,a,n);return r.geometry=r.geometry.export(),l&&delete r.sampleInfo,r}async query(e,i,o){if(!e)throw new t(\"elevation-query:invalid-layer\",\"Elevation queries require an elevation layer to fetch tiles from\");if(!i||!(i instanceof v)&&\"point\"!==i.type&&\"multipoint\"!==i.type&&\"polyline\"!==i.type)throw new t(\"elevation-query:invalid-geometry\",\"Only point, polyline and multipoint geometries can be used to query elevation\");const s={...E,...o},l=new g(e,i.spatialReference,s),n=s.signal;return await e.load({signal:n}),await this._createGeometryDescriptor(l,i,n),await this._selectTiles(l,n),await this._populateElevationTiles(l,n),this._sampleGeometryWithElevation(l),this._createQueryResult(l,n)}async createSampler(e,i,o){if(!e)throw new t(\"elevation-query:invalid-layer\",\"Elevation queries require an elevation layer to fetch tiles from\");if(!i||\"extent\"!==i.type)throw new t(\"elevation-query:invalid-extent\",\"Invalid or undefined extent\");const s={...E,...o};return this._createSampler(e,i,s)}async createSamplerAll(e,i,o){if(!(e=o&&o.ignoreInvisibleLayers?e.filter((e=>e.visible)):e.slice()).length)throw new t(\"elevation-query:invalid-layer\",\"Elevation queries require at least one elevation layer to fetch tiles from\");if(!i||\"extent\"!==i.type)throw new t(\"elevation-query:invalid-extent\",\"Invalid or undefined extent\");const s={...E,...o,returnSampleInfo:!0},l=await this._createSampler(e[e.length-1],i,s);return this._createSamplerAllContinue(e,i,l,s)}async _createSampler(e,t,i,o){const s=i.signal;await e.load({signal:s});const l=t.spatialReference,n=e.tileInfo.spatialReference;l.equals(n)||(await m([{source:l,dest:n}],{signal:s}),t=f(t,n));const a=new w(e,t,i,o);return await this._selectTiles(a,s),await this._populateElevationTiles(a,s),new d(a.elevationTiles,a.layer.tileInfo,a.options.noDataValue)}async _createSamplerAllContinue(e,t,i,o){if(e.pop(),!e.length)return i;const s=i.samplers.map((e=>u(e.extent))),l=await this._createSampler(e[e.length-1],t,o,s);if(0===l.samplers.length)return i;const n=i.samplers.concat(l.samplers),a=new d(n,o.noDataValue);return this._createSamplerAllContinue(e,t,a,o)}async _queryAllContinue(e,t,i){const o=e.pop(),s=t.geometry.coordinates,l=[],n=[];for(let c=0;c<s.length;c++){const i=t.sampleInfo[c];i.demResolution>=0?i.source||(i.source=o):e.length&&(l.push(s[c]),n.push(c))}if(!e.length||0===l.length)return t;const a=t.geometry.clone(l),r=await this.query(e[e.length-1],a,i);return n.forEach(((e,i)=>{s[e].z=r.geometry.coordinates[i].z,t.sampleInfo[e].demResolution=r.sampleInfo[i].demResolution})),this._queryAllContinue(e,t,i)}async _createQueryResult(e,t){const i={geometry:(await e.geometry.project(e.outSpatialReference,t)).export(),noDataValue:e.options.noDataValue};return e.options.returnSampleInfo&&(i.sampleInfo=this._extractSampleInfo(e)),e.geometry.coordinates.forEach((e=>{e.tile=null,e.elevationTile=null})),i}async _createGeometryDescriptor(e,i,o){let s;const l=e.layer.tileInfo.spatialReference;if(i instanceof v?s=await i.project(l,o):(await m([{source:i.spatialReference,dest:l}],{signal:o}),s=f(i,l)),!s)throw new t(\"elevation-query:spatial-reference-mismatch\",`Cannot query elevation in '${i.spatialReference.wkid}' on an elevation service in '${l.wkid}'`);e.geometry=v.fromGeometry(s)}async _selectTiles(e,i){const o=e.options.demResolution;if(\"geometry\"===e.type&&this._preselectOutsideLayerExtent(e),\"number\"==typeof o)this._selectTilesClosestResolution(e);else if(\"finest-contiguous\"===o)await this._selectTilesFinestContiguous(e,i);else{if(\"auto\"!==o)throw new t(\"elevation-query:invalid-dem-resolution\",`Invalid dem resolution value '${o}', expected a number, \"finest-contiguous\" or \"auto\"`);await this._selectTilesAuto(e,i)}}_preselectOutsideLayerExtent(e){const t=new y(null);t.sample=()=>e.options.noDataValue,e.outsideExtentTile=t;const i=e.layer.fullExtent;e.geometry.coordinates.forEach((e=>{const o=e.x,s=e.y;(o<i.xmin||o>i.xmax||s<i.ymin||s>i.ymax)&&(e.elevationTile=t)}))}_selectTilesClosestResolution(e){const t=e.layer.tileInfo,i=this._findNearestDemResolutionLODIndex(t,e.options.demResolution);e.selectTilesAtLOD(i)}_findNearestDemResolutionLODIndex(e,t){const i=t/c(e.spatialReference);let o=e.lods[0],s=0;for(let l=1;l<e.lods.length;l++){const t=e.lods[l];Math.abs(t.resolution-i)<Math.abs(o.resolution-i)&&(o=t,s=l)}return s}async _selectTilesFinestContiguous(e,t){const i=_(e.layer.tileInfo,e.options.minDemResolution);await this._selectTilesFinestContiguousAt(e,i,t)}async _selectTilesFinestContiguousAt(e,s,l){const n=e.layer;if(e.selectTilesAtLOD(s),s<0)return;const a=n.tilemapCache,r=e.getTilesToFetch();try{if(a)await i(Promise.all(r.map((e=>a.fetchAvailability(e.level,e.row,e.col,{signal:l})))),l);else if(await this._populateElevationTiles(e,l),!e.allElevationTilesFetched())throw e.clearElevationTiles(),new t(\"elevation-query:has-unavailable-tiles\")}catch(c){o(c),await this._selectTilesFinestContiguousAt(e,s-1,l)}}async _populateElevationTiles(t,o){const l=t.getTilesToFetch(),n={},a=t.options.cache,r=t.options.noDataValue,c=l.map((async i=>{const s=`${t.layer.uid}:${i.id}:${r}`,l=e(a)?a.get(s):null,c=e(l)?l:await t.layer.fetchTile(i.level,i.row,i.col,{noDataValue:r,signal:o});e(a)&&a.put(s,c),n[i.id]=new y(i,c)}));await i(s(c),o),t.populateElevationTiles(n)}async _selectTilesAuto(e,t){this._selectTilesAutoFinest(e),this._reduceTilesForMaximumRequests(e);const s=e.layer.tilemapCache;if(!s)return this._selectTilesAutoPrefetchUpsample(e,t);const l=e.getTilesToFetch(),n={},a=l.map((async e=>{const i={id:null,level:0,row:0,col:0,extent:h()},l=await r(s.fetchAvailabilityUpsample(e.level,e.row,e.col,i,{signal:t}));!1===l.ok?o(l.error):n[e.id]=i}));await i(Promise.all(a),t),e.remapTiles(n)}_reduceTilesForMaximumRequests(e){const t=e.layer.tileInfo;let i=0;const o={},s=e=>{e.id in o?o[e.id]++:(o[e.id]=1,i++)},l=e=>{const t=o[e.id];1===t?(delete o[e.id],i--):o[e.id]=t-1};e.forEachTileToFetch(s,l);let n=!0;for(;n&&(n=!1,e.forEachTileToFetch((o=>{i<=e.options.maximumAutoTileRequests||(l(o),t.upsampleTile(o)&&(n=!0),s(o))}),l),n););}_selectTilesAutoFinest(e){const t=_(e.layer.tileInfo,e.options.minDemResolution);e.selectTilesAtLOD(t,e.options.maximumAutoTileRequests)}async _selectTilesAutoPrefetchUpsample(e,t){const i=e.layer.tileInfo;await this._populateElevationTiles(e,t);let o=!1;e.forEachTileToFetch(((e,t)=>{i.upsampleTile(e)?o=!0:t()})),o&&await this._selectTilesAutoPrefetchUpsample(e,t)}_sampleGeometryWithElevation(e){e.geometry.coordinates.forEach((t=>{const i=t.elevationTile;let o=e.options.noDataValue;if(i){const e=i.sample(t.x,t.y);void 0!==e?o=e:t.elevationTile=null}t.z=o}))}_extractSampleInfo(e){const t=e.layer.tileInfo,i=c(t.spatialReference);return e.geometry.coordinates.map((o=>{let s=-1;if(o.elevationTile&&o.elevationTile!==e.outsideExtentTile){s=t.lodAt(o.elevationTile.tile.level).resolution*i}return{demResolution:s}}))}}class v{export(){return this._exporter(this.coordinates,this.spatialReference)}clone(e){const t=new v;return t.geometry=this.geometry,t.spatialReference=this.spatialReference,t.coordinates=e||this.coordinates.map((e=>this._cloneCoordinate(e))),t._exporter=this._exporter,t}async project(e,t){if(this.spatialReference.equals(e))return this.clone();await m([{source:this.spatialReference,dest:e}],{signal:t});const i=new n({spatialReference:this.spatialReference,points:this.coordinates.map((e=>[e.x,e.y]))}),o=f(i,e);if(!o)return null;const s=this.coordinates.map(((e,t)=>{const i=this._cloneCoordinate(e),s=o.points[t];return i.x=s[0],i.y=s[1],i})),l=this.clone(s);return l.spatialReference=e,l}_cloneCoordinate(e){return{x:e.x,y:e.y,z:e.z,m:e.m,tile:null,elevationTile:null}}static fromGeometry(e){const t=new v;if(t.geometry=e,t.spatialReference=e.spatialReference,e instanceof v)t.coordinates=e.coordinates.map((e=>t._cloneCoordinate(e))),t._exporter=(t,i)=>{const o=e.clone(t);return o.spatialReference=i,o};else switch(e.type){case\"point\":{const i=e,{hasZ:o,hasM:s}=i;t.coordinates=o&&s?[{x:i.x,y:i.y,z:i.z,m:i.m}]:o?[{x:i.x,y:i.y,z:i.z}]:s?[{x:i.x,y:i.y,m:i.m}]:[{x:i.x,y:i.y}],t._exporter=(t,i)=>e.hasM?new l(t[0].x,t[0].y,t[0].z,t[0].m,i):new l(t[0].x,t[0].y,t[0].z,i);break}case\"multipoint\":{const i=e,{hasZ:o,hasM:s}=i;t.coordinates=o&&s?i.points.map((e=>({x:e[0],y:e[1],z:e[2],m:e[3]}))):o?i.points.map((e=>({x:e[0],y:e[1],z:e[2]}))):s?i.points.map((e=>({x:e[0],y:e[1],m:e[2]}))):i.points.map((e=>({x:e[0],y:e[1]}))),t._exporter=(t,i)=>e.hasM?new n({points:t.map((e=>[e.x,e.y,e.z,e.m])),hasZ:!0,hasM:!0,spatiaReference:i}):new n(t.map((e=>[e.x,e.y,e.z])),i);break}case\"polyline\":{const i=e,o=[],s=[],{hasZ:l,hasM:n}=e;let r=0;for(const e of i.paths)if(s.push([r,r+e.length]),r+=e.length,l&&n)for(const t of e)o.push({x:t[0],y:t[1],z:t[2],m:t[3]});else if(l)for(const t of e)o.push({x:t[0],y:t[1],z:t[2]});else if(n)for(const t of e)o.push({x:t[0],y:t[1],m:t[2]});else for(const t of e)o.push({x:t[0],y:t[1]});t.coordinates=o,t._exporter=(t,i)=>{const o=e.hasM?t.map((e=>[e.x,e.y,e.z,e.m])):t.map((e=>[e.x,e.y,e.z])),l=s.map((e=>o.slice(e[0],e[1])));return new a({paths:l,hasM:e.hasM,hasZ:!0,spatialReference:i})};break}}return t}}class x{constructor(e,t){this.layer=e,this.options=t}}class g extends x{constructor(e,t,i){super(e,i),this.outSpatialReference=t,this.type=\"geometry\"}selectTilesAtLOD(e){if(e<0)this.geometry.coordinates.forEach((e=>e.tile=null));else{const t=this.layer.tileInfo,i=t.lods[e].level;this.geometry.coordinates.forEach((e=>{e.tile=t.tileAt(i,e.x,e.y)}))}}allElevationTilesFetched(){return!this.geometry.coordinates.some((e=>!e.elevationTile))}clearElevationTiles(){for(const e of this.geometry.coordinates)e.elevationTile!==this.outsideExtentTile&&(e.elevationTile=null)}populateElevationTiles(e){for(const t of this.geometry.coordinates)!t.elevationTile&&t.tile&&(t.elevationTile=e[t.tile.id])}remapTiles(e){for(const t of this.geometry.coordinates)t.tile=e[t.tile.id]}getTilesToFetch(){const e={},t=[];for(const i of this.geometry.coordinates){const o=i.tile;i.elevationTile||!i.tile||e[o.id]||(e[o.id]=o,t.push(o))}return t}forEachTileToFetch(e){for(const t of this.geometry.coordinates)t.tile&&!t.elevationTile&&e(t.tile,(()=>t.tile=null))}}class w extends x{constructor(e,t,i,o){super(e,i),this.type=\"extent\",this.elevationTiles=[],this.candidateTiles=[],this.fetchedCandidates=new Set,this.extent=t.intersection(e.fullExtent),this.maskExtents=o}selectTilesAtLOD(e,t){const i=this._maximumLodForRequests(t),o=Math.min(i,e);o<0?this.candidateTiles.length=0:this._selectCandidateTilesCoveringExtentAt(o)}_maximumLodForRequests(e){const t=this.layer.tileInfo;if(!e)return t.lods.length-1;const i=this.extent;for(let o=t.lods.length-1;o>=0;o--){const s=t.lods[o],l=s.resolution*t.size[0],n=s.resolution*t.size[1];if(Math.ceil(i.width/l)*Math.ceil(i.height/n)<=e)return o}return-1}allElevationTilesFetched(){return this.candidateTiles.length===this.elevationTiles.length}clearElevationTiles(){this.elevationTiles.length=0,this.fetchedCandidates.clear()}populateElevationTiles(e){for(const t of this.candidateTiles){const i=e[t.id];i&&(this.fetchedCandidates.add(t),this.elevationTiles.push(i))}}remapTiles(e){this.candidateTiles=this._uniqueNonOverlappingTiles(this.candidateTiles.map((t=>e[t.id])))}getTilesToFetch(){return this.candidateTiles}forEachTileToFetch(e,t){const i=this.candidateTiles;this.candidateTiles=[],i.forEach((i=>{if(this.fetchedCandidates.has(i))return void(t&&t(i));let o=!1;e(i,(()=>o=!0)),o?t&&t(i):this.candidateTiles.push(i)})),this.candidateTiles=this._uniqueNonOverlappingTiles(this.candidateTiles,t)}_uniqueNonOverlappingTiles(e,t){const i={},o=[];for(const l of e)i[l.id]?t&&t(l):(i[l.id]=l,o.push(l));const s=o.sort(((e,t)=>e.level-t.level));return s.filter(((e,i)=>{for(let o=0;o<i;o++)if(p(s[o].extent,e.extent))return t&&t(e),!1;return!0}))}_selectCandidateTilesCoveringExtentAt(e){this.candidateTiles.length=0;const t=this.layer.tileInfo,i=t.lods[e],o=this.extent,s=t.tileAt(i.level,o.xmin,o.ymin),l=i.resolution*t.size[0],n=i.resolution*t.size[1],a=Math.ceil((o.xmax-s.extent[0])/l),r=Math.ceil((o.ymax-s.extent[1])/n);for(let c=0;c<r;c++)for(let e=0;e<a;e++){const i={id:null,level:s.level,row:s.row-c,col:s.col+e};t.updateTileInfo(i),this._tileIsMasked(i)||this.candidateTiles.push(i)}}_tileIsMasked(e){return!!this.maskExtents&&this.maskExtents.some((t=>p(t,e.extent)))}}function _(e,t){let i=e.lods.length-1;if(t>0){const o=e.lods.findIndex((e=>e.resolution<t));0===o?i=0:o>0&&(i=o-1)}return i}const E={maximumAutoTileRequests:20,noDataValue:0,returnSampleInfo:!1,demResolution:\"auto\",minDemResolution:0};export default T;export{T as ElevationQuery,v as GeometryDescriptor,_ as getFinestLodIndex};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport\"../../core/has.js\";import{unwrapOr as e}from\"../../core/maybe.js\";import t from\"../../core/Logger.js\";import{canProject as n,project as s}from\"../../geometry/support/webMercatorUtils.js\";import i from\"../../geometry/Point.js\";import{extentContainsPoint as o}from\"../../geometry/support/contains.js\";import\"../../geometry.js\";import{getMetersPerUnitForSR as r}from\"../../core/unitUtils.js\";import{toExtent as a,create as l}from\"../../geometry/support/aaBoundingRect.js\";const c=t.getLogger(\"esri.layers.support.ElevationSampler\");class m{queryElevation(e){return h(e.clone(),this)}on(){return g}projectIfRequired(e,t){return f(e,t)}}class p extends m{constructor(e,t,n){super(),this.tile=e,this.noDataValue=n,this.extent=a(e.tile.extent,t.spatialReference);const s=r(t.spatialReference),i=t.lodAt(e.tile.level).resolution*s;this.demResolution={min:i,max:i}}get spatialReference(){return this.extent.spatialReference}contains(e){const t=this.projectIfRequired(e,this.spatialReference);return o(this.extent,t)}elevationAt(e){const t=this.projectIfRequired(e,this.spatialReference);if(!t)return null;if(!this.contains(e)){const t=this.extent,n=`${t.xmin}, ${t.ymin}, ${t.xmax}, ${t.ymax}`;c.warn(\"#elevationAt()\",`Point used to sample elevation (${e.x}, ${e.y}) is outside of the sampler extent (${n})`)}return this.tile.sample(t.x,t.y)}}class u extends m{constructor(e,t,n){let s;super(),\"number\"==typeof t?(this.noDataValue=t,s=null):(s=t,this.noDataValue=n),this.samplers=s?e.map((e=>new p(e,s,this.noDataValue))):e;const i=this.samplers[0];if(i){this.extent=i.extent.clone();const{min:e,max:t}=i.demResolution;this.demResolution={min:e,max:t};for(let n=1;n<this.samplers.length;n++){const e=this.samplers[n];this.extent.union(e.extent),this.demResolution.min=Math.min(this.demResolution.min,e.demResolution.min),this.demResolution.max=Math.max(this.demResolution.max,e.demResolution.max)}}else this.extent=a(l(),s.spatialReference),this.demResolution={min:0,max:0}}get spatialReference(){return this.extent.spatialReference}elevationAt(e){const t=this.projectIfRequired(e,this.spatialReference);if(!t)return null;for(const n of this.samplers)if(n.contains(t))return n.elevationAt(t);return c.warn(\"#elevationAt()\",`Point used to sample elevation (${e.x}, ${e.y}) is outside of the sampler`),null}}function h(e,t){const n=f(e,t.spatialReference);if(!n)return null;switch(e.type){case\"point\":x(e,n,t);break;case\"polyline\":R(e,n,t);break;case\"multipoint\":d(e,n,t)}return e}function f(e,t){const i=e.spatialReference;return i.equals(t)?e:n(i,t)?s(e,t):(c.error(`Cannot project geometry spatial reference (wkid:${i.wkid}) to elevation sampler spatial reference (wkid:${t.wkid})`),null)}function x(t,n,s){t.z=e(s.elevationAt(n),0)}function R(t,n,s){y.spatialReference=n.spatialReference;const i=t.hasM&&!t.hasZ;for(let o=0;o<t.paths.length;o++){const r=t.paths[o],a=n.paths[o];for(let t=0;t<r.length;t++){const n=r[t],o=a[t];y.x=o[0],y.y=o[1],i&&(n[3]=n[2]),n[2]=e(s.elevationAt(y),0)}}t.hasZ=!0}function d(t,n,s){y.spatialReference=n.spatialReference;const i=t.hasM&&!t.hasZ;for(let o=0;o<t.points.length;o++){const r=t.points[o],a=n.points[o];y.x=a[0],y.y=a[1],i&&(r[3]=r[2]),r[2]=e(s.elevationAt(y),0)}t.hasZ=!0}const y=new i,g={remove(){}};export{m as ElevationSamplerBase,u as MultiTileElevationSampler,p as TileElevationSampler,h as updateGeometryElevation};\n"],"sourceRoot":""}